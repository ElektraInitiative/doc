<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Elektra: Elektra Modules :: Elektra framework for loading modules</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>Elektra Modules :: Elektra framework for loading modules</h1>  </div>
</div>
<div class="contents">

<p>Loading Modules for Elektra.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modules.html#gaa40915e67f973ccd5258aa450bd03585">elektraModulesInit</a> (<a class="el" href="struct__KeySet.html">KeySet</a> *modules, <a class="el" href="struct__Key.html">Key</a> *error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">elektraPluginFactory&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modules.html#ga09300fbf0e0cfc9dc80bb877b00117c0">elektraModulesLoad</a> (<a class="el" href="struct__KeySet.html">KeySet</a> *modules, const char *name, <a class="el" href="struct__Key.html">Key</a> *error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modules.html#ga5646d92ffe3e1e04c4586d9c910ba6bd">elektraModulesClose</a> (<a class="el" href="struct__KeySet.html">KeySet</a> *modules, <a class="el" href="struct__Key.html">Key</a> *error)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Loading Modules for Elektra. </p>
<p>Unfortunately there is no portable way to load modules, plugins or libraries. So Elektra needed a framework which abstracts the loading of modules. Depending of the operating system the build system chooses different source files which actually implement the loading of a module.</p>
<p>The goals are:</p>
<ul>
<li>to have a list of all loaded modules</li>
<li>writing module loaders should be easy</li>
<li>handle and report errors well</li>
<li>avoid loading of modules multiple times (maybe OS can't handle that well)</li>
<li>hide the OS dependent handle inside a Key (handle is needed to close module afterwards) </li>
</ul>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga5646d92ffe3e1e04c4586d9c910ba6bd"></a><!-- doxytag: member="libloader/doc.c::elektraModulesClose" ref="ga5646d92ffe3e1e04c4586d9c910ba6bd" args="(KeySet *modules, Key *error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int elektraModulesClose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__KeySet.html">KeySet</a> *&nbsp;</td>
          <td class="paramname"> <em>modules</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__Key.html">Key</a> *&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Close all modules.</p>
<p>Iterates over all modules and closes each of them.</p>
<p>Finish all affairs with the modules. Delete all keys where the appropriate module could be closed.</p>
<p>If it is not possible to close a module, still try to close all other modules, but report the error with the error key.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>modules</em>&nbsp;</td><td>all modules in this keyset will be closed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>error</em>&nbsp;</td><td>a key to append the error information if it is not null </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>-1 on error </dd>
<dd>
&gt;=0 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="gaa40915e67f973ccd5258aa450bd03585"></a><!-- doxytag: member="libloader/doc.c::elektraModulesInit" ref="gaa40915e67f973ccd5258aa450bd03585" args="(KeySet *modules, Key *error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int elektraModulesInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__KeySet.html">KeySet</a> *&nbsp;</td>
          <td class="paramname"> <em>modules</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__Key.html">Key</a> *&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialises the module loading system.</p>
<p>Most operating systems will have to do nothing here. Anyway you are required to add the key system/elektra/modules if it was successful.</p>
<p>On error -1 is returned and if error != 0 error information is added to it.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>modules</em>&nbsp;</td><td>an empty keyset </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>error</em>&nbsp;</td><td>a key to append the error information if it is not null </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>-1 on error </dd>
<dd>
&gt;=0 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="ga09300fbf0e0cfc9dc80bb877b00117c0"></a><!-- doxytag: member="libloader/doc.c::elektraModulesLoad" ref="ga09300fbf0e0cfc9dc80bb877b00117c0" args="(KeySet *modules, const char *name, Key *error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elektraPluginFactory elektraModulesLoad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__KeySet.html">KeySet</a> *&nbsp;</td>
          <td class="paramname"> <em>modules</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__Key.html">Key</a> *&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Load a library with the given name.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>a pointer to the factory which can create the plugin.</dd></dl>
<p>Make sure that you first lookup if this module was already loaded. If it was, just return the pointer and you are done.</p>
<p>Otherwise load the module/library given by name. You need to take care that a proper name is used. The name does not have any path, pre- or postfixes.</p>
<p>The next step is to fetch the symbol elektraPluginFactory.</p>
<p>If everything was successful append all information to the keyset modules and return the pointer. Take care that you can close the module with that information. All information needs to be stored within system/elektra/modules/name You might want to use an struct and store it there as binary key.</p>
<p>If anything goes wrong dont append anything to modules. Instead report the error to the error key and return with 0.</p>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>the name is not null, empty and has at least one character different to /. It is suitable to be used as keyAddBaseName without any further error checking.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>modules</em>&nbsp;</td><td>where to get existing modules from a new module will be added there </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>the name for the plugin to load. Note that it does not have any prefixes or postfixes, you need to add them yourself. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>error</em>&nbsp;</td><td>the key to add warnings or report errors </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a pointer which can create a Plugin </dd>
<dd>
0 on error </dd></dl>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sat Jun 9 2012 14:24:25 for Elektra by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
