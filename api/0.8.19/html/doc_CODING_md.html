<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Elektra: CODING</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.8.19</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CODING </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>intensively (except for file headers).</p>
<p>This document provides an introduction in how the source code of libelektra is organized and how and where to add functionality.</p>
<p>Make sure to read <a class="el" href="doc_DESIGN_md.html">DESIGN</a> together with this document.</p>
<h2>Folder structure</h2>
<p>After you downloaded and unpacked Elektra you should see some folders. The most important are:</p>
<ul>
<li><b>src:</b> This directory contains the source of the libraries, tools and plugins.</li>
<li><b>doc:</b> General documentation for the project and the core library.</li>
<li><b>examples:</b> Examples on how to use the core library.</li>
<li><b>tests:</b> Contains the testing framework for the source (<b>src</b>).</li>
</ul>
<h2>Source Code</h2>
<p>libelektra is the ANSI/ISO C99-Core which coordinates the interactions between the user and the plugins.</p>
<p>The plugins have all kinds of dependencies. It is the responsibility of the plugins to find and check them using CMake. The same guidelines apply to all code in the repository including the plugins.</p>
<p><code>libloader</code> is responsible for loading the backend modules. It works on various operating systems by using <code>libltdl</code>. This code is optimized for static linking and win32.</p>
<p>kdb is the commandline-tool to access and initialize the Elektra database.</p>
<h3>General Guidelines</h3>
<p>You are only allowed to break a guideline if there is a good reason to do so. When you do, document the fact as comment next to the code.</p>
<p>Of course, all rules of good software engineering apply: Use meaningful names and keep the software both testable and reusable.</p>
<p>The purpose of the guidelines is to have a consistent style, not to teach programming.</p>
<p>If you see code that breaks guidelines do not hesitate to fix them. At least put a TODO marker to make the places visible.</p>
<p>If you see inconsistency within the rules do not hesitate to talk about it with the intent to add a new rule here.</p>
<p>See <a class="el" href="doc_DESIGN_md.html">DESIGN</a> document too, they complement each other.</p>
<h3>Code Comments</h3>
<p>Code is not only for the computer, but it should be readable for humans, too. Up-to-date code comments are essential to make code understandable for others. Thus please use following techniques (in order of preference):</p>
<ol type="1">
<li>Comment functions with <code>/**/</code> and Doxygen, see below.</li>
<li><p class="startli">You should use also add assertions to state what should be true at a specific position in the code. Their syntax is checked and they are automatically verified at run-time. So they are not only useful for people reading the code but also for tools. Assertions in Elektra are used by:</p>
<p class="startli"><code>#include &lt;<a class="el" href="kdbassert_8h.html" title="Assertions macros. ">kdbassert.h</a>&gt;</code></p>
<p class="startli"><code>ELEKTRA_ASSERT (condition, "formatted text to be printed when assert fails", ...)</code></p>
<p class="startli">Note: Do not use assert for user-APIs, always handle arguments of user-APIs like untrusted input.</p>
</li>
<li><p class="startli">If the "comment" might be useful to be printed during execution, use logging:</p>
<p class="startli"><code>#include &lt;<a class="el" href="kdblogger_8h.html" title="Logger Interface. ">kdblogger.h</a>&gt;</code></p>
<p class="startli"><code>ELEKTRA_LOG ("formatted text to be printed according log filters", ...)</code></p>
<p class="startli">There are four log levels:</p><ul>
<li>ELEKTRA_LOG_WARNING, something critical that should be shown the user (e.g. API misuse), see <a class="el" href="kdblogger_8h.html#a4096a2ccd61c6f5ad60e9015fd1bbb4ba0524fff5c46e0cf07287c473c46cc8e2" title="something happened an end user would be interested in ">ELEKTRA_LOG_LEVEL_WARNING</a></li>
<li>ELEKTRA_LOG_NOTICE, something important developers are likely interested in, see <a class="el" href="kdblogger_8h.html#a4096a2ccd61c6f5ad60e9015fd1bbb4ba329fc1e04c797ab8e54a137b21f41baf" title="something important happened which usually should not ">ELEKTRA_LOG_LEVEL_NOTICE</a></li>
<li>ELEKTRA_LOG, standard level gives information what the code is doing without flooding the log, see <a class="el" href="kdblogger_8h.html#a4096a2ccd61c6f5ad60e9015fd1bbb4ba01618746c91d9d1090f599f604b9b832" title="The standard log level. ">ELEKTRA_LOG_LEVEL_INFO</a></li>
<li>ELEKTRA_LOG_DEBUG, for less important logs, see <a class="el" href="kdblogger_8h.html#a4096a2ccd61c6f5ad60e9015fd1bbb4ba24c7a4c44a8b99b978dc99806d083386" title="The debug log level. ">ELEKTRA_LOG_LEVEL_DEBUG</a></li>
</ul>
</li>
<li>Otherwise comment within source with <code>//</code> or with <code>/**/</code> for multi-line comments.</li>
</ol>
<h3>Coding Style</h3>
<ul>
<li>Limits<ul>
<li>Functions should not exceed 100 lines.</li>
<li>Files should not exceed 1000 lines.</li>
<li>A line should not be longer than 140 characters.</li>
</ul>
</li>
</ul>
<p>Split up when those limits are reached. Rationale: Readability with split windows.</p>
<ul>
<li>Indentation<ul>
<li>Use tabs for indentation.</li>
<li>One tab equals 8 spaces.</li>
</ul>
</li>
<li>Blocks<ul>
<li>Use blocks even for single line statements.</li>
<li>Curly braces go on a line on their own on the previous indentation level.</li>
<li>Avoid multiple variable declarations at one place.</li>
<li>Declare Variables as late as possible, preferable within blocks.</li>
</ul>
</li>
<li>Naming<ul>
<li>Use camelCase for functions and variables.</li>
<li>Start types with upper-case, everything else with lower-case.</li>
<li>Prefix names with <code>elektra</code> for internal usage. External API either starts with <code>ks</code>, <code>key</code> or <code>kdb</code>.</li>
</ul>
</li>
<li>Whitespaces<ul>
<li>Use space before and after equal when assigning a value.</li>
<li>Use space before round parenthesis ( <code>(</code> ).</li>
<li>Use space before and after <code>*</code> from Pointers.</li>
<li>Use space after <code>,</code> of every function argument.</li>
</ul>
</li>
</ul>
<p>The reformat script can ensure most code style rules, but it is obviouly not capable of ensuring everything (e.g. naming conventions). So do not give this responsibility out of hands entirely.</p>
<h3>C Guidelines</h3>
<ul>
<li>The compiler shall not emit any warning (or error).</li>
<li>Use goto only for error situations.</li>
<li>Use <code>const</code> as much as possible.</li>
<li>Use <code>static</code> methods if they should not be externally visible.</li>
<li>C-Files have extension <code>.c</code>, Header files <code>.h</code>.</li>
</ul>
<p><b>Example:</b> <a href="/home/markus/Projekte/Elektra/current/src/libs/elektra/kdb.c">src/libs/elektra/kdb.c</a></p>
<h3>C++ Guidelines</h3>
<ul>
<li>Everything as in C if not noted otherwise.</li>
<li>Do not use goto at all, use RAII instead.</li>
<li>Do not use raw pointers, use smart pointers instead.</li>
<li>C++-Files have extension <code>.cpp</code>, Header files <code>.hpp</code>.</li>
<li>Do not use <code>static</code>, but anonymous namespaces.</li>
<li>Write everything within namespaces and do not prefix names.</li>
<li>Oriented towards https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md "more safe and modern usage".</li>
</ul>
<p><b>Example:</b> <a href="/home/markus/Projekte/Elektra/current/src/bindings/cpp/include/kdb.hpp">src/bindings/cpp/include/kdb.hpp</a></p>
<h3>Doxygen Guidelines</h3>
<p><code>doxygen</code> is used to document the API and to build the html and pdf output. We also support the import of Markdown pages. Doxygen 1.8.8 or later is required for this feature (Anyways you can find the <a href="http://doc.libelektra.org/api/latest/html/">API Doc</a> online). Links between Markdown files will be converted with the <a class="el" href="doc_markdownlinkconverter_README_md.html">Markdown Link Converter</a>. <b>Markdown pages are used in the pdf, therefore watch which characters you use and provide a proper encoding!</b></p>
<ul>
<li>use <code>@</code> to start Doxygen tags</li>
<li>Do not duplicate information available in git in Doxygen comments.</li>
<li>Use <code>\copydetails</code>, <code>@copybrief</code> and <code>@copydetails</code> intensively (except for file headers).</li>
</ul>
<h3>File Headers</h3>
<p>Files should start with:</p>
<pre class="fragment">        /**
         * @file
         *
         * @brief &lt;short statement about the content of the file&gt;
         *
         * @copyright BSD License (see doc/LICENSE.md or http://www.libelektra.org)
         */</pre><p>Note:</p>
<ul>
<li><code>@</code> <code>file</code> has <em>no</em> parameters.</li>
<li><code>@</code> <code>brief</code> should contain a short statement about the content of the file and is needed so that your file gets listed at <a href="http://doc.libelektra.org/api/latest/html/files.html">http://doc.libelektra.org/api/latest/html/files.html</a></li>
</ul>
<p>The duplication of the filename, author and date is not needed, because this information is tracked using git and doc/AUTHORS already. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
