<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: kdb::KDB Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.8.23</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacekdb.html">kdb</a></li><li class="navelem"><a class="el" href="classkdb_1_1KDB.html">KDB</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classkdb_1_1KDB-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">kdb::KDB Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a>.  
 <a href="classkdb_1_1KDB.html#details">More...</a></p>

<p><code>#include &lt;kdb.hpp&gt;</code></p>
<div class="dynheader">
Inheritance diagram for kdb::KDB:</div>
<div class="dyncontent">
<div class="center"><img src="classkdb_1_1KDB__inherit__graph.png" border="0" usemap="#kdb_1_1KDB_inherit__map" alt="Inheritance graph"/></div>
<map name="kdb_1_1KDB_inherit__map" id="kdb_1_1KDB_inherit__map">
<area shape="rect" id="node2" href="classkdb_1_1tools_1_1merging_1_1MergingKDB.html" title="Provides a merging wrapper around a KDB instance. " alt="" coords="5,80,143,121"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7e0637995ce9f294cdbc6f167df6db40"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> ()</td></tr>
<tr class="memdesc:a7e0637995ce9f294cdbc6f167df6db40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a>.  <a href="#a7e0637995ce9f294cdbc6f167df6db40">More...</a><br /></td></tr>
<tr class="separator:a7e0637995ce9f294cdbc6f167df6db40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98e25c7fe2f47c5a90461676c6d219e7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a98e25c7fe2f47c5a90461676c6d219e7">KDB</a> (<a class="el" href="classkdb_1_1Key.html">Key</a> &amp;errorKey)</td></tr>
<tr class="memdesc:a98e25c7fe2f47c5a90461676c6d219e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a>.  <a href="#a98e25c7fe2f47c5a90461676c6d219e7">More...</a><br /></td></tr>
<tr class="separator:a98e25c7fe2f47c5a90461676c6d219e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee37484b06164eacc0cc11b7b40ab892"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#aee37484b06164eacc0cc11b7b40ab892">open</a> (<a class="el" href="classkdb_1_1Key.html">Key</a> &amp;errorKey)</td></tr>
<tr class="memdesc:aee37484b06164eacc0cc11b7b40ab892"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open the database.  <a href="#aee37484b06164eacc0cc11b7b40ab892">More...</a><br /></td></tr>
<tr class="separator:aee37484b06164eacc0cc11b7b40ab892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b3ff4a68c2c935d67dce843bc4ad01b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a1b3ff4a68c2c935d67dce843bc4ad01b">close</a> ()  throw ()</td></tr>
<tr class="memdesc:a1b3ff4a68c2c935d67dce843bc4ad01b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the database.  <a href="#a1b3ff4a68c2c935d67dce843bc4ad01b">More...</a><br /></td></tr>
<tr class="separator:a1b3ff4a68c2c935d67dce843bc4ad01b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa027a8f798a2cfee11ff712eb204c35d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#aa027a8f798a2cfee11ff712eb204c35d">close</a> (<a class="el" href="classkdb_1_1Key.html">Key</a> &amp;errorKey)  throw ()</td></tr>
<tr class="memdesc:aa027a8f798a2cfee11ff712eb204c35d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the database.  <a href="#aa027a8f798a2cfee11ff712eb204c35d">More...</a><br /></td></tr>
<tr class="separator:aa027a8f798a2cfee11ff712eb204c35d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0419ffbc273c89756bc523b4223ec25a"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a0419ffbc273c89756bc523b4223ec25a">get</a> (<a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;returned, std::string const &amp;keyname)</td></tr>
<tr class="memdesc:a0419ffbc273c89756bc523b4223ec25a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get all keys below keyname inside returned.  <a href="#a0419ffbc273c89756bc523b4223ec25a">More...</a><br /></td></tr>
<tr class="separator:a0419ffbc273c89756bc523b4223ec25a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48770a7290699bf2b7529f3ab67e378f"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a48770a7290699bf2b7529f3ab67e378f">get</a> (<a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;returned, <a class="el" href="classkdb_1_1Key.html">Key</a> &amp;parentKey)</td></tr>
<tr class="memdesc:a48770a7290699bf2b7529f3ab67e378f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get all keys below parentKey inside returned.  <a href="#a48770a7290699bf2b7529f3ab67e378f">More...</a><br /></td></tr>
<tr class="separator:a48770a7290699bf2b7529f3ab67e378f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29087a6a1a7de334f4e5b62ffe5d6e6e"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a29087a6a1a7de334f4e5b62ffe5d6e6e">set</a> (<a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;returned, std::string const &amp;keyname)</td></tr>
<tr class="memdesc:a29087a6a1a7de334f4e5b62ffe5d6e6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set all keys below keyname.  <a href="#a29087a6a1a7de334f4e5b62ffe5d6e6e">More...</a><br /></td></tr>
<tr class="separator:a29087a6a1a7de334f4e5b62ffe5d6e6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62a4fafbe21d9519b31a7868aa05f3e3"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a62a4fafbe21d9519b31a7868aa05f3e3">set</a> (<a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;returned, <a class="el" href="classkdb_1_1Key.html">Key</a> &amp;parentKey)</td></tr>
<tr class="memdesc:a62a4fafbe21d9519b31a7868aa05f3e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set all keys below parentKey.  <a href="#a62a4fafbe21d9519b31a7868aa05f3e3">More...</a><br /></td></tr>
<tr class="separator:a62a4fafbe21d9519b31a7868aa05f3e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a>. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if database could not be opened</td></tr>
  </table>
  </dd>
</dl>
<p>Opens the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a></dd></dl>
<p>The method will bootstrap itself the following way. The first step is to open the default backend. With it system/elektra/mountpoints will be loaded and all needed libraries and mountpoints will be determined. These libraries for backends will be loaded and with it the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a></code> data structure will be initialized.</p>
<p>You must always call this method before retrieving or committing any keys to the database. In the end of the program, after using the key database, you must not forget to <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a>.</p>
<p>The pointer to the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a></code> structure returned will be initialized like described above, and it must be passed along on any kdb*() method your application calls.</p>
<p>Get a <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a></code> handle for every thread using elektra. Don't share the handle across threads, and also not the pointer accessing it:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> thread1 (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part1&quot;</span>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40afc1567f74444ff9c219f7456b652b4ec">KEY_CASCADING_NAME</a>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div><div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">kdbOpen</a> (parent);</div><div class="line">        <span class="comment">// fetch keys and work with them</span></div><div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span> thread2 (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part2&quot;</span>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40afc1567f74444ff9c219f7456b652b4ec">KEY_CASCADING_NAME</a>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div><div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">kdbOpen</a> (parent);</div><div class="line">        <span class="comment">// fetch keys and work with them</span></div><div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div><div class="line">}</div></div><!-- fragment --><p> You don't need <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a> if you only want to manipulate plain in-memory <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> or <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> objects.</p>
<dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorKey</td><td>the key which holds errors and warnings which were issued </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a>, <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a> to end all affairs to the <a class="el" href="group__key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> database. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">handle</td><td>on success </td></tr>
    <tr><td class="paramname">NULL</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<p>Access to the key database.</p>
<dl class="section invariant"><dt>Invariant</dt><dd>the object holds a valid connection to the key database or is empty </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a7e0637995ce9f294cdbc6f167df6db40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e0637995ce9f294cdbc6f167df6db40">&#9670;&nbsp;</a></span>KDB() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">kdb::KDB::KDB </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a>. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if database could not be opened</td></tr>
  </table>
  </dd>
</dl>
<p>Opens the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a></dd></dl>
<p>The method will bootstrap itself the following way. The first step is to open the default backend. With it system/elektra/mountpoints will be loaded and all needed libraries and mountpoints will be determined. These libraries for backends will be loaded and with it the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a></code> data structure will be initialized.</p>
<p>You must always call this method before retrieving or committing any keys to the database. In the end of the program, after using the key database, you must not forget to <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a>.</p>
<p>The pointer to the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a></code> structure returned will be initialized like described above, and it must be passed along on any kdb*() method your application calls.</p>
<p>Get a <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a></code> handle for every thread using elektra. Don't share the handle across threads, and also not the pointer accessing it:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> thread1 (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part1&quot;</span>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40afc1567f74444ff9c219f7456b652b4ec">KEY_CASCADING_NAME</a>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div><div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">kdbOpen</a> (parent);</div><div class="line">        <span class="comment">// fetch keys and work with them</span></div><div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span> thread2 (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part2&quot;</span>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40afc1567f74444ff9c219f7456b652b4ec">KEY_CASCADING_NAME</a>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div><div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">kdbOpen</a> (parent);</div><div class="line">        <span class="comment">// fetch keys and work with them</span></div><div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div><div class="line">}</div></div><!-- fragment --><p> You don't need <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a> if you only want to manipulate plain in-memory <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> or <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> objects.</p>
<dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorKey</td><td>the key which holds errors and warnings which were issued </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a>, <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a> to end all affairs to the <a class="el" href="group__key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> database. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">handle</td><td>on success </td></tr>
    <tr><td class="paramname">NULL</td><td>on failure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a98e25c7fe2f47c5a90461676c6d219e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98e25c7fe2f47c5a90461676c6d219e7">&#9670;&nbsp;</a></span>KDB() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">kdb::KDB::KDB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1Key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>errorKey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorKey</td><td>is useful if you want to get the warnings in the successful case, when no exception is thrown.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if database could not be opened</td></tr>
  </table>
  </dd>
</dl>
<p>Opens the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a></dd></dl>
<p>The method will bootstrap itself the following way. The first step is to open the default backend. With it system/elektra/mountpoints will be loaded and all needed libraries and mountpoints will be determined. These libraries for backends will be loaded and with it the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a></code> data structure will be initialized.</p>
<p>You must always call this method before retrieving or committing any keys to the database. In the end of the program, after using the key database, you must not forget to <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a>.</p>
<p>The pointer to the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a></code> structure returned will be initialized like described above, and it must be passed along on any kdb*() method your application calls.</p>
<p>Get a <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a></code> handle for every thread using elektra. Don't share the handle across threads, and also not the pointer accessing it:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> thread1 (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part1&quot;</span>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40afc1567f74444ff9c219f7456b652b4ec">KEY_CASCADING_NAME</a>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div><div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">kdbOpen</a> (parent);</div><div class="line">        <span class="comment">// fetch keys and work with them</span></div><div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span> thread2 (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part2&quot;</span>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40afc1567f74444ff9c219f7456b652b4ec">KEY_CASCADING_NAME</a>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div><div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">kdbOpen</a> (parent);</div><div class="line">        <span class="comment">// fetch keys and work with them</span></div><div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div><div class="line">}</div></div><!-- fragment --><p> You don't need <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a> if you only want to manipulate plain in-memory <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> or <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> objects.</p>
<dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorKey</td><td>the key which holds errors and warnings which were issued </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a>, <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a> to end all affairs to the <a class="el" href="group__key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> database. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">handle</td><td>on success </td></tr>
    <tr><td class="paramname">NULL</td><td>on failure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1b3ff4a68c2c935d67dce843bc4ad01b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b3ff4a68c2c935d67dce843bc4ad01b">&#9670;&nbsp;</a></span>close() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kdb::KDB::close </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
        <tr>
          <td align="right">throw </td><td>(</td><td colspan="2"></td>
        </tr>
        <tr>
          <td align="right"></td><td>)</td><td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Close the database. </p>
<p>The return value does not matter because its only a null pointer check.</p>
<p>Closes the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>The handle must be a valid handle as returned from <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a></dd>
<dd>
errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a></dd></dl>
<p>This is the counterpart of <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a>.</p>
<p>You must call this method when you finished your affairs with the key database. You can manipulate <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> and <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> objects also after <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a>, but you must not use any kdb*() call afterwards.</p>
<p>The <code>handle</code> parameter will be finalized and all resources associated to it will be freed. After a <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a>, the <code>handle</code> cannot be used anymore.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">opened </a> key database </td></tr>
    <tr><td class="paramname">errorKey</td><td>the key which holds error/warning information </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>on NULL pointer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa027a8f798a2cfee11ff712eb204c35d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa027a8f798a2cfee11ff712eb204c35d">&#9670;&nbsp;</a></span>close() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kdb::KDB::close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1Key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>errorKey</em></td><td>)</td>
          <td></td>
        </tr>
        <tr>
          <td align="right">throw </td><td>(</td><td colspan="2"></td>
        </tr>
        <tr>
          <td align="right"></td><td>)</td><td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Close the database. </p>
<p>The return value does not matter because its only a null pointer check.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorKey</td><td>is useful if you want to get the warnings</td></tr>
  </table>
  </dd>
</dl>
<p>Closes the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>The handle must be a valid handle as returned from <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a></dd>
<dd>
errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a></dd></dl>
<p>This is the counterpart of <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a>.</p>
<p>You must call this method when you finished your affairs with the key database. You can manipulate <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> and <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> objects also after <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a>, but you must not use any kdb*() call afterwards.</p>
<p>The <code>handle</code> parameter will be finalized and all resources associated to it will be freed. After a <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a>, the <code>handle</code> cannot be used anymore.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">opened </a> key database </td></tr>
    <tr><td class="paramname">errorKey</td><td>the key which holds error/warning information </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>on NULL pointer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0419ffbc273c89756bc523b4223ec25a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0419ffbc273c89756bc523b4223ec25a">&#9670;&nbsp;</a></span>get() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int kdb::KDB::get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;&#160;</td>
          <td class="paramname"><em>returned</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>keyname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get all keys below keyname inside returned. </p>
<p>Retrieve keys in an atomic and universal way. </p><dl class="section pre"><dt>Precondition</dt><dd>The <code>handle</code> must be passed as returned from <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a>.</dd>
<dd>
The <code>returned</code> <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> must be a valid <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a>, e.g. constructed with <a class="el" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c" title="Allocate, initialize and return a new KeySet object. ">ksNew()</a>.</dd>
<dd>
The <code>parentKey</code> <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> must be a valid <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a>, e.g. constructed with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a>.</dd></dl>
<p>If you pass NULL on any parameter <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> will fail immediately without doing anything.</p>
<p>The <code>returned</code> <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> may already contain some keys, e.g. from previous <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> calls. The new retrieved keys will be appended using <a class="el" href="group__keyset.html#gaa5a1d467a4d71041edce68ea7748ce45" title="Appends a Key to the end of ks. ">ksAppendKey()</a>.</p>
<p>If not done earlier <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> will fully retrieve all keys under the <code>parentKey</code> folder recursively (See Optimization below when it will not be done).</p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> might retrieve more keys than requested (that are not below parentKey). These keys must be passed to calls of <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a>, otherwise they will be lost. This stems from the fact that the user has the only copy of the whole configuration and backends only write configuration that was passed to them. For example, if you <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> "system/mountpoint/interest" you will not only get all keys below system/mountpoint/interest, but also all keys below system/mountpoint (if system/mountpoint is a mountpoint as the name suggests, but system/mountpoint/interest is not a mountpoint). Make sure to not touch or remove keys outside the keys of interest, because others may need them!</dd></dl>
<dl class="section user"><dt>Example:</dt><dd>This example demonstrates the typical usecase within an application (without error handling).</dd></dl>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;kdb.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="testio__doc_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">        KeySet * myConfig = <a class="code" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c">ksNew</a> (0, <a class="code" href="kdbenum_8c.html#a7a28fce3773b2c873c94ac80b8b4cd54">KS_END</a>);</div><div class="line"></div><div class="line">        <span class="comment">// for error handling see kdbget_error.c</span></div><div class="line"></div><div class="line">        <span class="comment">// clang-format off</span></div><div class="line"><span class="comment"></span>Key * key = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/sw/tests/myapp/#0/current/&quot;</span>,  <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div><div class="line"><a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * handle = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">kdbOpen</a> (key);</div><div class="line"><a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, myConfig, key);</div><div class="line">Key * result = <a class="code" href="group__keyset.html#gad2e30fb6d4739d917c5abb2ac2f9c1a1">ksLookupByName</a> (myConfig, <span class="stringliteral">&quot;/sw/tests/myapp/#0/current/testkey1&quot;</span>, 0);</div><div class="line">        <span class="comment">// clang-format on</span></div><div class="line"></div><div class="line">        <a class="code" href="group__key.html#ga3df95bbc2494e3e6703ece5639be5bb1">keyDel</a> (key);</div><div class="line"></div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> * key_name = <a class="code" href="group__keyname.html#ga8e805c726a60da921d3736cda7813513">keyName</a> (result);</div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> * key_value = <a class="code" href="group__keyvalue.html#ga880936f2481d28e6e2acbe7486a21d05">keyString</a> (result);</div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> * key_comment = <a class="code" href="group__keyvalue.html#ga880936f2481d28e6e2acbe7486a21d05">keyString</a> (<a class="code" href="group__keymeta.html#ga9ed3875495ddb3d8a8d29158a60a147c">keyGetMeta</a> (result, <span class="stringliteral">&quot;comment&quot;</span>));</div><div class="line">        printf (<span class="stringliteral">&quot;key: %s value: %s comment: %s\n&quot;</span>, key_name, key_value, key_comment);</div><div class="line"></div><div class="line">        <a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (myConfig); <span class="comment">// delete the in-memory configuration</span></div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// maybe you want kdbSet() myConfig here</span></div><div class="line"></div><div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (handle, 0); <span class="comment">// no more affairs with the key database.</span></div><div class="line">}</div></div><!-- fragment --><p>When a backend fails <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> will return -1 with all error and warning information in the <code>parentKey</code>. The parameter <code>returned</code> will not be changed.</p>
<dl class="section user"><dt>Optimization:</dt><dd>In the first run of kdbGet all requested (or more) keys are retrieved. On subsequent calls only the keys are retrieved where something was changed inside the key database. The other keys stay in the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> returned as passed.</dd></dl>
<p>It is your responsibility to save the original keyset if you need it afterwards.</p>
<p>If you want to be sure to get a fresh keyset again, you need to open a second handle to the key database using <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">opened </a> key database </td></tr>
    <tr><td class="paramname">parentKey</td><td>is used to add warnings and set an error information. Additionally, its name is a hint which keys should be retrieved (it is possible that more are retrieved, see Note above).<ul>
<li>cascading keys (starting with /) will retrieve the same path in all namespaces</li>
<li>/ will retrieve all keys </li>
</ul>
</td></tr>
    <tr><td class="paramname">ks</td><td>the (pre-initialized) <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> returned with all keys found will not be changed on error or if no update is required </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keyset.html#gaa34fc43a081e6b01e4120daa6c112004" title="Look for a Key contained in ks that matches the name of the key. ">ksLookup()</a>, <a class="el" href="group__keyset.html#gad2e30fb6d4739d917c5abb2ac2f9c1a1" title="Convenience method to look for a Key contained in ks that matches name. ">ksLookupByName()</a> for powerful lookups after the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> was retrieved </dd>
<dd>
<a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a> which needs to be called before </dd>
<dd>
<a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a> to save the configuration afterwards and <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a> to finish affairs with the <a class="el" href="group__key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> database. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if the keys were retrieved successfully </td></tr>
    <tr><td class="paramname">0</td><td>if there was no update - no changes are made to the keyset then </td></tr>
    <tr><td class="paramname">-1</td><td>on failure - no changes are made to the keyset then</td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="kdb_8hpp.html">kdb.hpp</a>&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="keyio_8hpp.html">keyio.hpp</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span>kdb;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="testio__doc_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> ()</div><div class="line">{</div><div class="line">        KeySet config;</div><div class="line">        <a class="code" href="classkdb_1_1KDB.html">KDB</a> kdb;</div><div class="line">        kdb.<a class="code" href="classkdb_1_1KDB.html#a0419ffbc273c89756bc523b4223ec25a">get</a> (config, <span class="stringliteral">&quot;/sw/MyApp&quot;</span>);</div><div class="line"></div><div class="line">        <a class="code" href="classkdb_1_1Key.html">Key</a> k = config.<a class="code" href="classkdb_1_1KeySet.html#a78125fb19c6aebb0d8fc1a7238b78ace">lookup</a> (<span class="stringliteral">&quot;/sw/MyApp/mykey&quot;</span>);</div><div class="line">        <span class="keywordflow">if</span> (k)</div><div class="line">        {</div><div class="line">                std::cout &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; k.<a class="code" href="classkdb_1_1Key.html#ac558a1f1b2cb50d77fbabcbb24950c05">get</a>&lt;<span class="keywordtype">int</span>&gt; () &lt;&lt; std::endl;</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">        {</div><div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot;No key found&quot;</span> &lt;&lt; std::endl;</div><div class="line">                <span class="keywordflow">return</span> 1;</div><div class="line">        }</div><div class="line">}</div></div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">returned</td><td>the keyset where the keys will be in </td></tr>
    <tr><td class="paramname">keyname</td><td>the root keyname which should be used to get keys below it</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if no key was updated </td></tr>
    <tr><td class="paramname">1</td><td>if user or system keys were updated </td></tr>
    <tr><td class="paramname">2</td><td>if user and system keys were updated</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if there were problems with the database</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classkdb_1_1KDB.html#a0419ffbc273c89756bc523b4223ec25a" title="Get all keys below keyname inside returned. ">KDB::get</a> (<a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> &amp; returned, <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> &amp; parentKey) </dd></dl>

<p>Reimplemented in <a class="el" href="classkdb_1_1tools_1_1merging_1_1MergingKDB.html#a0d2a28f24aeb6ba3e81af73ef8b98df7">kdb::tools::merging::MergingKDB</a>.</p>

</div>
</div>
<a id="a48770a7290699bf2b7529f3ab67e378f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48770a7290699bf2b7529f3ab67e378f">&#9670;&nbsp;</a></span>get() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int kdb::KDB::get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;&#160;</td>
          <td class="paramname"><em>returned</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkdb_1_1Key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>parentKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get all keys below parentKey inside returned. </p>
<p>Retrieve keys in an atomic and universal way. </p><dl class="section pre"><dt>Precondition</dt><dd>The <code>handle</code> must be passed as returned from <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a>.</dd>
<dd>
The <code>returned</code> <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> must be a valid <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a>, e.g. constructed with <a class="el" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c" title="Allocate, initialize and return a new KeySet object. ">ksNew()</a>.</dd>
<dd>
The <code>parentKey</code> <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> must be a valid <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a>, e.g. constructed with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a>.</dd></dl>
<p>If you pass NULL on any parameter <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> will fail immediately without doing anything.</p>
<p>The <code>returned</code> <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> may already contain some keys, e.g. from previous <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> calls. The new retrieved keys will be appended using <a class="el" href="group__keyset.html#gaa5a1d467a4d71041edce68ea7748ce45" title="Appends a Key to the end of ks. ">ksAppendKey()</a>.</p>
<p>If not done earlier <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> will fully retrieve all keys under the <code>parentKey</code> folder recursively (See Optimization below when it will not be done).</p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> might retrieve more keys than requested (that are not below parentKey). These keys must be passed to calls of <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a>, otherwise they will be lost. This stems from the fact that the user has the only copy of the whole configuration and backends only write configuration that was passed to them. For example, if you <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> "system/mountpoint/interest" you will not only get all keys below system/mountpoint/interest, but also all keys below system/mountpoint (if system/mountpoint is a mountpoint as the name suggests, but system/mountpoint/interest is not a mountpoint). Make sure to not touch or remove keys outside the keys of interest, because others may need them!</dd></dl>
<dl class="section user"><dt>Example:</dt><dd>This example demonstrates the typical usecase within an application (without error handling).</dd></dl>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;kdb.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="testio__doc_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">        KeySet * myConfig = <a class="code" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c">ksNew</a> (0, <a class="code" href="kdbenum_8c.html#a7a28fce3773b2c873c94ac80b8b4cd54">KS_END</a>);</div><div class="line"></div><div class="line">        <span class="comment">// for error handling see kdbget_error.c</span></div><div class="line"></div><div class="line">        <span class="comment">// clang-format off</span></div><div class="line"><span class="comment"></span>Key * key = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/sw/tests/myapp/#0/current/&quot;</span>,  <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div><div class="line"><a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * handle = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">kdbOpen</a> (key);</div><div class="line"><a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, myConfig, key);</div><div class="line">Key * result = <a class="code" href="group__keyset.html#gad2e30fb6d4739d917c5abb2ac2f9c1a1">ksLookupByName</a> (myConfig, <span class="stringliteral">&quot;/sw/tests/myapp/#0/current/testkey1&quot;</span>, 0);</div><div class="line">        <span class="comment">// clang-format on</span></div><div class="line"></div><div class="line">        <a class="code" href="group__key.html#ga3df95bbc2494e3e6703ece5639be5bb1">keyDel</a> (key);</div><div class="line"></div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> * key_name = <a class="code" href="group__keyname.html#ga8e805c726a60da921d3736cda7813513">keyName</a> (result);</div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> * key_value = <a class="code" href="group__keyvalue.html#ga880936f2481d28e6e2acbe7486a21d05">keyString</a> (result);</div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> * key_comment = <a class="code" href="group__keyvalue.html#ga880936f2481d28e6e2acbe7486a21d05">keyString</a> (<a class="code" href="group__keymeta.html#ga9ed3875495ddb3d8a8d29158a60a147c">keyGetMeta</a> (result, <span class="stringliteral">&quot;comment&quot;</span>));</div><div class="line">        printf (<span class="stringliteral">&quot;key: %s value: %s comment: %s\n&quot;</span>, key_name, key_value, key_comment);</div><div class="line"></div><div class="line">        <a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (myConfig); <span class="comment">// delete the in-memory configuration</span></div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// maybe you want kdbSet() myConfig here</span></div><div class="line"></div><div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (handle, 0); <span class="comment">// no more affairs with the key database.</span></div><div class="line">}</div></div><!-- fragment --><p>When a backend fails <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> will return -1 with all error and warning information in the <code>parentKey</code>. The parameter <code>returned</code> will not be changed.</p>
<dl class="section user"><dt>Optimization:</dt><dd>In the first run of kdbGet all requested (or more) keys are retrieved. On subsequent calls only the keys are retrieved where something was changed inside the key database. The other keys stay in the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> returned as passed.</dd></dl>
<p>It is your responsibility to save the original keyset if you need it afterwards.</p>
<p>If you want to be sure to get a fresh keyset again, you need to open a second handle to the key database using <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">opened </a> key database </td></tr>
    <tr><td class="paramname">parentKey</td><td>is used to add warnings and set an error information. Additionally, its name is a hint which keys should be retrieved (it is possible that more are retrieved, see Note above).<ul>
<li>cascading keys (starting with /) will retrieve the same path in all namespaces</li>
<li>/ will retrieve all keys </li>
</ul>
</td></tr>
    <tr><td class="paramname">ks</td><td>the (pre-initialized) <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> returned with all keys found will not be changed on error or if no update is required </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keyset.html#gaa34fc43a081e6b01e4120daa6c112004" title="Look for a Key contained in ks that matches the name of the key. ">ksLookup()</a>, <a class="el" href="group__keyset.html#gad2e30fb6d4739d917c5abb2ac2f9c1a1" title="Convenience method to look for a Key contained in ks that matches name. ">ksLookupByName()</a> for powerful lookups after the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> was retrieved </dd>
<dd>
<a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a> which needs to be called before </dd>
<dd>
<a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a> to save the configuration afterwards and <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a> to finish affairs with the <a class="el" href="group__key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> database. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if the keys were retrieved successfully </td></tr>
    <tr><td class="paramname">0</td><td>if there was no update - no changes are made to the keyset then </td></tr>
    <tr><td class="paramname">-1</td><td>on failure - no changes are made to the keyset then</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">returned</td><td>the keyset where the keys will be in </td></tr>
    <tr><td class="paramname">parentKey</td><td>the parentKey of returned</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if no key was updated </td></tr>
    <tr><td class="paramname">1</td><td>if user or system keys were updated </td></tr>
    <tr><td class="paramname">2</td><td>if user and system keys were updated</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if there were problems with the database </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classkdb_1_1tools_1_1merging_1_1MergingKDB.html#a062b1dac733aa3999691f8d70635b09c">kdb::tools::merging::MergingKDB</a>.</p>

</div>
</div>
<a id="aee37484b06164eacc0cc11b7b40ab892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee37484b06164eacc0cc11b7b40ab892">&#9670;&nbsp;</a></span>open()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kdb::KDB::open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1Key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>errorKey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Open the database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorKey</td><td>is useful if you want to get the warnings in the successful case, when no exception is thrown.</td></tr>
  </table>
  </dd>
</dl>
<p>Opens the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a></dd></dl>
<p>The method will bootstrap itself the following way. The first step is to open the default backend. With it system/elektra/mountpoints will be loaded and all needed libraries and mountpoints will be determined. These libraries for backends will be loaded and with it the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a></code> data structure will be initialized.</p>
<p>You must always call this method before retrieving or committing any keys to the database. In the end of the program, after using the key database, you must not forget to <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a>.</p>
<p>The pointer to the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a></code> structure returned will be initialized like described above, and it must be passed along on any kdb*() method your application calls.</p>
<p>Get a <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a></code> handle for every thread using elektra. Don't share the handle across threads, and also not the pointer accessing it:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> thread1 (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part1&quot;</span>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40afc1567f74444ff9c219f7456b652b4ec">KEY_CASCADING_NAME</a>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div><div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">kdbOpen</a> (parent);</div><div class="line">        <span class="comment">// fetch keys and work with them</span></div><div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span> thread2 (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part2&quot;</span>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40afc1567f74444ff9c219f7456b652b4ec">KEY_CASCADING_NAME</a>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div><div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">kdbOpen</a> (parent);</div><div class="line">        <span class="comment">// fetch keys and work with them</span></div><div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div><div class="line">}</div></div><!-- fragment --><p> You don't need <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a> if you only want to manipulate plain in-memory <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> or <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> objects.</p>
<dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorKey</td><td>the key which holds errors and warnings which were issued </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a>, <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a> to end all affairs to the <a class="el" href="group__key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> database. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">handle</td><td>on success </td></tr>
    <tr><td class="paramname">NULL</td><td>on failure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a29087a6a1a7de334f4e5b62ffe5d6e6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29087a6a1a7de334f4e5b62ffe5d6e6e">&#9670;&nbsp;</a></span>set() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int kdb::KDB::set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;&#160;</td>
          <td class="paramname"><em>returned</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>keyname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set all keys below keyname. </p>
<p>If the keyname of the parentKey is invalid (e.g. empty) all keys will be set.</p>
<p>Set keys in an atomic and universal way. </p><dl class="section pre"><dt>Precondition</dt><dd><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> must be called before <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a>:<ul>
<li>initially (after <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a>)</li>
<li>after conflict errors in <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a>.</li>
</ul>
</dd>
<dd>
The <code>returned</code> <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> must be a valid <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a>, e.g. constructed with <a class="el" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c" title="Allocate, initialize and return a new KeySet object. ">ksNew()</a>.</dd>
<dd>
The <code>parentKey</code> <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> must be a valid <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a>, e.g. constructed with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a>.</dd></dl>
<p>If you pass NULL on any parameter <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a> will fail immediately without doing anything.</p>
<p>With <code>parentKey</code> you can give an hint which part of the given keyset is of interest for you. Then you promise to only modify or remove keys below this key. All others would be passed back as they were retrieved by <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a>.</p>
<dl class="section user"><dt>Errors</dt><dd>If some error occurs:<ul>
<li><a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a> will leave the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a>'s * internal cursor on the key that generated the error.</li>
<li>Error information will be written into the metadata of the parent key.</li>
<li>None of the keys are actually committed in this situation, i.e. no configuration file will be modified.</li>
</ul>
</dd></dl>
<p>In case of errors you should present the error message to the user and let the user decide what to do. Possible solutions are:</p><ul>
<li>remove the problematic key and use <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a> again (for validation or type errors)</li>
<li>change the value of the problematic key and use <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a> again (for validation errors)</li>
<li>do a <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> (for conflicts, i.e. error 30) and then<ul>
<li>set the same keyset again (in favour of what was set by this user)</li>
<li>drop the old keyset (in favour of what was set from another application)</li>
<li>merge the original, your own and the other keyset</li>
</ul>
</li>
<li>export the configuration into a file (for unresolvable errors)</li>
<li>repeat the same kdbSet might be of limited use if the user does not explicitly request it, because temporary errors are rare and its unlikely that they fix themselves (e.g. disc full, permission problems)</li>
</ul>
<dl class="section user"><dt>Optimization</dt><dd>Each key is checked with <a class="el" href="group__keytest.html#gaf247df0de7aca04b32ef80e39ef12950" title="Test if a key needs to be synced to backend storage. ">keyNeedSync()</a> before being actually committed. If no key of a backend needs to be synced any affairs to backends are omitted and 0 is returned.</dd></dl>
<div class="fragment"><div class="line">KeySet * myConfig = <a class="code" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c">ksNew</a> (0, <a class="code" href="kdbenum_8c.html#a7a28fce3773b2c873c94ac80b8b4cd54">KS_END</a>);</div><div class="line">Key * parentKey = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;system/sw/MyApp&quot;</span>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div><div class="line"><a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * handle = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">kdbOpen</a> (parentKey);</div><div class="line"></div><div class="line"><a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, myConfig, parentKey); <span class="comment">// kdbGet needs to be called first!</span></div><div class="line">KeySet * base = <a class="code" href="group__keyset.html#gac59e4b328245463f1451f68d5106151c">ksDup</a> (myConfig);     <span class="comment">// save a copy of original keyset</span></div><div class="line"></div><div class="line"><span class="comment">// change the keys within myConfig</span></div><div class="line"></div><div class="line">KeySet * ours = <a class="code" href="group__keyset.html#gac59e4b328245463f1451f68d5106151c">ksDup</a> (myConfig); <span class="comment">// save a copy of our keyset</span></div><div class="line">KeySet * theirs;                  <span class="comment">// needed for 3-way merging</span></div><div class="line"><span class="keywordtype">int</span> ret = <a class="code" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet</a> (handle, myConfig, parentKey);</div><div class="line"><span class="keywordflow">while</span> (ret == -1) <span class="comment">// as long as we have an error</span></div><div class="line">{</div><div class="line">        <span class="comment">// We got an error. Warn user.</span></div><div class="line">        Key * problemKey = <a class="code" href="group__keyset.html#ga4287b9416912c5f2ab9c195cb74fb094">ksCurrent</a> (myConfig);</div><div class="line">        <span class="comment">// parentKey has the errorInformation</span></div><div class="line">        <span class="comment">// problemKey is the faulty key (may be null)</span></div><div class="line">        <span class="keywordtype">int</span> userInput = showElektraErrorDialog (parentKey, problemKey);</div><div class="line">        <span class="keywordflow">switch</span> (userInput)</div><div class="line">        {</div><div class="line">        <span class="keywordflow">case</span> INPUT_USE_OURS:</div><div class="line">                <a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, myConfig, parentKey); <span class="comment">// refresh key database</span></div><div class="line">                <a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (myConfig);</div><div class="line">                myConfig = ours;</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> INPUT_DO_MERGE:</div><div class="line">                theirs = <a class="code" href="group__keyset.html#gac59e4b328245463f1451f68d5106151c">ksDup</a> (ours);</div><div class="line">                <a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, theirs, parentKey); <span class="comment">// refresh key database</span></div><div class="line">                KeySet * res = doElektraMerge (ours, theirs, base);</div><div class="line">                <a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (theirs);</div><div class="line">                myConfig = res;</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> INPUT_USE_THEIRS:</div><div class="line">                <span class="comment">// should always work, we just write what we got</span></div><div class="line">                <span class="comment">// but to be sure always give the user another way</span></div><div class="line">                <span class="comment">// to exit the loop</span></div><div class="line">                <a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, myConfig, parentKey); <span class="comment">// refresh key database</span></div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">                <span class="comment">// other cases ...</span></div><div class="line">        }</div><div class="line">        ret = <a class="code" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet</a> (handle, myConfig, parentKey);</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (ours);</div><div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (base);</div><div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (myConfig); <span class="comment">// delete the in-memory configuration</span></div><div class="line"></div><div class="line"><a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (handle, parentKey); <span class="comment">// no more affairs with the key database.</span></div><div class="line"><a class="code" href="group__key.html#ga3df95bbc2494e3e6703ece5639be5bb1">keyDel</a> (parentKey);</div></div><!-- fragment --><p> showElektraErrorDialog() and doElektraMerge() need to be implemented by the user of Elektra. For doElektraMerge a 3-way merge algorithm exists in libelektra-tools.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">opened </a> key database </td></tr>
    <tr><td class="paramname">ks</td><td>a <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> which should contain changed keys, otherwise nothing is done </td></tr>
    <tr><td class="paramname">parentKey</td><td>is used to add warnings and set an error information. Additionally, its name is an hint which keys should be committed (it is possible that more are changed).<ul>
<li>cascading keys (starting with /) will set the path in all namespaces</li>
<li>/ will commit all keys</li>
<li>metanames will be rejected (error 104)</li>
<li>empty/invalid (error 105) </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>on success </td></tr>
    <tr><td class="paramname">0</td><td>if nothing had to be done, no changes in <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a> </td></tr>
    <tr><td class="paramname">-1</td><td>on failure, no changes in <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keytest.html#gaf247df0de7aca04b32ef80e39ef12950" title="Test if a key needs to be synced to backend storage. ">keyNeedSync()</a> </dd>
<dd>
<a class="el" href="group__keyset.html#ga4287b9416912c5f2ab9c195cb74fb094" title="Return the current Key. ">ksCurrent()</a> contains the error <a class="el" href="group__key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> </dd>
<dd>
<a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a> and <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> that must be called first </dd>
<dd>
<a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a> that must be called afterwards</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if no key was updated </td></tr>
    <tr><td class="paramname">1</td><td>if user or system keys were updated </td></tr>
    <tr><td class="paramname">2</td><td>if user and system keys were updated</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">returned</td><td>the keyset where the keys will be in </td></tr>
    <tr><td class="paramname">keyname</td><td>the keyname below the names should be set</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if there were problems with the database </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a62a4fafbe21d9519b31a7868aa05f3e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62a4fafbe21d9519b31a7868aa05f3e3">&#9670;&nbsp;</a></span>set() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int kdb::KDB::set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;&#160;</td>
          <td class="paramname"><em>returned</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkdb_1_1Key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>parentKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set all keys below parentKey. </p>
<p>If the keyname of the parentKey is invalid (e.g. empty) all keys will be set.</p>
<p>Set keys in an atomic and universal way. </p><dl class="section pre"><dt>Precondition</dt><dd><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> must be called before <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a>:<ul>
<li>initially (after <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a>)</li>
<li>after conflict errors in <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a>.</li>
</ul>
</dd>
<dd>
The <code>returned</code> <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> must be a valid <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a>, e.g. constructed with <a class="el" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c" title="Allocate, initialize and return a new KeySet object. ">ksNew()</a>.</dd>
<dd>
The <code>parentKey</code> <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> must be a valid <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a>, e.g. constructed with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step. ">keyNew()</a>.</dd></dl>
<p>If you pass NULL on any parameter <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a> will fail immediately without doing anything.</p>
<p>With <code>parentKey</code> you can give an hint which part of the given keyset is of interest for you. Then you promise to only modify or remove keys below this key. All others would be passed back as they were retrieved by <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a>.</p>
<dl class="section user"><dt>Errors</dt><dd>If some error occurs:<ul>
<li><a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a> will leave the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a>'s * internal cursor on the key that generated the error.</li>
<li>Error information will be written into the metadata of the parent key.</li>
<li>None of the keys are actually committed in this situation, i.e. no configuration file will be modified.</li>
</ul>
</dd></dl>
<p>In case of errors you should present the error message to the user and let the user decide what to do. Possible solutions are:</p><ul>
<li>remove the problematic key and use <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a> again (for validation or type errors)</li>
<li>change the value of the problematic key and use <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set keys in an atomic and universal way. ">kdbSet()</a> again (for validation errors)</li>
<li>do a <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> (for conflicts, i.e. error 30) and then<ul>
<li>set the same keyset again (in favour of what was set by this user)</li>
<li>drop the old keyset (in favour of what was set from another application)</li>
<li>merge the original, your own and the other keyset</li>
</ul>
</li>
<li>export the configuration into a file (for unresolvable errors)</li>
<li>repeat the same kdbSet might be of limited use if the user does not explicitly request it, because temporary errors are rare and its unlikely that they fix themselves (e.g. disc full, permission problems)</li>
</ul>
<dl class="section user"><dt>Optimization</dt><dd>Each key is checked with <a class="el" href="group__keytest.html#gaf247df0de7aca04b32ef80e39ef12950" title="Test if a key needs to be synced to backend storage. ">keyNeedSync()</a> before being actually committed. If no key of a backend needs to be synced any affairs to backends are omitted and 0 is returned.</dd></dl>
<div class="fragment"><div class="line">KeySet * myConfig = <a class="code" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c">ksNew</a> (0, <a class="code" href="kdbenum_8c.html#a7a28fce3773b2c873c94ac80b8b4cd54">KS_END</a>);</div><div class="line">Key * parentKey = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;system/sw/MyApp&quot;</span>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div><div class="line"><a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * handle = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">kdbOpen</a> (parentKey);</div><div class="line"></div><div class="line"><a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, myConfig, parentKey); <span class="comment">// kdbGet needs to be called first!</span></div><div class="line">KeySet * base = <a class="code" href="group__keyset.html#gac59e4b328245463f1451f68d5106151c">ksDup</a> (myConfig);     <span class="comment">// save a copy of original keyset</span></div><div class="line"></div><div class="line"><span class="comment">// change the keys within myConfig</span></div><div class="line"></div><div class="line">KeySet * ours = <a class="code" href="group__keyset.html#gac59e4b328245463f1451f68d5106151c">ksDup</a> (myConfig); <span class="comment">// save a copy of our keyset</span></div><div class="line">KeySet * theirs;                  <span class="comment">// needed for 3-way merging</span></div><div class="line"><span class="keywordtype">int</span> ret = <a class="code" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet</a> (handle, myConfig, parentKey);</div><div class="line"><span class="keywordflow">while</span> (ret == -1) <span class="comment">// as long as we have an error</span></div><div class="line">{</div><div class="line">        <span class="comment">// We got an error. Warn user.</span></div><div class="line">        Key * problemKey = <a class="code" href="group__keyset.html#ga4287b9416912c5f2ab9c195cb74fb094">ksCurrent</a> (myConfig);</div><div class="line">        <span class="comment">// parentKey has the errorInformation</span></div><div class="line">        <span class="comment">// problemKey is the faulty key (may be null)</span></div><div class="line">        <span class="keywordtype">int</span> userInput = showElektraErrorDialog (parentKey, problemKey);</div><div class="line">        <span class="keywordflow">switch</span> (userInput)</div><div class="line">        {</div><div class="line">        <span class="keywordflow">case</span> INPUT_USE_OURS:</div><div class="line">                <a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, myConfig, parentKey); <span class="comment">// refresh key database</span></div><div class="line">                <a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (myConfig);</div><div class="line">                myConfig = ours;</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> INPUT_DO_MERGE:</div><div class="line">                theirs = <a class="code" href="group__keyset.html#gac59e4b328245463f1451f68d5106151c">ksDup</a> (ours);</div><div class="line">                <a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, theirs, parentKey); <span class="comment">// refresh key database</span></div><div class="line">                KeySet * res = doElektraMerge (ours, theirs, base);</div><div class="line">                <a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (theirs);</div><div class="line">                myConfig = res;</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> INPUT_USE_THEIRS:</div><div class="line">                <span class="comment">// should always work, we just write what we got</span></div><div class="line">                <span class="comment">// but to be sure always give the user another way</span></div><div class="line">                <span class="comment">// to exit the loop</span></div><div class="line">                <a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, myConfig, parentKey); <span class="comment">// refresh key database</span></div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">                <span class="comment">// other cases ...</span></div><div class="line">        }</div><div class="line">        ret = <a class="code" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet</a> (handle, myConfig, parentKey);</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (ours);</div><div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (base);</div><div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (myConfig); <span class="comment">// delete the in-memory configuration</span></div><div class="line"></div><div class="line"><a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (handle, parentKey); <span class="comment">// no more affairs with the key database.</span></div><div class="line"><a class="code" href="group__key.html#ga3df95bbc2494e3e6703ece5639be5bb1">keyDel</a> (parentKey);</div></div><!-- fragment --><p> showElektraErrorDialog() and doElektraMerge() need to be implemented by the user of Elektra. For doElektraMerge a 3-way merge algorithm exists in libelektra-tools.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">opened </a> key database </td></tr>
    <tr><td class="paramname">ks</td><td>a <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys. ">KeySet</a> which should contain changed keys, otherwise nothing is done </td></tr>
    <tr><td class="paramname">parentKey</td><td>is used to add warnings and set an error information. Additionally, its name is an hint which keys should be committed (it is possible that more are changed).<ul>
<li>cascading keys (starting with /) will set the path in all namespaces</li>
<li>/ will commit all keys</li>
<li>metanames will be rejected (error 104)</li>
<li>empty/invalid (error 105) </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>on success </td></tr>
    <tr><td class="paramname">0</td><td>if nothing had to be done, no changes in <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a> </td></tr>
    <tr><td class="paramname">-1</td><td>on failure, no changes in <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB. ">KDB</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keytest.html#gaf247df0de7aca04b32ef80e39ef12950" title="Test if a key needs to be synced to backend storage. ">keyNeedSync()</a> </dd>
<dd>
<a class="el" href="group__keyset.html#ga4287b9416912c5f2ab9c195cb74fb094" title="Return the current Key. ">ksCurrent()</a> contains the error <a class="el" href="group__key.html" title="Key is an essential class that encapsulates key name , value  and metainfo . ">Key</a> </dd>
<dd>
<a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a> and <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way. ">kdbGet()</a> that must be called first </dd>
<dd>
<a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a> that must be called afterwards</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if no key was updated </td></tr>
    <tr><td class="paramname">1</td><td>if user or system keys were updated </td></tr>
    <tr><td class="paramname">2</td><td>if user and system keys were updated</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">returned</td><td>the keyset where the keys are passed to the user </td></tr>
    <tr><td class="paramname">parentKey</td><td>the parentKey of returned</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if there were problems with the database </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="kdb_8hpp.html">kdb.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
