<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: Arrays</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.8.24</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Arrays </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Key-Value Pairs</h2>
<p>The main building block of Elektra’s database are hierarchical <a href="https://en.wikipedia.org/wiki/Key-value_database">key-value pairs</a>. You can create such a pair using <a class="el" href="md_doc_help_kdb-set.html#doc_help_kdb-set_md">`kdb set`</a>:</p>
<div class="fragment"><div class="line">kdb set user/tests/parent value</div><div class="line">#&gt; Create a new key user/tests/parent with string &quot;value&quot;</div></div><!-- fragment --><p>. The command above created a key <code>user/tests/parent</code> with the value <code>value</code>. Since Elektra uses a hierarchical database we can also create keys <b>below</b> <code>user/tests/parent</code>:</p>
<div class="fragment"><div class="line"># If we do not provide a value, then `kdb set` creates keys with `null` values.</div><div class="line">kdb set user/tests/parent/son</div><div class="line">#&gt; Create a new key user/tests/parent/son with null value</div><div class="line"></div><div class="line">kdb set user/tests/parent/daughter</div><div class="line">#&gt; Create a new key user/tests/parent/daughter with null value</div><div class="line"></div><div class="line">kdb set user/tests/parent/daughter/grandchild</div><div class="line">#&gt; Create a new key user/tests/parent/daughter/grandchild with null value</div></div><!-- fragment --><p>. We can check the hierarchy of the keys using <code>kdb ls</code> and retrieve data using <code>kdb get</code>:</p>
<div class="fragment"><div class="line"># Elektra sorts keys alphabetically</div><div class="line">kdb ls user/tests/parent</div><div class="line">#&gt; user/tests/parent</div><div class="line">#&gt; user/tests/parent/daughter</div><div class="line">#&gt; user/tests/parent/daughter/grandchild</div><div class="line">#&gt; user/tests/parent/son</div><div class="line"></div><div class="line">kdb get user/tests/parent</div><div class="line">#&gt; value</div><div class="line">kdb get user/tests/parent/daughter</div><div class="line">#&gt;</div></div><!-- fragment --><h2>Array Keys</h2>
<p>Since Elektra sorts keys alphabetically we can use the key-value pair structure described above to store sequences of values (aka. arrays).</p>
<h3>Empty Arrays</h3>
<p>For an <b>empty array</b> (<code>[]</code>) we just add the <a class="el" href="md_doc_help_elektra-metadata.html#doc_help_elektra-metadata_md">metakey</a> <code>array</code>:</p>
<p>``<code> &lt;h1&gt;Create an empty array with the name</code>user/tests/sequence` kdb setmeta user/tests/sequence array '' </p><div class="fragment"><div class="line">.</div><div class="line"></div><div class="line">### Array Elements</div><div class="line"></div><div class="line">To create an **array element** we start the basename of a key with the `#` character and add the index of the array element afterwards. For example, the commands below adds three elements to our array `user/tests/sequence`:</div></div><!-- fragment --><p> kdb set user/tests/sequence/#0 'First Element' kdb set user/tests/sequence/#1 'Second Element' </p><h1>Arrays do not need to be contiguous</h1>
<p>kdb set user/tests/sequence/#3 'Fourth Element' </p><div class="fragment"><div class="line">. As you can see above arrays can contain “empty fields”: The key `user/tests/sequence/#2` is missing.</div><div class="line"></div><div class="line">For array elements with an index larger than `9` we must add **underscores** (`_`) to the basename, so we do not destroy the alphabetic order of the array. For example, to add a eleventh element to our array we use the following command:</div></div><!-- fragment --><p> kdb set user/tests/sequence/#_10 'Eleventh Element' </p><div class="fragment"><div class="line">. The order of the array sequence is still correct afterwards, as the following command shows:</div></div><!-- fragment --> <h1>List all array elements</h1>
<p>kdb ls user/tests/sequence/ #&gt; user/tests/sequence/#0 #&gt; user/tests/sequence/#1 #&gt; user/tests/sequence/#3 #&gt; user/tests/sequence/#_10 </p><div class="fragment"><div class="line">. For larger indices we add **one underscore less, than the number of digits** of the index. For example, to add a element with index `1337` (`4` digits) we use the basename `#___1337`. We can also generate the basename programmatically:</div><div class="line"></div><div class="line">```bash</div><div class="line">ruby -e &#39;print(&quot;#&quot;, &quot;_&quot; * (ARGV[0].length - 1), ARGV[0])&#39; 12345</div><div class="line">#&gt; #____12345</div><div class="line"></div><div class="line">ruby -e &#39;print(&quot;#&quot;, &quot;_&quot; * (ARGV[0].length - 1), ARGV[0])&#39; 0</div><div class="line">#&gt; #0</div><div class="line"></div><div class="line">ruby -e &#39;print(&quot;#&quot;, &quot;_&quot; * (ARGV[0].length - 1), ARGV[0])&#39; 42</div><div class="line">#&gt; #_42</div></div><!-- fragment --><h3>Metadata</h3>
<p>To make life easier for users, Elektra’s <a class="el" href="doc_tutorials_plugins_md.html">storage plugins</a> should save the <a class="el" href="doc_decisions_array_md.html">basename of the last key in the array parent</a>. Some plugins do not support this feature. In that case you can add this value manually via <code>kdb setmeta</code>:</p>
<div class="fragment"><div class="line"># Add array elements</div><div class="line">kdb set user/tests/favorites/superheros/#0 &#39;One-Punch Man&#39;</div><div class="line">kdb set user/tests/favorites/superheros/#1 &#39;Mermaid Man and Barnacle Boy&#39;</div><div class="line">kdb set user/tests/favorites/superheros/#____99999 &#39;The guy with the bow and arrow&#39;</div><div class="line"></div><div class="line"># The metakey `array` should save the basename of the last element.</div><div class="line">kdb setmeta user/tests/favorites/superheros array &#39;#____99999&#39;</div></div><!-- fragment --><p>. This way you can always retrieve the last element of an array easily:</p>
<p>``<code> kdb get user/tests/favorites/superheros/</code>kdb getmeta user/tests/favorites/superheros array` #&gt; The guy with the bow and arrow </p><div class="fragment"><div class="line">.</div><div class="line"></div><div class="line"># Closing Remarks</div><div class="line"></div><div class="line">We close this tutorial by removing the data created by the commands above:</div></div><!-- fragment --><p> kdb rm -r user/tests ```</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
