<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: Plugin: multifile</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.9.6</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Plugin: multifile </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>infos = Information about the multifile plugin is in keys below</li>
<li>infos/author = Thomas <a href="#" onclick="location.href='mai'+'lto:'+'tho'+'ma'+'s.w'+'as'+'er@'+'li'+'bel'+'ek'+'tra'+'.o'+'rg'; return false;">thoma<span style="display: none;">.nosp@m.</span>s.wa<span style="display: none;">.nosp@m.</span>ser@l<span style="display: none;">.nosp@m.</span>ibel<span style="display: none;">.nosp@m.</span>ektra<span style="display: none;">.nosp@m.</span>.org</a></li>
<li>infos/licence = BSD</li>
<li>infos/needs =</li>
<li>infos/provides = resolver storage</li>
<li>infos/recommends =</li>
<li>infos/placements = getresolver setresolver commit rollback getstorage setstorage</li>
<li>infos/status = compatible specific shelltest nodep configurable</li>
<li>infos/metadata =</li>
<li>infos/description = mounts multiple files within a directory</li>
</ul>
<h1><a class="anchor" id="src_plugins_multifile_README_md"></a>
Introduction</h1>
<p>For some applications it is beneficially to have multiple configuration files. One way to achieve this, is to mount different files for the application.</p>
<p>In some situations we are not able to specify every configuration file with separate mounts because new configuration files might be created any time. Instead we want to include every configuration file matching a given pattern.</p>
<p>The multifile-resolver does so by calling resolver and storage plugins for each file matching a given pattern.</p>
<h1><a class="anchor" id="autotoc_md349"></a>
Plugin Configuration</h1>
<ul>
<li><code>recursive</code>: If present, fts (3) will be used to traverse the directory tree and fnmatch to match <code>pattern</code> to the filename. If not present, glob (3) with <code>pattern</code> will be used on the directory</li>
<li><code>pattern</code>: The pattern to be used to match configuration files.</li>
<li><code>storage</code>: The storage plugin to use.</li>
<li><code>resolver</code>: The resolver plugin to use.</li>
<li>'child/&lt;configname&gt;': configuration passed to the child backends, <code>child/</code> part gets removed.</li>
</ul>
<h1><a class="anchor" id="autotoc_md350"></a>
Usage</h1>
<p><code>kdb mount -R multifile -c storage="toml",pattern="*/*.toml",resolver="resolver" /path /mountpoint</code></p>
<p><code>kdb mount -R multifile -c storage="toml",pattern="*.toml",recursive=,resolver="resolver" /path /mountpoint</code></p>
<h1><a class="anchor" id="autotoc_md351"></a>
Examples</h1>
<div class="fragment"><div class="line">rm -rf $(dirname $(kdb file user:/))/multitest || $(exit 0)</div>
<div class="line">mkdir -p $(dirname $(kdb file user:/))/multitest || $(exit 0)</div>
<div class="line"> </div>
<div class="line">cat &gt; $(dirname $(kdb file user:/))/multitest/lo.toml &lt;&lt; EOF \</div>
<div class="line">[lo]\</div>
<div class="line">addr = &quot;127.0.0.1&quot;\</div>
<div class="line">encap = &quot;Loopback&quot;\</div>
<div class="line">EOF</div>
<div class="line"> </div>
<div class="line">cat &gt; $(dirname $(kdb file user:/))/multitest/lan.toml &lt;&lt; EOF \</div>
<div class="line">[eth0]\</div>
<div class="line">addr = &quot;192.168.1.216&quot;\</div>
<div class="line">encap = &quot;Ethernet&quot;\</div>
<div class="line">EOF</div>
<div class="line"> </div>
<div class="line">cat &gt; $(dirname $(kdb file user:/))/multitest/wlan.toml &lt;&lt; EOF \</div>
<div class="line">[wlan0]\</div>
<div class="line">addr = &quot;192.168.1.125&quot;\</div>
<div class="line">encap = &quot;Ethernet&quot;\</div>
<div class="line">EOF</div>
<div class="line"> </div>
<div class="line">sudo kdb mount -R multifile -c storage=&quot;toml&quot;,pattern=&quot;*.toml&quot;,resolver=&quot;resolver&quot; multitest user:/tests/multifile</div>
<div class="line"> </div>
<div class="line">kdb ls user:/tests/multifile</div>
<div class="line">#&gt; user:/tests/multifile/lan.toml/eth0</div>
<div class="line">#&gt; user:/tests/multifile/lan.toml/eth0/addr</div>
<div class="line">#&gt; user:/tests/multifile/lan.toml/eth0/encap</div>
<div class="line">#&gt; user:/tests/multifile/lo.toml/lo</div>
<div class="line">#&gt; user:/tests/multifile/lo.toml/lo/addr</div>
<div class="line">#&gt; user:/tests/multifile/lo.toml/lo/encap</div>
<div class="line">#&gt; user:/tests/multifile/wlan.toml/wlan0</div>
<div class="line">#&gt; user:/tests/multifile/wlan.toml/wlan0/addr</div>
<div class="line">#&gt; user:/tests/multifile/wlan.toml/wlan0/encap</div>
<div class="line"> </div>
<div class="line">kdb set user:/tests/multifile/lan.toml/eth0/addr 10.0.0.2</div>
<div class="line"> </div>
<div class="line">kdb get user:/tests/multifile/lan.toml/eth0/addr</div>
<div class="line">#&gt; 10.0.0.2</div>
<div class="line"> </div>
<div class="line">kdb get user:/tests/multifile/lan.toml/eth0/encap</div>
<div class="line">#&gt; Ethernet</div>
<div class="line"> </div>
<div class="line">cat &gt; $(dirname $(kdb file user:/))/multitest/test.toml &lt;&lt; EOF \</div>
<div class="line">[testsection]\</div>
<div class="line">key = &quot;val&quot;\</div>
<div class="line">EOF</div>
<div class="line"> </div>
<div class="line">kdb ls user:/tests/multifile/test.toml</div>
<div class="line">#&gt; user:/tests/multifile/test.toml/testsection</div>
<div class="line">#&gt; user:/tests/multifile/test.toml/testsection/key</div>
<div class="line"> </div>
<div class="line">kdb ls user:/tests/multifile</div>
<div class="line">#&gt; user:/tests/multifile/lan.toml/eth0</div>
<div class="line">#&gt; user:/tests/multifile/lan.toml/eth0/addr</div>
<div class="line">#&gt; user:/tests/multifile/lan.toml/eth0/encap</div>
<div class="line">#&gt; user:/tests/multifile/lo.toml/lo</div>
<div class="line">#&gt; user:/tests/multifile/lo.toml/lo/addr</div>
<div class="line">#&gt; user:/tests/multifile/lo.toml/lo/encap</div>
<div class="line">#&gt; user:/tests/multifile/test.toml/testsection</div>
<div class="line">#&gt; user:/tests/multifile/test.toml/testsection/key</div>
<div class="line">#&gt; user:/tests/multifile/wlan.toml/wlan0</div>
<div class="line">#&gt; user:/tests/multifile/wlan.toml/wlan0/addr</div>
<div class="line">#&gt; user:/tests/multifile/wlan.toml/wlan0/encap</div>
<div class="line"> </div>
<div class="line">kdb rm -r user:/tests/multifile/test.toml</div>
<div class="line"> </div>
<div class="line">stat $(dirname $(kdb file user:/))/multifile/test.toml</div>
<div class="line"># RET:1</div>
<div class="line"> </div>
<div class="line">sudo kdb umount user:/tests/multifile</div>
<div class="line">rm -rf $(dirname $(kdb file user:/))/multitest || $(exit 0)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md352"></a>
Limitations</h1>
<ul>
<li>You cannot get rid of the configuration file name.</li>
<li>You cannot create or delete configuration files.</li>
<li>The resolving will always be done with the default resolver plugin, despite the configuration option.</li>
<li>Not all file names are supported (see <a href="https://issues.libelektra.org/2124">https://issues.libelektra.org/2124</a>)</li>
<li>Cannot handle conflicts (see <a href="https://issues.libelektra.org/2527">https://issues.libelektra.org/2527</a>) </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
