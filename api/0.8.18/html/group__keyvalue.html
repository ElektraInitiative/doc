<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Elektra: Value Manipulation Methods</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.8.18</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Value Manipulation Methods<div class="ingroups"><a class="el" href="group__key.html">Key</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Methods to do various operations on Key values.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Value Manipulation Methods:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__keyvalue.png" border="0" alt="" usemap="#group____keyvalue"/>
<map name="group____keyvalue" id="group____keyvalue">
<area shape="rect" id="node2" href="group__key.html" title="Key is an essential class that encapsulates key name , value &#160;and metainfo . " alt="" coords="5,13,52,39"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga6f29609c5da53c6dc26a98678d5752af"><td class="memItemLeft" align="right" valign="top">const void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__keyvalue.html#ga6f29609c5da53c6dc26a98678d5752af">keyValue</a> (const Key *key)</td></tr>
<tr class="memdesc:ga6f29609c5da53c6dc26a98678d5752af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the real internal <code>key</code> value.  <a href="#ga6f29609c5da53c6dc26a98678d5752af">More...</a><br /></td></tr>
<tr class="separator:ga6f29609c5da53c6dc26a98678d5752af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga880936f2481d28e6e2acbe7486a21d05"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__keyvalue.html#ga880936f2481d28e6e2acbe7486a21d05">keyString</a> (const Key *key)</td></tr>
<tr class="memdesc:ga880936f2481d28e6e2acbe7486a21d05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the c-string representing the value.  <a href="#ga880936f2481d28e6e2acbe7486a21d05">More...</a><br /></td></tr>
<tr class="separator:ga880936f2481d28e6e2acbe7486a21d05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae326672fffb7474abfe9baf53b73217e"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__keyvalue.html#gae326672fffb7474abfe9baf53b73217e">keyGetValueSize</a> (const Key *key)</td></tr>
<tr class="memdesc:gae326672fffb7474abfe9baf53b73217e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of bytes needed to store the key value, including the NULL terminator.  <a href="#gae326672fffb7474abfe9baf53b73217e">More...</a><br /></td></tr>
<tr class="separator:gae326672fffb7474abfe9baf53b73217e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga41b9fac5ccddafe407fc0ae1e2eb8778"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__keyvalue.html#ga41b9fac5ccddafe407fc0ae1e2eb8778">keyGetString</a> (const Key *key, char *returnedString, size_t maxSize)</td></tr>
<tr class="memdesc:ga41b9fac5ccddafe407fc0ae1e2eb8778"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the value of a key as a string.  <a href="#ga41b9fac5ccddafe407fc0ae1e2eb8778">More...</a><br /></td></tr>
<tr class="separator:ga41b9fac5ccddafe407fc0ae1e2eb8778"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga622bde1eb0e0c4994728331326340ef2"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__keyvalue.html#ga622bde1eb0e0c4994728331326340ef2">keySetString</a> (Key *key, const char *newStringValue)</td></tr>
<tr class="memdesc:ga622bde1eb0e0c4994728331326340ef2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the value for <code>key</code> as <code>newStringValue</code>.  <a href="#ga622bde1eb0e0c4994728331326340ef2">More...</a><br /></td></tr>
<tr class="separator:ga622bde1eb0e0c4994728331326340ef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c0d8a4a11174197699c231e0b5c3c84"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__keyvalue.html#ga4c0d8a4a11174197699c231e0b5c3c84">keyGetBinary</a> (const Key *key, void *returnedBinary, size_t maxSize)</td></tr>
<tr class="memdesc:ga4c0d8a4a11174197699c231e0b5c3c84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the value of a key as a binary.  <a href="#ga4c0d8a4a11174197699c231e0b5c3c84">More...</a><br /></td></tr>
<tr class="separator:ga4c0d8a4a11174197699c231e0b5c3c84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa50a5358fd328d373a45f395fa1b99e7"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__keyvalue.html#gaa50a5358fd328d373a45f395fa1b99e7">keySetBinary</a> (Key *key, const void *newBinary, size_t dataSize)</td></tr>
<tr class="memdesc:gaa50a5358fd328d373a45f395fa1b99e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the value of a key as a binary.  <a href="#gaa50a5358fd328d373a45f395fa1b99e7">More...</a><br /></td></tr>
<tr class="separator:gaa50a5358fd328d373a45f395fa1b99e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Methods to do various operations on Key values. </p>
<p>A key can contain a value in different format. The most likely situation is, that the value is interpreted as text. Use <a class="el" href="group__keyvalue.html#ga41b9fac5ccddafe407fc0ae1e2eb8778" title="Get the value of a key as a string. ">keyGetString()</a> for that. You can save any Unicode Symbols and Elektra will take care that you get the same back, independent of your current environment.</p>
<p>In some situations this idea fails. When you need exactly the same value back without any interpretation of the characters, there is <a class="el" href="group__keyvalue.html#gaa50a5358fd328d373a45f395fa1b99e7" title="Set the value of a key as a binary. ">keySetBinary()</a>. If you use that, its very likely that your Configuration is not according to the standard. Also for Numbers, Booleans and Date you should use <a class="el" href="group__keyvalue.html#ga41b9fac5ccddafe407fc0ae1e2eb8778" title="Get the value of a key as a string. ">keyGetString()</a>. To do so, you might use strtod() strtol() and then atol() or atof() to convert back.</p>
<p>To use them: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;kdb.h&gt;</span></div>
</div><!-- fragment --> <h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga4c0d8a4a11174197699c231e0b5c3c84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t keyGetBinary </td>
          <td>(</td>
          <td class="paramtype">const Key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>returnedBinary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>maxSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the value of a key as a binary. </p>
<p>If the type is not binary -1 will be returned.</p>
<p>When the binary data is empty (this is not the same as ""!) 0 will be returned and the returnedBinary will not be changed.</p>
<p>For string values see <a class="el" href="group__keyvalue.html#ga41b9fac5ccddafe407fc0ae1e2eb8778" title="Get the value of a key as a string. ">keyGetString()</a> and <a class="el" href="group__keytest.html#gaea7670778abd07fee0fe8ac12a149190" title="Check if a key is string type. ">keyIsString()</a>.</p>
<p>When the returnedBinary is to small to hold the data (its maximum size is given by maxSize), the returnedBinary will not be changed and -1 is returned.</p>
<dl class="section user"><dt>Example:</dt><dd><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Key *key = keyNew (&quot;user/keyname&quot;, KEY_TYPE, KEY_TYPE_BINARY, KEY_END);</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;char buffer[300];</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;if (keyGetBinary(key,buffer,sizeof(buffer)) == -1)</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;{</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        // handle error</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;}</div>
</div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the object to gather the value from </td></tr>
    <tr><td class="paramname">returnedBinary</td><td>pre-allocated memory to store a copy of the key value </td></tr>
    <tr><td class="paramname">maxSize</td><td>number of bytes of pre-allocated memory in <code>returnedBinary</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the number of bytes actually copied to <code>returnedBinary</code> </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if the binary is empty </td></tr>
    <tr><td class="paramname">-1</td><td>on NULL pointers </td></tr>
    <tr><td class="paramname">-1</td><td>if maxSize is 0 </td></tr>
    <tr><td class="paramname">-1</td><td>if maxSize is too small for string </td></tr>
    <tr><td class="paramname">-1</td><td>if maxSize is larger than SSIZE_MAX </td></tr>
    <tr><td class="paramname">-1</td><td>on type mismatch: binary expected, but found string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keyvalue.html#ga6f29609c5da53c6dc26a98678d5752af" title="Return a pointer to the real internal key value. ">keyValue()</a>, <a class="el" href="group__keyvalue.html#gae326672fffb7474abfe9baf53b73217e" title="Returns the number of bytes needed to store the key value, including the NULL terminator. ">keyGetValueSize()</a>, <a class="el" href="group__keyvalue.html#gaa50a5358fd328d373a45f395fa1b99e7" title="Set the value of a key as a binary. ">keySetBinary()</a> </dd>
<dd>
<a class="el" href="group__keyvalue.html#ga41b9fac5ccddafe407fc0ae1e2eb8778" title="Get the value of a key as a string. ">keyGetString()</a> and <a class="el" href="group__keyvalue.html#ga622bde1eb0e0c4994728331326340ef2" title="Set the value for key as newStringValue. ">keySetString()</a> as preferred alternative to binary </dd>
<dd>
<a class="el" href="group__keytest.html#ga9526b371087564e43e3dff8ad0dac949" title="Check if a key is binary type. ">keyIsBinary()</a> to see how to check for binary type </dd></dl>

</div>
</div>
<a class="anchor" id="ga41b9fac5ccddafe407fc0ae1e2eb8778"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t keyGetString </td>
          <td>(</td>
          <td class="paramtype">const Key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>returnedString</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>maxSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the value of a key as a string. </p>
<p>When there is no value inside the string, 1 will be returned and the returnedString will be empty "" to avoid programming errors that old strings are shown to the user.</p>
<p>For binary values see <a class="el" href="group__keyvalue.html#ga4c0d8a4a11174197699c231e0b5c3c84" title="Get the value of a key as a binary. ">keyGetBinary()</a> and <a class="el" href="group__keytest.html#ga9526b371087564e43e3dff8ad0dac949" title="Check if a key is binary type. ">keyIsBinary()</a>.</p>
<dl class="section user"><dt>Example:</dt><dd><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Key *key = keyNew (&quot;user/keyname&quot;, KEY_END);</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;char buffer[300];</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;if (keyGetString(key,buffer,sizeof(buffer)) == -1)</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;{</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        // handle error</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;} else {</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        printf (&quot;buffer: %s\n&quot;, buffer);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;}</div>
</div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the object to gather the value from </td></tr>
    <tr><td class="paramname">returnedString</td><td>pre-allocated memory to store a copy of the key value </td></tr>
    <tr><td class="paramname">maxSize</td><td>number of bytes of allocated memory in <code>returnedString</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the number of bytes actually copied to <code>returnedString</code>, including final NULL </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if the string is empty </td></tr>
    <tr><td class="paramname">-1</td><td>on any NULL pointers </td></tr>
    <tr><td class="paramname">-1</td><td>on type mismatch: string expected, but found binary </td></tr>
    <tr><td class="paramname">-1</td><td>maxSize is 0 </td></tr>
    <tr><td class="paramname">-1</td><td>if maxSize is too small for string </td></tr>
    <tr><td class="paramname">-1</td><td>if maxSize is larger than SSIZE_MAX </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keyvalue.html#ga6f29609c5da53c6dc26a98678d5752af" title="Return a pointer to the real internal key value. ">keyValue()</a>, <a class="el" href="group__keyvalue.html#gae326672fffb7474abfe9baf53b73217e" title="Returns the number of bytes needed to store the key value, including the NULL terminator. ">keyGetValueSize()</a>, <a class="el" href="group__keyvalue.html#ga622bde1eb0e0c4994728331326340ef2" title="Set the value for key as newStringValue. ">keySetString()</a>, <a class="el" href="group__keyvalue.html#ga880936f2481d28e6e2acbe7486a21d05" title="Get the c-string representing the value. ">keyString()</a> </dd>
<dd>
<a class="el" href="group__keyvalue.html#ga4c0d8a4a11174197699c231e0b5c3c84" title="Get the value of a key as a binary. ">keyGetBinary()</a> for working with binary data </dd></dl>

</div>
</div>
<a class="anchor" id="gae326672fffb7474abfe9baf53b73217e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t keyGetValueSize </td>
          <td>(</td>
          <td class="paramtype">const Key *&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the number of bytes needed to store the key value, including the NULL terminator. </p>
<p>It returns the correct size, independent of the Key Type. If it is a binary there might be '\0' values in it.</p>
<p>For an empty string you need one byte to store the ending NULL. For that reason 1 is returned. This is not true for binary data, so there might be returned 0 too.</p>
<p>A binary key has no '\0' termination. String types have it, so to there length will be added 1 to have enough space to store it.</p>
<p>This method can be used with <a class="el" href="internal_8c.html#a35cdc2e5caed3454cb73b4fc7f37858c" title="Allocate memory for Elektra. ">elektraMalloc()</a> before <a class="el" href="group__keyvalue.html#ga41b9fac5ccddafe407fc0ae1e2eb8778" title="Get the value of a key as a string. ">keyGetString()</a> or <a class="el" href="group__keyvalue.html#ga4c0d8a4a11174197699c231e0b5c3c84" title="Get the value of a key as a binary. ">keyGetBinary()</a> is called.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;char *buffer;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;buffer = elektraMalloc (keyGetValueSize (key));</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;// use this buffer to store the value (binary or string)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;// pass keyGetValueSize (key) for maxSize</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the key object to work with </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the number of bytes needed to store the key value </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>when there is no data and type is not binary </td></tr>
    <tr><td class="paramname">0</td><td>when there is no data and type is binary </td></tr>
    <tr><td class="paramname">-1</td><td>on null pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keyvalue.html#ga41b9fac5ccddafe407fc0ae1e2eb8778" title="Get the value of a key as a string. ">keyGetString()</a>, <a class="el" href="group__keyvalue.html#ga4c0d8a4a11174197699c231e0b5c3c84" title="Get the value of a key as a binary. ">keyGetBinary()</a>, <a class="el" href="group__keyvalue.html#ga6f29609c5da53c6dc26a98678d5752af" title="Return a pointer to the real internal key value. ">keyValue()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaa50a5358fd328d373a45f395fa1b99e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t keySetBinary </td>
          <td>(</td>
          <td class="paramtype">Key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>newBinary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>dataSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the value of a key as a binary. </p>
<p>A private copy of <code>newBinary</code> will allocated and saved inside <code>key</code>, so the parameter can be deallocated after the call.</p>
<p>Binary values might be encoded in another way then string values depending on the plugin. Typically character encodings should not take place on binary data. Consider using a string key instead.</p>
<p>When newBinary is a NULL pointer the binary will be freed and 0 will be returned.</p>
<dl class="section note"><dt>Note</dt><dd>The meta data "binary" will be set to mark that the key is binary from now on. When the key is already binary the meta data won't be changed. This will only happen in the successful case, but not when -1 is returned.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the object on which to set the value </td></tr>
    <tr><td class="paramname">newBinary</td><td>is a pointer to any binary data or NULL to free the previous set data </td></tr>
    <tr><td class="paramname">dataSize</td><td>number of bytes to copy from <code>newBinary</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the number of bytes actually copied to internal struct storage </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>when the internal binary was freed and is now a null pointer </td></tr>
    <tr><td class="paramname">-1</td><td>if key is a NULL pointer </td></tr>
    <tr><td class="paramname">-1</td><td>when dataSize is 0 (but newBinary not NULL) or larger than SSIZE_MAX </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keyvalue.html#ga4c0d8a4a11174197699c231e0b5c3c84" title="Get the value of a key as a binary. ">keyGetBinary()</a> </dd>
<dd>
<a class="el" href="group__keytest.html#ga9526b371087564e43e3dff8ad0dac949" title="Check if a key is binary type. ">keyIsBinary()</a> to check if the type is binary </dd>
<dd>
<a class="el" href="group__keyvalue.html#ga41b9fac5ccddafe407fc0ae1e2eb8778" title="Get the value of a key as a string. ">keyGetString()</a> and <a class="el" href="group__keyvalue.html#ga622bde1eb0e0c4994728331326340ef2" title="Set the value for key as newStringValue. ">keySetString()</a> as preferred alternative to binary </dd></dl>

</div>
</div>
<a class="anchor" id="ga622bde1eb0e0c4994728331326340ef2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t keySetString </td>
          <td>(</td>
          <td class="paramtype">Key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>newStringValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the value for <code>key</code> as <code>newStringValue</code>. </p>
<p>The function will allocate and save a private copy of <code>newStringValue</code>, so the parameter can be freed after the call.</p>
<p>String values will be saved in backend storage, when kdbSetKey() will be called, in UTF-8 universal encoding, regardless of the program's current encoding, when iconv plugin is present.</p>
<dl class="section note"><dt>Note</dt><dd>The type will be set to KEY_TYPE_STRING. When the type of the key is already a string type it won't be changed.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the key to set the string value </td></tr>
    <tr><td class="paramname">newStringValue</td><td>NULL-terminated text string to be set as <code>key's</code> value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the number of bytes actually saved in private struct including final NULL </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if newStringValue is a NULL pointer, this will make the string empty (string only containing null termination) </td></tr>
    <tr><td class="paramname">-1</td><td>if key is a NULL pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keyvalue.html#ga41b9fac5ccddafe407fc0ae1e2eb8778" title="Get the value of a key as a string. ">keyGetString()</a>, <a class="el" href="group__keyvalue.html#ga6f29609c5da53c6dc26a98678d5752af" title="Return a pointer to the real internal key value. ">keyValue()</a>, <a class="el" href="group__keyvalue.html#ga880936f2481d28e6e2acbe7486a21d05" title="Get the c-string representing the value. ">keyString()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga880936f2481d28e6e2acbe7486a21d05"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* keyString </td>
          <td>(</td>
          <td class="paramtype">const Key *&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the c-string representing the value. </p>
<p>Will return (null) on null pointers. Will return (binary) on binary data not ended with a null byte.</p>
<p>It is not checked if it is actually a string, only if it terminates for security reasons.</p>
<dl class="section return"><dt>Returns</dt><dd>the c-string of the value </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">(null)</td><td>on null keys </td></tr>
    <tr><td class="paramname">""</td><td>if no data found </td></tr>
    <tr><td class="paramname">(binary)</td><td>on binary keys</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the key object to get the string from </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga6f29609c5da53c6dc26a98678d5752af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const void* keyValue </td>
          <td>(</td>
          <td class="paramtype">const Key *&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a pointer to the real internal <code>key</code> value. </p>
<p>This is a much more efficient version of <a class="el" href="group__keyvalue.html#ga41b9fac5ccddafe407fc0ae1e2eb8778" title="Get the value of a key as a string. ">keyGetString()</a> <a class="el" href="group__keyvalue.html#ga4c0d8a4a11174197699c231e0b5c3c84" title="Get the value of a key as a binary. ">keyGetBinary()</a>, and you should use it if you are responsible enough to not mess up things. You are not allowed to modify anything in the returned string. If you need a copy of the Value, consider to use <a class="el" href="group__keyvalue.html#ga41b9fac5ccddafe407fc0ae1e2eb8778" title="Get the value of a key as a string. ">keyGetString()</a> or <a class="el" href="group__keyvalue.html#ga4c0d8a4a11174197699c231e0b5c3c84" title="Get the value of a key as a binary. ">keyGetBinary()</a> instead.</p>
<h1><a class="anchor" id="string"></a>
String Handling</h1>
<p>If <code>key</code> is string (<a class="el" href="group__keytest.html#gaea7670778abd07fee0fe8ac12a149190" title="Check if a key is string type. ">keyIsString()</a>), you may cast the returned as a <code>"char *"</code> because you'll get a NULL terminated regular string.</p>
<p><a class="el" href="group__keyvalue.html#ga6f29609c5da53c6dc26a98678d5752af" title="Return a pointer to the real internal key value. ">keyValue()</a> returns "" in string mode when there is no value. The reason is </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;key=keyNew(0);</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;keySetString(key,&quot;&quot;);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;keyValue(key); // you would expect &quot;&quot; here</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;keyDel(key);</div>
</div><!-- fragment --><h1><a class="anchor" id="binary"></a>
Binary Data Handling</h1>
<p>If the data is binary, the size of the value must be determined by <a class="el" href="group__keyvalue.html#gae326672fffb7474abfe9baf53b73217e" title="Returns the number of bytes needed to store the key value, including the NULL terminator. ">keyGetValueSize()</a>, any strlen() operations are not suitable to determine the size.</p>
<p><a class="el" href="group__keyvalue.html#ga6f29609c5da53c6dc26a98678d5752af" title="Return a pointer to the real internal key value. ">keyValue()</a> returns 0 in binary mode when there is no value. The reason is </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;key=keyNew(0);</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;keySetBinary(key, 0, 0);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;keyValue(key); // you would expect 0 here</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;keySetBinary(key,&quot;&quot;, 1);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;keyValue(key); // you would expect &quot;&quot; (a pointer to &#39;\0&#39;) here</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;int i=23;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;keySetBinary(key, (void*)&amp;i, 4);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;(int*)keyValue(key); // you would expect a pointer to (int)23 here</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;keyDel(key);</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Note that the Key structure keeps its own size field that is calculated by library internal calls, so to avoid inconsistencies, you must never use the pointer returned by <a class="el" href="group__keyvalue.html#ga6f29609c5da53c6dc26a98678d5752af" title="Return a pointer to the real internal key value. ">keyValue()</a> method to set a new value. Use <a class="el" href="group__keyvalue.html#ga622bde1eb0e0c4994728331326340ef2" title="Set the value for key as newStringValue. ">keySetString()</a> or <a class="el" href="group__keyvalue.html#gaa50a5358fd328d373a45f395fa1b99e7" title="Set the value of a key as a binary. ">keySetBinary()</a> instead.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Binary keys will return a NULL pointer when there is no data in contrast to <a class="el" href="group__keyname.html#ga8e805c726a60da921d3736cda7813513" title="Returns a pointer to the abbreviated real internal key name. ">keyName()</a>, <a class="el" href="group__keyname.html#gaaff35e7ca8af5560c47e662ceb9465f5" title="Returns a pointer to the internal unescaped key name where the basename starts. ">keyBaseName()</a>, <a class="el" href="owner_8c.html#af6485fb8599714b6bbd830cf915ffea5" title="Return a pointer to the real internal key owner. ">keyOwner()</a> and <a class="el" href="group__meta.html#gac89fd319783b3457db45b4c09e55274a" title="Return a pointer to the real internal key comment. ">keyComment()</a>. For string value the behaviour is the same.</dd></dl>
<dl class="section user"><dt>Example:</dt><dd><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;KDB *handle = kdbOpen();</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;KeySet *ks=ksNew(0, KS_END);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Key *current=0;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;kdbGetByName(handle,ks,&quot;system/sw/my&quot;,KDB_O_SORT|KDB_O_RECURSIVE);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;ksRewind(ks);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;while (current=ksNext(ks)) {</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        size_t size=0;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        if (keyIsBin(current)) {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                size=keyGetValueSize(current);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;                printf(&quot;Key %s has a value of size %d bytes. Value: &lt;BINARY&gt;\nComment: %s&quot;,</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                        keyName(current),</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;                        size,</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                        keyComment(current));</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        } else {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                size=elektraStrLen((char *)keyValue(current));</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                printf(&quot;Key %s has a value of size %d bytes. Value: %s\nComment: %s&quot;,</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                        keyName(current),</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                        size,</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                        (char *)keyValue(current),</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                        keyComment(current));</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        }</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;}</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;ksDel (ks);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;kdbClose (handle);</div>
</div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the key object to work with </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to internal value </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">""</td><td>when there is no data and key is not binary </td></tr>
    <tr><td class="paramname">0</td><td>where there is no data and key is binary </td></tr>
    <tr><td class="paramname">0</td><td>on NULL pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keyvalue.html#gae326672fffb7474abfe9baf53b73217e" title="Returns the number of bytes needed to store the key value, including the NULL terminator. ">keyGetValueSize()</a>, <a class="el" href="group__keyvalue.html#ga41b9fac5ccddafe407fc0ae1e2eb8778" title="Get the value of a key as a string. ">keyGetString()</a>, <a class="el" href="group__keyvalue.html#ga4c0d8a4a11174197699c231e0b5c3c84" title="Get the value of a key as a binary. ">keyGetBinary()</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
