<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: Plugin: network</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.9.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Plugin: network </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>infos = Information about network plugin is in keys below</li>
<li>infos/author = Markus Raab <a href="#" onclick="location.href='mai'+'lto:'+'ele'+'kt'+'ra@'+'li'+'bel'+'ek'+'tra'+'.o'+'rg'; return false;">elekt<span style="display: none;">.nosp@m.</span>ra@l<span style="display: none;">.nosp@m.</span>ibele<span style="display: none;">.nosp@m.</span>ktra<span style="display: none;">.nosp@m.</span>.org</a></li>
<li>infos/licence = BSD</li>
<li>infos/provides = check</li>
<li>infos/needs =</li>
<li>infos/placements = presetstorage</li>
<li>infos/status = maintained unittest nodep libc nodoc</li>
<li>infos/metadata = check/ipaddr check/port check/port/listen</li>
<li>infos/description = Checks keys if they contain a valid ip address</li>
</ul>
<h1><a class="anchor" id="src_plugins_network_README_md"></a>
Introduction</h1>
<p>This plugin is a check plugin that checks if a key contains a valid ip address. It uses the <code>POSIX.1-2001</code> interface <code>getaddrinfo()</code> in order to check if an ip address is valid.</p>
<p>Furthermore <code>getaddrinfo()</code> is used in <code>check/port</code> to resolve a port by its service name which is defined under <code>/etc/services</code>. The portname is translated to the respective portnumber. The plugin can be used to check for valid port numbers and if the set port is free to use.</p>
<h1><a class="anchor" id="autotoc_md370"></a>
Purpose</h1>
<p>While, in theory, a regular expression can express if a string is a network address, in practice, such an attempt does not work well. The reason is that an unmanageable number of valid shortenings for IPv6 addresses makes the regular expression hard to write and understand.</p>
<p>So the idea of building such a complicated regular expression was discarded, but instead a dedicated checker was introduced. The idea is to use the operating system facilities to resolve the network address. If this succeeds, it is guaranteed that this network address will be valid when it is resolved by the same interface afterwards.</p>
<p>Many network address translators coexist. In <code>POSIX.1-2001</code> a powerful address translator is provided with the interface <code>getaddrinfo()</code>. It is a common network address translation for both IPv4 and IPv6. We used it to implement this plugin.</p>
<h1><a class="anchor" id="autotoc_md371"></a>
Usage</h1>
<p>Every key tagged with the metakey <code>check/ipaddr</code> will be checked using <code>getaddrinfo()</code>. If additionally the values <code>ipv4</code> or <code>ipv6</code> are supplied, the address family will be specified.</p>
<h2><a class="anchor" id="autotoc_md372"></a>
Example</h2>
<div class="fragment"><div class="line"># Mount Network plugin to `user:/tests/network`</div>
<div class="line">sudo kdb mount config.file user:/tests/network network</div>
<div class="line"> </div>
<div class="line"># Set valid IPv4 address</div>
<div class="line">kdb set user:/tests/network/host 127.0.0.1</div>
<div class="line"># Check for valid IPv4 address</div>
<div class="line">kdb meta-set user:/tests/network/host check/ipaddr ipv4</div>
<div class="line"> </div>
<div class="line"># Try to set invalid IPv4 address</div>
<div class="line">kdb set user:/tests/network/host 133.133.133.1337</div>
<div class="line"># RET: 5</div>
<div class="line"># STDERR:.*Validation Semantic: name:.*133.133.133.1337.*</div>
<div class="line">kdb get user:/tests/network/host</div>
<div class="line">#&gt; 127.0.0.1</div>
<div class="line"> </div>
<div class="line"># Set valid IPv4 address</div>
<div class="line">kdb set user:/tests/network/host 1.2.3.4</div>
<div class="line">#&gt; Set string to &quot;1.2.3.4&quot;</div>
<div class="line">kdb get user:/tests/network/host</div>
<div class="line">#&gt; 1.2.3.4</div>
<div class="line"> </div>
<div class="line"># Check for any valid network address</div>
<div class="line">kdb meta-set user:/tests/network/host check/ipaddr &#39;&#39;</div>
<div class="line"># If identifier `localhost` is not a valid network address it is not part of /etc/hosts</div>
<div class="line">kdb set user:/tests/network/host localhost || ! grep -q localhost /etc/hosts</div>
<div class="line"> </div>
<div class="line">kdb get user:/tests/network/host</div>
<div class="line"># STDOUT-REGEX: localhost|1.2.3.4</div>
<div class="line"> </div>
<div class="line"># Undo modifications to the key database</div>
<div class="line">kdb rm -r user:/tests/network</div>
<div class="line">sudo kdb umount user:/tests/network</div>
</div><!-- fragment --><p>If <code>check/port</code> is specified on a given key, the plugin will validate if the port is a correct number between 1 and 65535.</p>
<p>If <code>check/port/listen</code> is specified, the plugin will check if the application can be started and listen on the given port.</p>
<h1><a class="anchor" id="autotoc_md373"></a>
Future Work</h1>
<p><code>check/port/connect</code> to check if the port can be pinged/reached (usually for clients). If not reachable, users receive a warning. A correct timeout setting will be problematic though. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
