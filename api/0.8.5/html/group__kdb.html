<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Elektra: KDB</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.8.5</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">KDB</div>  </div>
</div><!--header-->
<div class="contents">

<p>General methods to access the Key database.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga98a3d6a4016c9dad9cbd1a99a9c2a45a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__kdb.html#ga98a3d6a4016c9dad9cbd1a99a9c2a45a">option_t</a> { <br/>
&#160;&#160;<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aa00738455e0ae843c8720809d8287f370">KDB_O_NONE</a> =0, 
<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aa66a5380c120f25f28f49848c4a863ead">KDB_O_DEL</a> =1, 
<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aa52fb5f2cc86773d393da62bebebf7984">KDB_O_POP</a> =1&lt;&lt;1, 
<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aa1a70738b2126badb8db7b012c8a1c610">KDB_O_NODIR</a> =1&lt;&lt;2, 
<br/>
&#160;&#160;<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aa131e99d60253d0b887a1e5886f8aa96c">KDB_O_DIRONLY</a> =1&lt;&lt;3, 
<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aa7649f575c2eb0adeaf2c9173ae16e0e6">KDB_O_NOREMOVE</a> =1&lt;&lt;6, 
<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aaf6ed09cee8aa8cf0d6a0e318a7105440">KDB_O_REMOVEONLY</a> =1&lt;&lt;7, 
<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aa789926d8a8e15b029cf7dded4154bcda">KDB_O_INACTIVE</a> =1&lt;&lt;8, 
<br/>
&#160;&#160;<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aaa7d5265eacbb1590982b718f35443e2e">KDB_O_SYNC</a> =1&lt;&lt;9, 
<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aad9d03b36ee88ca5a774cc01b190c99b8">KDB_O_SORT</a> =1&lt;&lt;10, 
<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aa6adaa17b267027ce50e670bf8cc6e824">KDB_O_NORECURSIVE</a> =1&lt;&lt;11, 
<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aaa5586d229e048f816bf7982765442b86">KDB_O_NOCASE</a> =1&lt;&lt;12, 
<br/>
&#160;&#160;<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aab2ff402f5de9aa67b7f786fb715a7a31">KDB_O_WITHOWNER</a> =1&lt;&lt;13, 
<a class="el" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aae8dd1961707e7d0c27228a3f98b0a94d">KDB_O_NOALL</a> =1&lt;&lt;14
<br/>
 }</td></tr>
<tr class="separator:ga98a3d6a4016c9dad9cbd1a99a9c2a45a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga6808defe5870f328dd17910aacbdc6ca"><td class="memItemLeft" align="right" valign="top">KDB *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">kdbOpen</a> (Key *errorKey)</td></tr>
<tr class="memdesc:ga6808defe5870f328dd17910aacbdc6ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens the session with the Key database.  <a href="#ga6808defe5870f328dd17910aacbdc6ca"></a><br/></td></tr>
<tr class="separator:ga6808defe5870f328dd17910aacbdc6ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadb54dc9fda17ee07deb9444df745c96f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (KDB *handle, Key *errorKey)</td></tr>
<tr class="separator:gadb54dc9fda17ee07deb9444df745c96f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga28e385fd9cb7ccfe0b2f1ed2f62453a1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (KDB *handle, KeySet *ks, Key *parentKey)</td></tr>
<tr class="memdesc:ga28e385fd9cb7ccfe0b2f1ed2f62453a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve keys in an atomic and universal way, all other <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet()</a> Functions rely on that one.  <a href="#ga28e385fd9cb7ccfe0b2f1ed2f62453a1"></a><br/></td></tr>
<tr class="separator:ga28e385fd9cb7ccfe0b2f1ed2f62453a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga11436b058408f83d303ca5e996832bcf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet</a> (KDB *handle, KeySet *ks, Key *parentKey)</td></tr>
<tr class="separator:ga11436b058408f83d303ca5e996832bcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>General methods to access the Key database. </p>
<p>To use them: </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;kdb.h&gt;</span></div>
</div><!-- fragment --><p>The kdb*() class of methods are used to access the storage, to get and set <a class="el" href="group__key.html">Keys </a> or <a class="el" href="group__keyset.html">KeySets </a>.</p>
<p>The most important functions are:</p>
<ul>
<li><a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database.">kdbOpen()</a></li>
<li><a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose()</a></li>
<li><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet()</a></li>
<li><a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet()</a></li>
</ul>
<p>The two essential functions for dynamic information about backends are:</p>
<ul>
<li>kdbGetMountpoint()</li>
</ul>
<p>They use some backend implementation to know the details about how to access the storage. Currently we have this backends:</p>
<ul>
<li><code>berkeleydb:</code> the keys are stored in a Berkeley DB database, providing very small footprint, speed, and other advantages.</li>
<li><code>filesys:</code> the key hierarchy and data are saved as plain text files in the filesystem.</li>
<li><code>ini:</code> the key hierarchy are saved into configuration files. <dl class="section see"><dt>See Also</dt><dd><a href="http://www.libelektra.org/Ini">http://www.libelektra.org/Ini</a></dd></dl>
</li>
<li><code>fstab:</code> a reference backend used to interpret the <code>/etc/fstab</code> file as a set of keys under <code>system/filesystems</code> .</li>
<li><code>gconf:</code> makes Elektra use the GConf daemon to access keys. Only the <code>user/</code> tree is available since GConf is not system wide.</li>
</ul>
<p>Backends are physically a library named <code>/lib/libelektra-{NAME}</code>.so.</p>
<p>See <a class="el" href="group__plugin.html">writing a new plugin </a> for information about how to write a plugin.</p>
<p>Language binding writers should follow the same rules:</p>
<ul>
<li>You must relay completely on the backend-dependent methods.</li>
<li>You may use or reimplement the second set of methods.</li>
<li>You should completely reimplement in your language the higher lever methods.</li>
<li>Many methods are just for comfort in C. These methods are marked and need not to be implemented if the binding language has e.g. string operators which can do the operation easily. </li>
</ul>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ga98a3d6a4016c9dad9cbd1a99a9c2a45a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__kdb.html#ga98a3d6a4016c9dad9cbd1a99a9c2a45a">option_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Options to change the default behavior of <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet()</a>, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet()</a> and <a class="el" href="group__keyset.html#gaa34fc43a081e6b01e4120daa6c112004">ksLookup()</a> functions.</p>
<p>These options can be ORed. That is the |-Operator in C.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet()</a>, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet()</a> </dd></dl>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aa00738455e0ae843c8720809d8287f370"></a>KDB_O_NONE</em>&nbsp;</td><td>
<p>No Option set. Will be recursive with no inactive keys.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet()</a>, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet()</a>, <a class="el" href="group__keyset.html#gaa34fc43a081e6b01e4120daa6c112004">ksLookup()</a> </dd></dl>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aa66a5380c120f25f28f49848c4a863ead"></a>KDB_O_DEL</em>&nbsp;</td><td>
<p>Delete parentKey key in <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet()</a>, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet()</a> or <a class="el" href="group__keyset.html#gaa34fc43a081e6b01e4120daa6c112004">ksLookup()</a>.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet()</a>, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet()</a> </dd></dl>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aa52fb5f2cc86773d393da62bebebf7984"></a>KDB_O_POP</em>&nbsp;</td><td>
<p>Pop Parent out of keyset key in <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet()</a>.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__keyset.html#gae42530b04defb772059de0600159cf69">ksPop()</a>. </dd></dl>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aa1a70738b2126badb8db7b012c8a1c610"></a>KDB_O_NODIR</em>&nbsp;</td><td>
<p>Exclude keys containing other keys in result.</p>
<p>Only return leaves.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__keytest.html#gac0a10c602d52a35f81347e8a32312017">keyIsDir()</a> </dd></dl>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aa131e99d60253d0b887a1e5886f8aa96c"></a>KDB_O_DIRONLY</em>&nbsp;</td><td>
<p>Retrieve only directory keys (keys containing other keys). This will give you an skeleton without leaves. This must not be used together with KDB_O_NODIR. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__keytest.html#gac0a10c602d52a35f81347e8a32312017">keyIsDir()</a> </dd></dl>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aa7649f575c2eb0adeaf2c9173ae16e0e6"></a>KDB_O_NOREMOVE</em>&nbsp;</td><td>
<p>Don't remove any keys. This must not be used together with KDB_O_REMOVEONLY. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aaf6ed09cee8aa8cf0d6a0e318a7105440"></a>KDB_O_REMOVEONLY</em>&nbsp;</td><td>
<p>Only remove keys. This must not be used together with KDB_O_NOREMOVE. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aa789926d8a8e15b029cf7dded4154bcda"></a>KDB_O_INACTIVE</em>&nbsp;</td><td>
<p>Do not ignore inactive keys (that name begins with .). </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__keytest.html#gaa25f699f592031c1a0abc1504d14e13e">keyIsInactive()</a> </dd></dl>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aaa7d5265eacbb1590982b718f35443e2e"></a>KDB_O_SYNC</em>&nbsp;</td><td>
<p>Set keys independent of sync status. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__keytest.html#gaf247df0de7aca04b32ef80e39ef12950">keyNeedSync()</a> </dd></dl>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aad9d03b36ee88ca5a774cc01b190c99b8"></a>KDB_O_SORT</em>&nbsp;</td><td>
<p>This option has no effect. KeySets are always sorted. </p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000001">Deprecated:</a></b></dt><dd>dont use </dd></dl>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aa6adaa17b267027ce50e670bf8cc6e824"></a>KDB_O_NORECURSIVE</em>&nbsp;</td><td>
<p>Do not call <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet()</a> for every key containing other keys (<a class="el" href="group__keytest.html#gac0a10c602d52a35f81347e8a32312017">keyIsDir()</a>). </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aaa5586d229e048f816bf7982765442b86"></a>KDB_O_NOCASE</em>&nbsp;</td><td>
<p>Ignore case. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aab2ff402f5de9aa67b7f786fb715a7a31"></a>KDB_O_WITHOWNER</em>&nbsp;</td><td>
<p>Search with owner. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga98a3d6a4016c9dad9cbd1a99a9c2a45aae8dd1961707e7d0c27228a3f98b0a94d"></a>KDB_O_NOALL</em>&nbsp;</td><td>
<p>Only search from start -&gt; cursor to cursor -&gt; end. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gadb54dc9fda17ee07deb9444df745c96f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kdbClose </td>
          <td>(</td>
          <td class="paramtype">KDB *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Key *&#160;</td>
          <td class="paramname"><em>errorKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Closes the session with the Key database.</p>
<p>You should call this method when you finished your affairs with the key database. You can manipulate Key and KeySet objects also after <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose()</a>. You must not use any kdb* call afterwards. You can implement <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose()</a> in the atexit() handler.</p>
<p>This is the counterpart of <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database.">kdbOpen()</a>.</p>
<p>The <code>handle</code> parameter will be finalized and all resources associated to it will be freed. After a <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose()</a>, this <code>handle</code> can't be used anymore, unless it gets initialized again with another call to <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database.">kdbOpen()</a>.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database.">kdbOpen()</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">opened </a> key database </td></tr>
    <tr><td class="paramname">errorKey</td><td>the key which holds error information </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd>
<dd>
-1 on NULL pointer </dd></dl>

</div>
</div>
<a class="anchor" id="ga28e385fd9cb7ccfe0b2f1ed2f62453a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kdbGet </td>
          <td>(</td>
          <td class="paramtype">KDB *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">KeySet *&#160;</td>
          <td class="paramname"><em>ks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Key *&#160;</td>
          <td class="paramname"><em>parentKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve keys in an atomic and universal way, all other <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet()</a> Functions rely on that one. </p>
<p>The <code>returned</code> KeySet must be initialized. The <code>returned</code> KeySet may already contain some keys. The new retrieved keys will be appended using <a class="el" href="group__keyset.html#gaa5a1d467a4d71041edce68ea7748ce45">ksAppendKey()</a>.</p>
<p>It will fully retrieve all keys under the <code>parentKey</code> folder, with all subfolders and their children.</p>
<h1><a class="anchor" id="kdbgetexample"></a>
Example</h1>
<p>This example demonstrates the typical usecase within an application without updating.</p>
<dl class="section user"><dt>Example:</dt><dd><div class="fragment"><div class="line">KeySet *myConfig = <a class="code" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c">ksNew</a>(0);</div>
<div class="line">Key *key = <a class="code" href="group__key.html#gaf6893c038b3ebee90c73a9ea8356bebf">keyNew</a>(<span class="stringliteral">&quot;system/sw/MyApp&quot;</span>,<a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">KDB *handle = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database.">kdbOpen</a>(key);</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet</a>(handle, myConfig, key);</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__keyname.html#ga7699091610e7f3f43d2949514a4b35d9">keySetName</a>(key, <span class="stringliteral">&quot;user/sw/MyApp&quot;</span>);</div>
<div class="line"><a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet</a>(handle, myConfig, key);</div>
<div class="line"></div>
<div class="line"><span class="comment">// check for errors in key</span></div>
<div class="line"><a class="code" href="group__key.html#ga3df95bbc2494e3e6703ece5639be5bb1">keyDel</a>(key);</div>
<div class="line"></div>
<div class="line">key = <a class="code" href="group__keyset.html#gad2e30fb6d4739d917c5abb2ac2f9c1a1">ksLookupByName</a>(myConfig,<span class="stringliteral">&quot;/sw/MyApp/key&quot;</span>, 0);</div>
<div class="line"><span class="comment">// check if key is not 0 and work with it...</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (myConfig); <span class="comment">// delete the in-memory configuration</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">// maybe you want kdbSet() myConfig here</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a>(handle, 0); <span class="comment">// no more affairs with the key database.</span></div>
</div><!-- fragment --></dd></dl>
<h1><a class="anchor" id="kdbgetdetail"></a>
Details</h1>
<p>When no backend could be found (e.g. no backend mounted) the default backend will be used.</p>
<p>If you pass NULL on any parameter <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet()</a> will fail immediately without doing anything.</p>
<p>When a backend fails <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet()</a> will return -1 without any changes to one of the parameter.</p>
<h1><a class="anchor" id="kdbgetupdate"></a>
Updating</h1>
<p>In the first run of kdbGet all keys are retrieved. On subsequent calls only the keys are retrieved where something was changed inside the key database. The other keys stay unchanged in the keyset, even when they were manipulated.</p>
<p>It is your responsibility to save the original keyset if you need it afterwards.</p>
<p>If you must get the same keyset again, e.g. in another thread you need to open a second handle to the key database using <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database.">kdbOpen()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">opened </a> key database </td></tr>
    <tr><td class="paramname">parentKey</td><td>parent key holds the information which keys should be get - invalid name gets all keys </td></tr>
    <tr><td class="paramname">ks</td><td>the (pre-initialized) KeySet returned with all keys found will not be changed on error or if no update is required </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__keyset.html#gad2e30fb6d4739d917c5abb2ac2f9c1a1">ksLookupByName()</a> for powerful lookups after the KeySet was retrieved </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the keys were retrieved successfully </dd>
<dd>
0 if there was no update - no changes are made to the keyset then </dd>
<dd>
-1 on failure - no changes are made to the keyset then </dd></dl>

</div>
</div>
<a class="anchor" id="ga6808defe5870f328dd17910aacbdc6ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">KDB* kdbOpen </td>
          <td>(</td>
          <td class="paramtype">Key *&#160;</td>
          <td class="paramname"><em>errorKey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens the session with the Key database. </p>
<p>The first step is to open the default backend. With it system/elektra/mountpoints will be loaded and all needed libraries and mountpoints will be determined. These libraries for backends will be loaded and with it the <code>KDB</code> datastructure will be initialized.</p>
<p>You must always call this method before retrieving or commiting any keys to the database. In the end of the program, after using the key database, you must not forget to <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose()</a>. You can use the atexit () handler for it.</p>
<p>The pointer to the <code>KDB</code> structure returned will be initialized like described above, and it must be passed along on any kdb*() method your application calls.</p>
<p>Get a <code>KDB</code> handle for every thread using elektra. Don't share the handle across threads, and also not the pointer accessing it: </p>
<div class="fragment"><div class="line">thread1</div>
<div class="line">{</div>
<div class="line">        KDB * h;</div>
<div class="line">        h = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database.">kdbOpen</a>(0);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a>(h, 0);</div>
<div class="line">}</div>
<div class="line">thread2</div>
<div class="line">{</div>
<div class="line">        KDB * h;</div>
<div class="line">        h = <a class="code" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database.">kdbOpen</a>(0);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a>(h, 0);</div>
<div class="line">}</div>
</div><!-- fragment --><p>You don't need to use the <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database.">kdbOpen()</a> if you only want to manipulate plain in-memory Key or KeySet objects without any affairs with the backend key database or when your application loads plugins directly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorKey</td><td>the key which holds errors and warnings which were issued must be given </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose()</a> to end all affairs to the <a class="el" href="group__key.html" title="A Key is the essential class that encapsulates key name , value  and metainfo .">Key</a> database. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>a KDB pointer on success </dd>
<dd>
NULL on failure </dd></dl>

</div>
</div>
<a class="anchor" id="ga11436b058408f83d303ca5e996832bcf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kdbSet </td>
          <td>(</td>
          <td class="paramtype">KDB *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">KeySet *&#160;</td>
          <td class="paramname"><em>ks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Key *&#160;</td>
          <td class="paramname"><em>parentKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set keys in an atomic and universal way.</p>
<p>All other kdbSet Functions rely on that one.</p>
<h1><a class="anchor" id="kdbsetparent"></a>
parentKey</h1>
<p>With parentKey you can only store a part of the given keyset.</p>
<div class="fragment"><div class="line">KeySet *ks = <a class="code" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c">ksNew</a>(0);</div>
<div class="line">Key *parentKey = <a class="code" href="group__key.html#gaf6893c038b3ebee90c73a9ea8356bebf">keyNew</a>(<span class="stringliteral">&quot;user/app/myapp/default&quot;</span>, <a class="code" href="group__key.html#gga91fb3178848bd682000958089abbaf40aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line"><a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve keys in an atomic and universal way, all other kdbGet() Functions rely on that one...">kdbGet</a> (h, ks, parentKey));</div>
<div class="line"></div>
<div class="line"><span class="comment">//now only set everything below user</span></div>
<div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet</a> (h, ks, parentKey) == -1)</div>
<div class="line">{</div>
<div class="line">        <span class="comment">// in parentKey you can check the error cause</span></div>
<div class="line">        <span class="comment">// ksCurrent(ks) is the faulty key</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (ks);</div>
</div><!-- fragment --><p>If you pass a parentKey without a name the whole keyset will be set in an atomic way.</p>
<h1><a class="anchor" id="kdbsetupdate"></a>
Update</h1>
<p>Each key is checked with <a class="el" href="group__keytest.html#gaf247df0de7aca04b32ef80e39ef12950">keyNeedSync()</a> before being actually committed. So only changed keys are updated. If no key of a backend needs to be synced any affairs to backends omitted and 0 is returned.</p>
<h1><a class="anchor" id="kdbseterror"></a>
Error Situations</h1>
<p>If some error occurs, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet()</a> will stop. In this situation the KeySet internal cursor will be set on the key that generated the error.</p>
<p>None of the keys are actually commited.</p>
<p>You should present the error message to the user and let the user decide what to do. Possible solutions are:</p>
<ul>
<li>repeat the same kdbSet (for temporary errors)</li>
<li>remove the key and set it again (for validation or type errors)</li>
<li>change the value and try it again (for validation errors)</li>
<li>do a kdbGet and then (for conflicts ...)<ul>
<li>set the same keyset again (in favour of what was set by this user)</li>
<li>drop the old keyset (in favour of what was set elsewhere)</li>
</ul>
</li>
<li>export the configuration into a file (for unresolvable errors)</li>
</ul>
<dl class="section user"><dt>Example of how this method can be used:</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">int</span> i;</div>
<div class="line">KeySet *ks;  <span class="comment">// the KeySet I want to set</span></div>
<div class="line"><span class="comment">// fill ks with some keys</span></div>
<div class="line"><span class="keywordflow">for</span> (i=0; i&lt; NR_OF_TRIES; i++) <span class="comment">// limit to NR_OF_TRIES tries</span></div>
<div class="line">{</div>
<div class="line">        ret=<a class="code" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet</a>(handle, ks, parentKey);</div>
<div class="line">        <span class="keywordflow">if</span> (ret == -1)</div>
<div class="line">        {</div>
<div class="line">                <span class="comment">// We got an error. Warn user.</span></div>
<div class="line">                Key *problemKey = <a class="code" href="group__keyset.html#ga4287b9416912c5f2ab9c195cb74fb094">ksCurrent</a>(ks);</div>
<div class="line">                <span class="comment">// parentKey has the errorInformation</span></div>
<div class="line">                <span class="comment">// problemKey is the faulty key (may be null)</span></div>
<div class="line">                <span class="keywordtype">int</span> userInput = showElektraErrorDialog (parentKey, problemKey);</div>
<div class="line">                <span class="keywordflow">switch</span> (userInput)</div>
<div class="line">                {</div>
<div class="line">                <span class="keywordflow">case</span> INPUT_REPEAT: <span class="keywordflow">continue</span>;</div>
<div class="line">                <span class="keywordflow">case</span> INPUT_REMOVE: <a class="code" href="group__keyset.html#gaa34fc43a081e6b01e4120daa6c112004">ksLookup</a> (ks, parentKey, <a class="code" href="group__kdb.html#gga98a3d6a4016c9dad9cbd1a99a9c2a45aa52fb5f2cc86773d393da62bebebf7984">KDB_O_POP</a>); <span class="keywordflow">break</span>;</div>
<div class="line">                ...</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment --></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca">opened </a> key database </td></tr>
    <tr><td class="paramname">ks</td><td>a KeySet which should contain changed keys, otherwise nothing is done </td></tr>
    <tr><td class="paramname">parentKey</td><td>holds the information below which key keys should be set, see above </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success </dd>
<dd>
0 if nothing had to be done </dd>
<dd>
-1 on failure </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__keytest.html#gaf247df0de7aca04b32ef80e39ef12950">keyNeedSync()</a>, <a class="el" href="group__keyset.html#ga317321c9065b5a4b3e33fe1c399bcec9">ksNext()</a>, <a class="el" href="group__keyset.html#ga4287b9416912c5f2ab9c195cb74fb094">ksCurrent()</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Mar 3 2014 23:16:09 for Elektra by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
