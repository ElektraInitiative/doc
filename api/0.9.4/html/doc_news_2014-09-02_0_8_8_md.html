<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: 0.8.8 Release</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.9.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">0.8.8 Release </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>guid: eca69e19-5ddb-438c-ac06-57c20b1a9160</li>
<li>author: Markus Raab</li>
<li>pubDate: Tue, 02 Sep 2014 17:31:42 +0200</li>
<li>shortDesc: adds 3-way merging, reworked documentation &amp; improved kdb tool</li>
</ul>
<p>In this release we changed 578 files in 473 commits (68596 insertions(+), 59260 deletions(-) compared to Elektra 0.8.7). We assume thats the largest change set for any of Elektra’s releases up to now. It happened only within a bit more than a month up (0.8.7 was released 28.07.2014).</p>
<p>GSoC finished successfully (thanks Ian and Felix) See <a href="http://community.libelektra.org/wp">http://community.libelektra.org/wp</a> for the latest results. So Elektra now has a 3-way merging framework that is superior to text-based merging in many scenarios (e.g. moving configuration options within a file or with in-line comments) iff a storage plugin creates key names that are not only line numbers. We love to get Feedback!</p>
<p>Writing plugins is now even more comfortable. A plugin writer tutorial was written (thanks Ian): <a href="https://github.com/ElektraInitiative/libelektra/blob/master/doc/tutorials/plugins.md">https://github.com/ElektraInitiative/libelektra/blob/master/doc/tutorials/plugins.md</a> The documentation was completely reworked: <a href="https://doc.libelektra.org/api/0.8.7/html/group__plugin.html">https://doc.libelektra.org/api/0.8.7/html/group__plugin.html</a> And two new macros allow printf formatting for warnings and errors (<code>ELEKTRA_ADD_WARNINGF</code> and <code>ELEKTRA_SET_ERRORF</code>).</p>
<p>The ini plugin was greatly improved (tested with samba configurations and added to ALL plugins) and the hosts plugin was rewritten to support ipv6 properly (thanks to Felix).</p>
<p>The constants plugin was added and allows introspection of Elektra’s cmake variables. Because such non-file based plugins (e.g. also uname) do not need resolving, the plugin noresolver was added. It supersedes the success plugin.</p>
<p>Elektra now allows one to correctly fsync its configuration files (sync plugin) and the folders where files are stored (resolver plugin). Just make sure to add the "sync" plugin using kdb mount. The resolver plugin now reads from passwd and no longer needs environment variables. Additionally, the resolver plugin was prepared to support other variants by so called compilation variants.</p>
<p>The error plugin now allows, next to list all possible errors, to provoke errors when opening plugins. We fixed some issues related to plugins having errors when they initialize themselves.</p>
<p>So following plugins were added: sync noresolver line ini constants Nearly all plugins now have a README.md for further information (thanks to Ian). An overview of all plugin is on with links to them: <a href="https://github.com/ElektraInitiative/libelektra/blob/master/src/plugins/">https://github.com/ElektraInitiative/libelektra/blob/master/src/plugins/</a></p>
<p>The kdb tools were greatly improved (thanks to Felix):</p>
<ul>
<li>added remount tool</li>
<li>umount now also accepts mountpath</li>
<li>mount allows one to specify different resolvers</li>
<li>import now can use merge strategies</li>
<li>check without arguments checks key database</li>
<li>mount is now more verbose when validation fails</li>
</ul>
<p>New/improved scripts/make targets (note that scripts can be executed by kdb scriptname):</p>
<ul>
<li>mounting, unmounting scripts were added</li>
<li>generate template for a new plugin was improved</li>
<li>configure-debian was added</li>
<li>added targets <code>run_all</code> and <code>run_memcheck</code></li>
<li>bash completion file now installed</li>
<li>ucf integration</li>
<li>merging scripts were added for the usage with ucf</li>
<li>scripts doing internal checks on source of plugins</li>
</ul>
<p>This time we had to break compatibility. We did not change the ABI (your application still will be able to use Elektra 0.8.8) and we did not change the API (your application still will compile against Elektra). We changed the third part of our interface: the semantic interface.</p>
<p>The problems were following: keyAddBaseName/keySetBaseName did something obvious when no special characters were in the baseName. But once there were, there are two different interpretations what it should do:</p>
<ol type="1">
<li>add/set a basename, so escape characters that are not canonical in the basename</li>
<li>add all parts of the name given (with slashes)</li>
</ol>
<p>The methods were used in both ways, so it was obvious that something is very wrong. We decided that it should do what the name says, that is add/set a basename (variant 1).</p>
<p>The variant 2, to add any name was added and is called <a class="el" href="group__keyname.html#gaa70593a2c772c4b7bc33423b9b10a270" title="Add an already escaped name to the keyname. ">keyAddName()</a> and added as proposal.</p>
<p>(Thank Felix for implementations and Manuel for investigations)</p>
<p>When keys are renamed after adding to a keyset is a bad thing because it destroys the order of the keyset. This is now avoided by keyLock. Use <a class="el" href="group__key.html#gae6ec6a60cc4b8c1463fa08623d056ce3" title="Return a duplicate of a key. ">keyDup()</a> to get rid of such locks.</p>
<p>Another, even larger, change is also about ordering of keys in keysets. Elektra now internally has an null-terminated unescaped key name. Ordering of keysets will always happen on this name. The <code><a class="el" href="group__keytest.html#gaf6e66e12fe04d535a5d1c8218ced803e" title="Compare the name of two keys. ">keyCmp()</a></code> tool can be used to check this order. It works very efficiently with <code>memcmp()</code> and never gets confused by ASCII ordering of / (because / is 0 in the unescaped key name).</p>
<p>The syntax, semantics and conventions of key names is now documented in detail: <a href="https://doc.libelektra.org/api/0.8.8/html/group__keyname.html">https://doc.libelektra.org/api/0.8.8/html/group__keyname.html</a></p>
<p><a class="el" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c" title="Allocate, initialize and return a new KeySet object. ">ksNew()</a> does now return a keyset with a properly set cursor (ksRewind).</p>
<p>Because its always possible that software relies on bugs the better way to deal with such a situation (as the <a class="el" href="group__keyname.html#ga6e804bd453f98c28b0ff51430d1df407" title="Sets baseName as the new basename for key. ">keySetBaseName()</a> situation described above) is to provide the same function twice. Manuel said he will create a prototype to introduce symbol versioning in Elektra. With that, old customers would still receive the old behaviour, but people compiling against a new version would get the new behaviour. So in one of the next releases we will also avoid semantic interface changes when there is a valid use case for it (there is none if the program e.g. crashes).</p>
<p>Symbol versioning also allows one to compile against old versions on purpose if you do not want the new behaviour.</p>
<p>We have prepared an ABI-test suite, that also checks behaviour, for that purpose, but we also improved testing in other parts:</p>
<ul>
<li>(New Test strategy)[/doc/TESTING.md]</li>
<li>New resolver tests for conflicts (needs tty)</li>
</ul>
<p>If you try to execute test_ks from 0.8.7 with libelektra 0.8.8 it will crash, but not because of any incompatibility, but because of <code>strcmp</code> in the test itself gets a null pointer. The pointer is now null, because ksNew correctly rewinds its internal cursor (see above). Amusingly, it says on that line 94 in test_ks.c: // TODO: why is the cursor here?</p>
<p>see above for more information:</p>
<ul>
<li><code>keyAddName</code> .. add key name without escaping, like keySetName</li>
<li><code>keyUnescapedName</code> .. get access to null-separated unescaped name</li>
<li><code>keyLock</code> .. to allow one to secure keys against modifications</li>
</ul>
<p>some new ideas:</p>
<ul>
<li><code>keySetStringF</code> .. printf format-style changing of the key string</li>
<li><code>elektraKeySetName</code> .. to allow one to set meta + cascading keys</li>
</ul>
<p><code><a class="el" href="array_8c.html#afc46476b8d722d89e07a966e023df317" title="Increment the name of the key by one. ">elektraArrayIncName()</a></code> now works correctly with empty arrays embedded in other arrays (yajl+line plugin)</p>
<p><code><a class="el" href="array_8c.html#ac97baa33fb7b7e83192e156827ba2eb5" title="validate array syntax ">elektraArrayValidateName()</a></code> was also added, thanks to Felix.</p>
<p>These methods are declared in the file <code><a class="el" href="kdbproposal_8h.html" title="Proposed declarations. ">kdbproposal.h</a></code> but do not guarantee any forms of compatibility (they might even be removed).</p>
<p>Many issues were resolved as you can see in github: <a href="https://github.com/ElektraInitiative/libelektra/issues">https://github.com/ElektraInitiative/libelektra/issues</a> Alone for the milestone 0.8.8 we closed 17 issues, including those mentioned in "Compatibility". Other issues (not all were tracked on github):</p>
<ul>
<li>fix undefined errors in <code><a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a></code> or <code><a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database. ">kdbClose()</a></code></li>
<li>Now Python 2+3 work in parallel</li>
<li>python2 interpreter is found correctly (also on Arch)</li>
<li>Sentinel now makes sure that you cannot forget <code>KS_END</code> to end <code>ksNew</code></li>
<li>Fixes for architecture-specific problems by Pino</li>
<li>fix .pc file</li>
<li>fix compilation problem with <code>KDB_MAX_PATH_LENGTH</code></li>
<li>tmpnam to mkstemp (security)</li>
<li>make test data naming consistent (thanks Pino)</li>
<li>use <code>LIB_SUFFIX for TARGET_TOOL_EXEC_FOLDER</code> thanks to Kai Uwe</li>
<li>Fix search for boost (thank Pino)</li>
</ul>
<p>Thanks to Pino Toscano Elektra 0.8.7-4 is now available in Debian Testing: <a href="https://packages.debian.org/search?keywords=elektra">https://packages.debian.org/search?keywords=elektra</a> So it is only a matter of time that other (debian-based) distributions will follow and replace the dusty Elektra 0.7.</p>
<p>Debian Continuous Integration <a href="http://ci.debian.net/packages/e/elektra">http://ci.debian.net/packages/e/elektra</a> (thanks Pino) greatly complement our tests running on <a href="https://build.libelektra.org/">https://build.libelektra.org/</a></p>
<p>Elektra’s buildserver also was improved:</p>
<ul>
<li>now also compiles with icc</li>
<li>runs <code>make run_memcheck</code></li>
<li>checks if plugins are added correctly in-source</li>
<li>runs ABI + behavioral tests</li>
</ul>
<p>Raffael Pancheri now made a merge request for qt-gui <a href="https://github.com/ElektraInitiative/libelektra/pull/103/files">https://github.com/ElektraInitiative/libelektra/pull/103/files</a> in which copy, paste and delete of keys already works. It is, however, still work in progress.</p>
<p>Manuel Mausz made great progress in script-based Elektra plugins. He is also working on glib+gobject-introspection based bindings. He investigated some issues, e.g. a crash of the python binding which was only triggered if python3 is build with a specific flag/module combination, see: <a href="https://github.com/ElektraInitiative/libelektra/issues/25">https://github.com/ElektraInitiative/libelektra/issues/25</a></p>
<p>You can download the release from:</p>
<p><a href="http://www.markus-raab.org/ftp/elektra/releases/elektra-0.8.8.tar.gz">http://www.markus-raab.org/ftp/elektra/releases/elektra-0.8.8.tar.gz</a></p>
<ul>
<li>size: 1644441</li>
<li>md5sum: fe11c6704b0032bdde2d0c8fa5e1c7e3</li>
<li>sha1: 16e43c63cd6d62b9fce82cb0a33288c390e39d12</li>
<li>sha256: ae75873966f4b5b5300ef5e5de5816542af50f35809f602847136a8cb21104e2</li>
</ul>
<p>already built API-Docu can be found here:</p>
<p><a href="https://doc.libelektra.org/api/0.8.8/html/">https://doc.libelektra.org/api/0.8.8/html/</a></p>
<p>Best regards, Markus </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
