<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: Iterators</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.9.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Iterators </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_doc_decisions_iterators"></a> </p>
<h1><a class="anchor" id="autotoc_md1950"></a>
Problem</h1>
<p>The internal iterator inside KeySets seems to cause more problems than it solves.</p>
<h1><a class="anchor" id="autotoc_md1951"></a>
Constraints</h1>
<p>We could embed one such iterator into KeySets, but recommend that people use an external instance (int) in new code.</p>
<h1><a class="anchor" id="autotoc_md1952"></a>
Assumptions</h1>
<p>@raphi011 made benchmarks showing that external and internal iterators have about the same speed. So it should be a safe choice to not provide the internal iterators for 1.0 and only the external instead.</p>
<h1><a class="anchor" id="autotoc_md1953"></a>
Considered Alternatives</h1>
<h1><a class="anchor" id="autotoc_md1954"></a>
Decision</h1>
<ul>
<li>remove all functions related to the internal iterator:<ul>
<li>ksRewind</li>
<li>ksNext</li>
<li>ksCurrent</li>
<li>ksGetCursor</li>
<li>ksSetCursor</li>
<li>ksHead</li>
<li>ksTail</li>
<li>keyRewindMeta</li>
<li>keyNextMeta</li>
<li>keyCurrentMeta</li>
</ul>
</li>
<li>change <code>ksAtCursor</code> to <code>ksAt</code></li>
<li>add implementation / documentation / tests for the external iterator</li>
<li>start using external iterators in new code</li>
<li>remove docu about internal cursor from all functions.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1955"></a>
Rationale</h1>
<ul>
<li>The only function that returns a <code>cursor_t</code> is <code>ksGetCursor</code>. Its documentation is completely broken:</li>
<li><code>ksRewind</code> and <code>keyNextMeta</code> cannot be used on the same variable (<code>ks</code>).</li>
<li>The documentation (not just for the above function, but all over the <code>ks*</code> functions) also contains lots of warnings (use only cursor from same keyset, may be invalid, may become invalid, etc.) that make it seem like there is something special about these cursors, when in fact they are simply indicies. There is no information (at least that I could find), how cursors can be modified. Most of the time it even seems like modifying cursors would be a bad idea.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1956"></a>
Implications</h1>
<h1><a class="anchor" id="autotoc_md1957"></a>
Related Decisions</h1>
<h1><a class="anchor" id="autotoc_md1958"></a>
Notes</h1>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
