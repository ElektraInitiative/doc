<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Elektra: TESTING</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.8.16</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TESTING </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Introduction</h2>
<p>Libraries need a pervasive testing for continuous improvement. Any problem found and behaviour described must be written down as test and integrated so that after running all tests in the build directory: </p><pre class="fragment">make run_all
</pre><p>and on the target (installed) system: </p><pre class="fragment">kdb run_all
</pre><p>assures that all these promises hold.</p>
<p>To run memcheck tests use: </p><pre class="fragment">make run_memcheck
</pre><p>In the build directory, internally ctest is used, so you can also call ctest with its options. On the target (installed) system our own scripts drive the tests.</p>
<h2>Conventions</h2>
<ul>
<li>All names of the test must start with test</li>
<li>No tests should run if ENABLE_TESTING is OFF.</li>
<li>All tests that access harddisc:<ul>
<li>should be tagged with kdbtests</li>
<li>should not shall run, if ENABLE_KDB_TESTING is OFF.</li>
<li>should only write below /tests ans system/mountpoints</li>
</ul>
</li>
<li><p class="startli">If your test has memleaks, e.g. because the library used leaks and that cannot be fixed, give them the label memleak with following command:</p>
<p class="startli">set_property(TEST testname PROPERTY LABELS memleak)</p>
</li>
</ul>
<h2>Strategy</h2>
<p>The testing must happen on every level of the software to achieve a maximum coverage with the available time. In the rest of the document we describe the different levels and where these tests are.</p>
<h3>CFramework</h3>
<p>This is basically a bunch of assertion macros and some output facilities. It is written in pure C and very lightweight.</p>
<p>It is located here.</p>
<h3>ABI Tests</h3>
<p>C ABI Tests are written in plain C with the help of cframework.</p>
<p>The main purpose of these tests are, that the binaries of old versions can be used against new versions as ABI tests.</p>
<p>So lets say we compile Elektra 0.8.8 (at this version dedicated ABI tests were introduced) in the -full variant. But when we run the tests, we use libelektra-full.so.0.8.9 (either by installing it or by setting LD_LIBRARY_PATH). You can check with ldd which version is used.</p>
<p>The tests are located here.</p>
<h3>C Unit Tests</h3>
<p>C Unit Tests are written in plain C with the help of cframework.</p>
<p>It is used to test internal data structures of libelektra that are not ABI relevant.</p>
<p>ABI tests can be done on theses tests, too. But by nature from time to time these tests will fail.</p>
<p>They are located here.</p>
<h3>Module Tests</h3>
<p>The modules, which are typically used as plugins in Elektra (but can also be available statically or in the -full variant), should have their own tests.</p>
<p>Use the Cmake macro add_plugintest for adding these tests.</p>
<h3>C++ Unit Tests</h3>
<p>C++ Unit tests are done using the gtest framework. See <a class="el" href="doc_decisions_unit_testing_md.html">architectural decision</a>.</p>
<p>Use the CMake macro add_gtest for adding these tests.</p>
<h3>Script Tests</h3>
<p>Script test are done using POSIX shell + CMake. See <a class="el" href="doc_decisions_script_testing_md.html">architectural decision</a>.</p>
<p>The script tests have different purposes:</p><ul>
<li>End to End tests (usage of tools as a user would do)</li>
<li>External Compilation tests (compile and run programs as a user would do)</li>
<li>Conventions tests (do internal checks that check for common problems)</li>
<li>Meta Test Suites (run other test suites)</li>
</ul>
<h3>Other kind of Tests</h3>
<p>Bindings, other than C++ typically have their own way of testing.</p>
<h2>Fuzz Testing</h2>
<p>copy some import files to testcase_dir and run:</p>
<p>/usr/src/afl/afl-1.46b/./afl-fuzz -i testcase_dir -o findings_dir bin/kdb import user/tests </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
