<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: Plugin: network</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.9.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Plugin: network </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>infos = Information about network plugin is in keys below</li>
<li>infos/author = Markus Raab <a href="#" onclick="location.href='mai'+'lto:'+'ele'+'kt'+'ra@'+'li'+'bel'+'ek'+'tra'+'.o'+'rg'; return false;">elekt<span style="display: none;">.nosp@m.</span>ra@l<span style="display: none;">.nosp@m.</span>ibele<span style="display: none;">.nosp@m.</span>ktra<span style="display: none;">.nosp@m.</span>.org</a></li>
<li>infos/licence = BSD</li>
<li>infos/provides = check</li>
<li>infos/needs =</li>
<li>infos/placements = presetstorage</li>
<li>infos/status = maintained unittest nodep libc nodoc</li>
<li>infos/metadata = check/ipaddr check/port check/port/listen</li>
<li>infos/description = Checks keys if they contain a valid ip address</li>
</ul>
<p>This plugin is a check plugin that checks if a key contains a valid ip address. It uses the <code>POSIX.1-2001</code> interface <code>getaddrinfo()</code> in order to check if an ip address is valid.</p>
<p>Furthermore <code>getaddrinfo()</code> is used in <code>check/port</code> to resolve a port by its service name which is defined under <code>/etc/services</code>. The portname is translated to the respective portnumber. The plugin can be used to check for valid port numbers and if the set port is free to use.</p>
<p>While, in theory, a regular expression can express if a string is a network address, in practice, such an attempt does not work well. The reason is that an unmanageable number of valid shortenings for IPv6 addresses makes the regular expression hard to write and understand.</p>
<p>So the idea of building such a complicated regular expression was discarded, but instead a dedicated checker was introduced. The idea is to use the operating system facilities to resolve the network address. If this succeeds, it is guaranteed that this network address will be valid when it is resolved by the same interface afterwards.</p>
<p>Many network address translators coexist. In <code>POSIX.1-2001</code> a powerful address translator is provided with the interface <code>getaddrinfo()</code>. It is a common network address translation for both IPv4 and IPv6. We used it to implement this plugin.</p>
<p>Every key tagged with the metakey <code>check/ipaddr</code> will be checked using <code>getaddrinfo()</code>. If additionally the values <code>ipv4</code> or <code>ipv6</code> are supplied, the address family will be specified.</p>
<p>``<code> @section autotoc_md457 Mount Network plugin to</code>user:/tests/network` sudo kdb mount config.file user:/tests/network network</p>
<h1><a class="anchor" id="autotoc_md458"></a>
Set valid IPv4 address</h1>
<p>kdb set user:/tests/network/host 127.0.0.1 </p>
<h1><a class="anchor" id="autotoc_md459"></a>
Check for valid IPv4 address</h1>
<p>kdb meta-set user:/tests/network/host check/ipaddr ipv4</p>
<h1><a class="anchor" id="autotoc_md460"></a>
Try to set invalid IPv4 address</h1>
<p>kdb set user:/tests/network/host 133.133.133.1337 </p>
<h1><a class="anchor" id="autotoc_md461"></a>
RET: 5</h1>
<h1><a class="anchor" id="autotoc_md462"></a>
STDERR:.*Validation Semantic: name:.*133.133.133.1337.*</h1>
<p>kdb get user:/tests/network/host #&gt; 127.0.0.1</p>
<h1><a class="anchor" id="autotoc_md463"></a>
Set valid IPv4 address</h1>
<p>kdb set user:/tests/network/host 1.2.3.4 #&gt; Set string to "1.2.3.4" kdb get user:/tests/network/host #&gt; 1.2.3.4</p>
<h1><a class="anchor" id="autotoc_md464"></a>
Check for any valid network address</h1>
<p>kdb meta-set user:/tests/network/host check/ipaddr '' </p>
<h1><a class="anchor" id="autotoc_md465"></a>
If identifier `localhost` is not a valid network address it is not part of /etc/hosts</h1>
<p>kdb set user:/tests/network/host localhost || ! grep -q localhost /etc/hosts</p>
<p>kdb get user:/tests/network/host </p>
<h1><a class="anchor" id="autotoc_md466"></a>
STDOUT-REGEX: localhost|1.2.3.4</h1>
<h1><a class="anchor" id="autotoc_md467"></a>
Undo modifications to the key database</h1>
<p>kdb rm -r user:/tests/network sudo kdb umount user:/tests/network ```</p>
<p>If <code>check/port</code> is specified on a given key, the plugin will validate if the port is a correct number between 1 and 65535.</p>
<p>If <code>check/port/listen</code> is specified, the plugin will check if the application can be started and listen on the given port.</p>
<h2><a class="anchor" id="autotoc_md468"></a>
Future Work</h2>
<p><code>check/port/connect</code> to check if the port can be pinged/reached (usually for clients). If not reachable, users receive a warning. A correct timeout setting will be problematic though. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
