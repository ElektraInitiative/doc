<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="$langISO">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: Elixir Bindings</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
$darkmode
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<!-- Add mermaid.js -->
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo_color_doxygen.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Elektra<span id="projectnumber">&#160;0.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Elixir Bindings </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_doc_decisions_3_decided_elixir_bindings"></a> </p>
<h1><a class="anchor" id="autotoc_md2026"></a>
Problem</h1>
<p>When creating Elixir bindings one needs a way to use some kind of foreign function interface. In Erlang (which is the basis for Elixir) such a foreign function interface exists in the form of NIFs (native implemented functions). The question is how this NIF interface should be implemented.</p>
<h1><a class="anchor" id="autotoc_md2027"></a>
Constraints</h1>
<ol type="1">
<li>Elektra's C API is given.</li>
<li>The implementation should be completed in a given time frame of around 20 to 40 person-hours.</li>
</ol>
<h1><a class="anchor" id="autotoc_md2028"></a>
Assumptions</h1>
<ol type="1">
<li>The compatibility of the Elixir bindings is not very important.</li>
</ol>
<h1><a class="anchor" id="autotoc_md2029"></a>
Solutions</h1>
<h2><a class="anchor" id="autotoc_md2030"></a>
By hand</h2>
<p>Implement the NIFs by hand. That is, every function of the Elektra C API which one wishes to expose to the Elixir binding has to be explicitly implemented as a NIF. The big disadvantage is, of course, that this process is error-prone. Furthermore, any change in the C API has to be manually carried over to the NIF.</p>
<h2><a class="anchor" id="autotoc_md2031"></a>
Use Nifty code generation tool</h2>
<p>Use the existing code generation tool <a href="http://parapluu.github.io/nifty/">Nifty</a>.</p>
<p>Reasons for not choosing this approach are:</p>
<ul>
<li>Installation process required several patches of Nifty.</li>
<li>Resource management is not that supplied by the Erlang NIF library but a custom one.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2032"></a>
Write own code generation tool</h2>
<p>Write a custom generation tool.</p>
<p>In principle one should be able to take a C header file and convert this to a NIF in an automatic fashion.</p>
<p>Solving this problem in general clearly would be a daunting task. However, when restricting oneself to the use case for creating an interface for, say, Elektra's KDB this might actually have been feasible.</p>
<p>The main difference to Nifty would be that one could adopt the memory management tools provided by the Erlang NIF library directly. Furthermore, it would be possible to write an improved interface for the types, e.g. binary and string.</p>
<p>The main reson for not choosing this approach were time constraints.</p>
<h1><a class="anchor" id="autotoc_md2033"></a>
Decision</h1>
<p>The chosen approach was to use "Alternative A", i.e., to implement the NIFs by hand.</p>
<h1><a class="anchor" id="autotoc_md2034"></a>
Rationale</h1>
<p>The main reason for this choice were time constraints.</p>
<p>Since I have assumed that the compatiblity of the Elixir bindings is not very important, it is acceptable if future changes break these bindings.</p>
<h1><a class="anchor" id="autotoc_md2035"></a>
Implications</h1>
<ul>
<li>Every incompatible change in the C API needs manual changes in the Elixir binding.</li>
</ul>
<h1><a class="anchor" id="autotoc_md2036"></a>
Related Decisions</h1>
<ul>
<li><a href="https://github.com/ElektraInitiative/libelektra/pull/4623">GitHub PR: Elixir Bindings</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md2037"></a>
Notes</h1>
<ul>
<li>If there were a guarantee that the C API does not change, then the chosen approach would be unproblematic. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
<script>
  mermaid.initialize({
    startOnLoad: true,
    theme: 'dark'
  });
</script>
</body>
</html>
