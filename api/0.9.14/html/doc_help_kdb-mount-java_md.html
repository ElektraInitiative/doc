<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="$langISO">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: kdb-mount-java(1) &ndash; Mounting Java Plugins</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
$darkmode
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<!-- Add mermaid.js -->
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo_color_doxygen.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Elektra<span id="projectnumber">&#160;0.9.14</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">kdb-mount-java(1) &ndash; Mounting Java Plugins </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_doc_help_kdb_mount_java"></a> </p>
<h1><a class="anchor" id="autotoc_md2965"></a>
SYNOPSIS</h1>
<p><code>kdb mount-java [&lt;path&gt; &lt;mount point&gt;] [&lt;plugin&gt; [&lt;config&gt;] [..]]</code></p>
<p>All options except <code>&lt;plugin&gt;</code> are passed directly to <code>kdb mount</code>. For details on these options see <a class="el" href="doc_help_kdb-mount_md.html">`kdb-mount(1)`</a>.</p>
<p>The <code>&lt;plugin&gt;</code> arguments are preprocessed before they are passed to <code>kdb mount</code>. If a <code>&lt;plugin&gt;</code> argument starts with <code>java:</code>, it is interpreted as a fully-qualified Java class name. The script replaces these <code>java:*</code> arguments with the appropriate arguments for <code>kdb mount</code> (see below).</p>
<p><code>&lt;plugin&gt;</code> arguments that start with <code>kdb:</code> or have no prefix, are passed to <code>kdb mount</code> as is (after removing the optional <code>kdb:</code> prefix). The <code>kdb:</code> prefix exists to avoid potential name collisions between a Java plugin and C plugin.</p>
<h1><a class="anchor" id="autotoc_md2966"></a>
DESCRIPTION</h1>
<p>This helper command exists, because (unlike a "normal" C plugin) mounting a Java plugin requires multiple arguments. This is because you actually need to mount the <code>process</code> plugin with the correct configuration for a Java plugin.</p>
<p>The following command mounts the C plugins <code>dump</code> and <code>type</code> together with the Java plugin <code>org.libelektra.plugin.WhitelistPlugin</code> with the file <code>config.file</code> at <code>user:/tests/process</code>:</p>
<div class="fragment"><div class="line">sudo kdb mount-java config.file user:/tests/process kdb:dump java:org.libelektra.plugin.WhitelistPlugin type</div>
</div><!-- fragment --><p>This internally expands to (something like) this complicated snippet:</p>
<div class="fragment"><div class="line">KDB_VERSION=&quot;$(kdb --version | sed -nE &#39;s/KDB_VERSION: (.+)/\1/gp&#39;)&quot;</div>
<div class="line">sudo kdb mount config.file user:/tests/process dump process &quot;executable=$(command -v java)&quot; &#39;args=#3&#39; &#39;args/#0=-cp&#39; &quot;args/#1=/usr/share/java/libelektra-$KDB_VERSION-all.jar:/usr/share/java/process-$KDB_VERSION.jar:/usr/share/java/whitelist-$KDB_VERSION.jar&quot; &#39;args/#2=org.libelektra.process.PluginProcess&#39; &#39;args/#3=org.libelektra.plugin.WhitelistPlugin&#39; type</div>
</div><!-- fragment --><p>As you can see, every argument for a Java plugin is replaced by several arguments. Even worse, the arguments depend on how Elektra is installed on your system. The <code>mount-java</code> knows where Elektra's JARs are installed (<code>/usr/share/java</code> above) and constructs a classpath argument for the JVM. It also chooses the <code>PluginProcess</code> class as the main class and finally instructs this class to load the <code>WhitelistPlugin</code>.</p>
<p>However, <code>mount-java</code> isn't magic and it only works this smoothly for plugins that come bundled with Elektra. If you have external plugins, you must also specify the additional classpath for these plugins like this:</p>
<div class="fragment"><div class="line">export CLASSPATH=/path/to/foo.jar:/path/to/bar.jar</div>
<div class="line">sudo --preserve-env=CLASSPATH kdb mount-java config.file user:/tests/foobar java:org.example.Foo java:org.example.Bar java:org.libelektra.plugin.WhitelistPlugin</div>
</div><!-- fragment --><p>Here we added <code>/path/to/foo.jar</code> and <code>/path/to/bar.jar</code> to the classpath, so that the classes <code>org.example.Foo</code> and <code>org.example.Bar</code> can be found. We can still use <code>org.libelektra.plugin.WhitelistPlugin</code>, because Elektra's JARs are always added to the classpath.</p>
<h1><a class="anchor" id="autotoc_md2967"></a>
SEE ALSO</h1>
<ul>
<li><a class="el" href="doc_help_kdb-mount_md.html">kdb-mount(1)</a>. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
<script>
  mermaid.initialize({
    startOnLoad: true,
    theme: 'dark'
  });
</script>
</body>
</html>
