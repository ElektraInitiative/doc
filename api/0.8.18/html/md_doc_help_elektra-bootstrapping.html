<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Elektra: elektra-bootstrapping(7) -- default backend</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.8.18</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">elektra-bootstrapping(7) -- default backend </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>One important aspect of a configuration library is the out-of-the-box experience. How does the system work before anything is configured? The optimal situation is that everything fully works, and applications, that just want to load and store configuration, do not see any difference between out-of-the-box behaviour and a well-configured, fine-tuned system.</p>
<p>To support that experience, a so-called <b>default backend</b> is responsible in the case that nothing was configured so far. It must have a storage that is able to store full Elektra semantics. To avoid reimplementation of storage plugins, for default storage plugins (<code>storage</code> or in code <code>KDB_STORAGE</code>) is used. A resolver plugin (<code>resolver</code> or in code <code>KDB_RESOLVER</code>) takes care of the inevitable portability issues. The <b>default backend</b> stores configuration in <code>KDB_DB_FILE</code>. One can easily avoid the usage of the default backend by simple mounting another backend to <code>/</code>.</p>
<p>The mounting configuration (the configuration how to mount the mountpoints) also needs to be stored somewhere. The so called <b>init backend</b> is responsible for fetching configuration from <code>system/elektra</code>, where the mountpoints are stored. Again <code>KDB_STORAGE</code> and <code>KDB_RESOLVER</code> is used, but now they write into the configuration file <code>KDB_DB_INIT</code> (elektra.ecf by default).</p>
<p>Thus for full and static build variants an exchange at run-time is not possible. Using shared libraries, however, <code>KDB_STORAGE</code> and <code>KDB_RESOLVER</code> are actually symlinks (<code>libelektra-resolver.so</code> and <code>libelektra-storage.so</code>) to concrete plugins and thus can be changed without recompilation.</p>
<p>The <b>init backend</b> is guaranteed to stay mounted at <code>system/elektra</code> where the configuration for Elektra itself is stored. After mounting all backends, Elektra checks if <code>system/elektra</code> still resides at the default backend. If not, the init backend will be mounted there.</p>
<p>To summarise, this approach delivers a good out-of-the-box experience capable of storing configuration. For special use cases, applications and administrators can mount specific backends anywhere except at, and below, <code>system/elektra</code>. On <code><a class="el" href="group__kdb.html#ga6808defe5870f328dd17910aacbdc6ca" title="Opens the session with the Key database. ">kdbOpen()</a></code>, the system bootstraps itself starting with the init backend.</p>
<p>The default backend consists of a default storage plugin and default resolver plugin. The default resolver has no specific requirements, but the default storage plugin must be able to handle full Elektra semantics. The backend is mounted to root (<code>/</code>), so any keys can be stored in it. The implementation of the core guarantees that user and system keys always stay separated.</p>
<h2>TRACEABILITY</h2>
<ul>
<li><a class="el" href="group__kdb.html#ga5bfaad0230457cd6386032fe65c41576" title="Bootstrap, first phase with fallback. ">elektraOpenBootstrap()</a> implements above algorithm</li>
<li><a class="el" href="backend_8c.html#a9ecb7fc73f33af5353756068d90e7862" title="Opens a default backend using the plugin named KDB_RESOLVER and KDB_STORAGE. ">elektraBackendOpenDefault()</a> opens the default backend</li>
<li>/src/include/kdbconfig.h.in contains above KDB_* variables</li>
<li>src/plugins/CMakeLists.txt creates the symlinks</li>
<li>cmake/Modules/LibAddMacros.cmake create_lib_symlink function</li>
</ul>
<h2>SEE ALSO</h2>
<ul>
<li><a class="el" href="doc_decisions_bootstrap_md.html">bootstrap decision</a> </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
