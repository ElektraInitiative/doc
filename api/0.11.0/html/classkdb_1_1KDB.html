<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="$langISO">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: kdb::KDB Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
$darkmode
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<!-- Add mermaid.js -->
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo_color_doxygen.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Elektra<span id="projectnumber">&#160;0.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacekdb.html">kdb</a></li><li class="navelem"><a class="el" href="classkdb_1_1KDB.html">KDB</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classkdb_1_1KDB-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">kdb::KDB Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>.  
 <a href="classkdb_1_1KDB.html#details">More...</a></p>

<p><code>#include &lt;kdb.hpp&gt;</code></p>
<div class="dynheader">
Inheritance diagram for kdb::KDB:</div>
<div class="dyncontent">
<div class="center"><img src="classkdb_1_1KDB__inherit__graph.png" border="0" usemap="#akdb_1_1KDB_inherit__map" alt="Inheritance graph"/></div>
<map name="akdb_1_1KDB_inherit__map" id="akdb_1_1KDB_inherit__map">
<area shape="rect" title="Constructs a class KDB." alt="" coords="38,5,121,32"/>
<area shape="rect" href="classkdb_1_1tools_1_1merging_1_1MergingKDB.html" title="Provides a merging wrapper around a KDB instance." alt="" coords="5,80,153,121"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7e0637995ce9f294cdbc6f167df6db40"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> ()</td></tr>
<tr class="memdesc:a7e0637995ce9f294cdbc6f167df6db40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>.  <a href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">More...</a><br /></td></tr>
<tr class="separator:a7e0637995ce9f294cdbc6f167df6db40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98e25c7fe2f47c5a90461676c6d219e7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a98e25c7fe2f47c5a90461676c6d219e7">KDB</a> (<a class="el" href="classkdb_1_1Key.html">Key</a> &amp;errorKey)</td></tr>
<tr class="memdesc:a98e25c7fe2f47c5a90461676c6d219e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>.  <a href="classkdb_1_1KDB.html#a98e25c7fe2f47c5a90461676c6d219e7">More...</a><br /></td></tr>
<tr class="separator:a98e25c7fe2f47c5a90461676c6d219e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adecb001cb936bd869ef06c7c71fdf0ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#adecb001cb936bd869ef06c7c71fdf0ef">KDB</a> (<a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;contract)</td></tr>
<tr class="memdesc:adecb001cb936bd869ef06c7c71fdf0ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>.  <a href="classkdb_1_1KDB.html#adecb001cb936bd869ef06c7c71fdf0ef">More...</a><br /></td></tr>
<tr class="separator:adecb001cb936bd869ef06c7c71fdf0ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95ef4570ac2d7ddbe2b4c0ad7810c742"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a95ef4570ac2d7ddbe2b4c0ad7810c742">KDB</a> (<a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;contract, <a class="el" href="classkdb_1_1Key.html">Key</a> &amp;errorKey)</td></tr>
<tr class="memdesc:a95ef4570ac2d7ddbe2b4c0ad7810c742"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>.  <a href="classkdb_1_1KDB.html#a95ef4570ac2d7ddbe2b4c0ad7810c742">More...</a><br /></td></tr>
<tr class="separator:a95ef4570ac2d7ddbe2b4c0ad7810c742"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee37484b06164eacc0cc11b7b40ab892"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#aee37484b06164eacc0cc11b7b40ab892">open</a> (<a class="el" href="classkdb_1_1Key.html">Key</a> &amp;errorKey)</td></tr>
<tr class="memdesc:aee37484b06164eacc0cc11b7b40ab892"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open the database.  <a href="classkdb_1_1KDB.html#aee37484b06164eacc0cc11b7b40ab892">More...</a><br /></td></tr>
<tr class="separator:aee37484b06164eacc0cc11b7b40ab892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bd17da51bd531a2726185e7bbf4ecf9"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a8bd17da51bd531a2726185e7bbf4ecf9">open</a> (<a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;contract, <a class="el" href="classkdb_1_1Key.html">Key</a> &amp;errorKey)</td></tr>
<tr class="memdesc:a8bd17da51bd531a2726185e7bbf4ecf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open the database.  <a href="classkdb_1_1KDB.html#a8bd17da51bd531a2726185e7bbf4ecf9">More...</a><br /></td></tr>
<tr class="separator:a8bd17da51bd531a2726185e7bbf4ecf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b3ff4a68c2c935d67dce843bc4ad01b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a1b3ff4a68c2c935d67dce843bc4ad01b">close</a> ()  throw ()</td></tr>
<tr class="memdesc:a1b3ff4a68c2c935d67dce843bc4ad01b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the database.  <a href="classkdb_1_1KDB.html#a1b3ff4a68c2c935d67dce843bc4ad01b">More...</a><br /></td></tr>
<tr class="separator:a1b3ff4a68c2c935d67dce843bc4ad01b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa027a8f798a2cfee11ff712eb204c35d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#aa027a8f798a2cfee11ff712eb204c35d">close</a> (<a class="el" href="classkdb_1_1Key.html">Key</a> &amp;errorKey)  throw ()</td></tr>
<tr class="memdesc:aa027a8f798a2cfee11ff712eb204c35d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the database.  <a href="classkdb_1_1KDB.html#aa027a8f798a2cfee11ff712eb204c35d">More...</a><br /></td></tr>
<tr class="separator:aa027a8f798a2cfee11ff712eb204c35d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0419ffbc273c89756bc523b4223ec25a"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a0419ffbc273c89756bc523b4223ec25a">get</a> (<a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;returned, std::string const &amp;keyname)</td></tr>
<tr class="memdesc:a0419ffbc273c89756bc523b4223ec25a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get all keys below keyname inside returned.  <a href="classkdb_1_1KDB.html#a0419ffbc273c89756bc523b4223ec25a">More...</a><br /></td></tr>
<tr class="separator:a0419ffbc273c89756bc523b4223ec25a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48770a7290699bf2b7529f3ab67e378f"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a48770a7290699bf2b7529f3ab67e378f">get</a> (<a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;returned, <a class="el" href="classkdb_1_1Key.html">Key</a> &amp;parentKey)</td></tr>
<tr class="memdesc:a48770a7290699bf2b7529f3ab67e378f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get all keys below parentKey inside returned.  <a href="classkdb_1_1KDB.html#a48770a7290699bf2b7529f3ab67e378f">More...</a><br /></td></tr>
<tr class="separator:a48770a7290699bf2b7529f3ab67e378f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29087a6a1a7de334f4e5b62ffe5d6e6e"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a29087a6a1a7de334f4e5b62ffe5d6e6e">set</a> (<a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;returned, std::string const &amp;keyname)</td></tr>
<tr class="memdesc:a29087a6a1a7de334f4e5b62ffe5d6e6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set all keys below keyname.  <a href="classkdb_1_1KDB.html#a29087a6a1a7de334f4e5b62ffe5d6e6e">More...</a><br /></td></tr>
<tr class="separator:a29087a6a1a7de334f4e5b62ffe5d6e6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62a4fafbe21d9519b31a7868aa05f3e3"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a62a4fafbe21d9519b31a7868aa05f3e3">set</a> (<a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;returned, <a class="el" href="classkdb_1_1Key.html">Key</a> &amp;parentKey)</td></tr>
<tr class="memdesc:a62a4fafbe21d9519b31a7868aa05f3e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set all keys below parentKey.  <a href="classkdb_1_1KDB.html#a62a4fafbe21d9519b31a7868aa05f3e3">More...</a><br /></td></tr>
<tr class="separator:a62a4fafbe21d9519b31a7868aa05f3e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9473c14d2310006fb90aadfd4a227af"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classkdb_1_1ElektraDiff.html">ElektraDiff</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#ae9473c14d2310006fb90aadfd4a227af">calculateChanges</a> (<a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;changedKeySet, std::string const &amp;parentKeyName)</td></tr>
<tr class="memdesc:ae9473c14d2310006fb90aadfd4a227af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the changes between the provided <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> and the current state of the <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>.  <a href="classkdb_1_1KDB.html#ae9473c14d2310006fb90aadfd4a227af">More...</a><br /></td></tr>
<tr class="separator:ae9473c14d2310006fb90aadfd4a227af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaba81ae9328086987972cbfe47a930bc"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classkdb_1_1ElektraDiff.html">ElektraDiff</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#aaba81ae9328086987972cbfe47a930bc">calculateChanges</a> (<a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;changedKeySet, <a class="el" href="classkdb_1_1Key.html">Key</a> &amp;parentKey)</td></tr>
<tr class="memdesc:aaba81ae9328086987972cbfe47a930bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the changes between the provided <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> and the current state of the <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>.  <a href="classkdb_1_1KDB.html#aaba81ae9328086987972cbfe47a930bc">More...</a><br /></td></tr>
<tr class="separator:aaba81ae9328086987972cbfe47a930bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaa10fdc06db154ae1fa9196870d50b6"><td class="memItemLeft" align="right" valign="top">ckdb::KDB *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#acaa10fdc06db154ae1fa9196870d50b6">getKdb</a> () const</td></tr>
<tr class="memdesc:acaa10fdc06db154ae1fa9196870d50b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Passes out the raw kdb pointer.  <a href="classkdb_1_1KDB.html#acaa10fdc06db154ae1fa9196870d50b6">More...</a><br /></td></tr>
<tr class="separator:acaa10fdc06db154ae1fa9196870d50b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99c219fbfc7687333f16c4d7d660f434"><td class="memItemLeft" align="right" valign="top">ckdb::KDB *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkdb_1_1KDB.html#a99c219fbfc7687333f16c4d7d660f434">operator*</a> () const</td></tr>
<tr class="memdesc:a99c219fbfc7687333f16c4d7d660f434"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is an abbreviation for getKdb.  <a href="classkdb_1_1KDB.html#a99c219fbfc7687333f16c4d7d660f434">More...</a><br /></td></tr>
<tr class="separator:a99c219fbfc7687333f16c4d7d660f434"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if database could not be opened</td></tr>
  </table>
  </dd>
</dl>
<p>Opens the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<p>You must always call this method before retrieving or committing any keys to the database. At the end of a program, after using the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database (<a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>), you must not forget to call <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to free resources.</p>
<p>The method will bootstrap itself in the following way. The first step is to open the default backend. With it <code>system:/elektra/mountpoints</code> will be loaded and all needed libraries and mountpoints will be determined. Then the global plugins and global keyset data from the <code>contract</code> is processed. Finally, the libraries for backends will be loaded and with it the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> data structure will be initialized.</p>
<p>The pointer to the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> structure returned will be initialized like described above, and it must be passed along on any kdb*() method your application calls.</p>
<p>Get a <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> handle for every thread using elektra. Don't share the handle across threads, and also not the pointer accessing it:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> thread1 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part1&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> thread2 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part2&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
<div class="ttc" id="aclasskdb_1_1KDB_html_a7e0637995ce9f294cdbc6f167df6db40"><div class="ttname"><a href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">kdb::KDB::KDB</a></div><div class="ttdeci">KDB()</div><div class="ttdoc">Constructs a class KDB.</div><div class="ttdef"><b>Definition:</b> kdb.hpp:83</div></div>
<div class="ttc" id="agroup__kdb_html_ga844e1299a84c3fbf1d3a905c5c893ba5"><div class="ttname"><a href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a></div><div class="ttdeci">KDB * kdbOpen(const KeySet *contract, Key *errorKey)</div><div class="ttdoc">Opens the session with the Key database.</div><div class="ttdef"><b>Definition:</b> kdb.c:967</div></div>
<div class="ttc" id="agroup__kdb_html_gadb54dc9fda17ee07deb9444df745c96f"><div class="ttname"><a href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a></div><div class="ttdeci">int kdbClose(KDB *handle, Key *errorKey)</div><div class="ttdoc">Closes the session with the Key database.</div><div class="ttdef"><b>Definition:</b> kdb.c:1105</div></div>
<div class="ttc" id="agroup__key_html_gad23c65b44bf48d773759e1f9a4d43b89"><div class="ttname"><a href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a></div><div class="ttdeci">Key * keyNew(const char *name,...)</div><div class="ttdoc">A practical way to fully create a Key object in one step.</div><div class="ttdef"><b>Definition:</b> key.c:144</div></div>
<div class="ttc" id="agroup__key_html_gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403"><div class="ttname"><a href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a></div><div class="ttdeci">@ KEY_END</div><div class="ttdef"><b>Definition:</b> kdbenum.c:95</div></div>
</div><!-- fragment --><p> You don't need <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> if you only want to manipulate plain in-memory <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> or <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> objects.</p>
<dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">contract</td><td>the contract that should be ensured before opening the <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> all data is copied and the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> can safely be used for e.g. <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> later </td></tr>
    <tr><td class="paramname">errorKey</td><td>the key which holds errors and warnings which were issued</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>handle to the newly created <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> on success </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to <a class="el" href="classkdb_1_1KDB.html#a1b3ff4a68c2c935d67dce843bc4ad01b" title="Close the database.">close</a> the session of a <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database opened by <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a></dd></dl>
<p>Access to the key database.</p>
<dl class="section invariant"><dt>Invariant</dt><dd>the object holds a valid connection to the key database or is empty </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a7e0637995ce9f294cdbc6f167df6db40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e0637995ce9f294cdbc6f167df6db40">&#9670;&nbsp;</a></span>KDB() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">kdb::KDB::KDB </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if database could not be opened</td></tr>
  </table>
  </dd>
</dl>
<p>Opens the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<p>You must always call this method before retrieving or committing any keys to the database. At the end of a program, after using the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database (<a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>), you must not forget to call <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to free resources.</p>
<p>The method will bootstrap itself in the following way. The first step is to open the default backend. With it <code>system:/elektra/mountpoints</code> will be loaded and all needed libraries and mountpoints will be determined. Then the global plugins and global keyset data from the <code>contract</code> is processed. Finally, the libraries for backends will be loaded and with it the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> data structure will be initialized.</p>
<p>The pointer to the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> structure returned will be initialized like described above, and it must be passed along on any kdb*() method your application calls.</p>
<p>Get a <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> handle for every thread using elektra. Don't share the handle across threads, and also not the pointer accessing it:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> thread1 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part1&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> thread2 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part2&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
</div><!-- fragment --><p> You don't need <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> if you only want to manipulate plain in-memory <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> or <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> objects.</p>
<dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">contract</td><td>the contract that should be ensured before opening the <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> all data is copied and the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> can safely be used for e.g. <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> later </td></tr>
    <tr><td class="paramname">errorKey</td><td>the key which holds errors and warnings which were issued</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>handle to the newly created <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> on success </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to <a class="el" href="classkdb_1_1KDB.html#a1b3ff4a68c2c935d67dce843bc4ad01b" title="Close the database.">close</a> the session of a <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database opened by <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> </dd></dl>

</div>
</div>
<a id="a98e25c7fe2f47c5a90461676c6d219e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98e25c7fe2f47c5a90461676c6d219e7">&#9670;&nbsp;</a></span>KDB() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">kdb::KDB::KDB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1Key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>errorKey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorKey</td><td>is useful if you want to get the warnings in the successful case, when no exception is thrown.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if database could not be opened</td></tr>
  </table>
  </dd>
</dl>
<p>Opens the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<p>You must always call this method before retrieving or committing any keys to the database. At the end of a program, after using the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database (<a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>), you must not forget to call <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to free resources.</p>
<p>The method will bootstrap itself in the following way. The first step is to open the default backend. With it <code>system:/elektra/mountpoints</code> will be loaded and all needed libraries and mountpoints will be determined. Then the global plugins and global keyset data from the <code>contract</code> is processed. Finally, the libraries for backends will be loaded and with it the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> data structure will be initialized.</p>
<p>The pointer to the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> structure returned will be initialized like described above, and it must be passed along on any kdb*() method your application calls.</p>
<p>Get a <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> handle for every thread using elektra. Don't share the handle across threads, and also not the pointer accessing it:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> thread1 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part1&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> thread2 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part2&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
</div><!-- fragment --><p> You don't need <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> if you only want to manipulate plain in-memory <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> or <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> objects.</p>
<dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">contract</td><td>the contract that should be ensured before opening the <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> all data is copied and the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> can safely be used for e.g. <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> later </td></tr>
    <tr><td class="paramname">errorKey</td><td>the key which holds errors and warnings which were issued</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>handle to the newly created <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> on success </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to <a class="el" href="classkdb_1_1KDB.html#a1b3ff4a68c2c935d67dce843bc4ad01b" title="Close the database.">close</a> the session of a <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database opened by <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> </dd></dl>

</div>
</div>
<a id="adecb001cb936bd869ef06c7c71fdf0ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adecb001cb936bd869ef06c7c71fdf0ef">&#9670;&nbsp;</a></span>KDB() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">kdb::KDB::KDB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;&#160;</td>
          <td class="paramname"><em>contract</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">contract</td><td>the contract that should be ensured </td></tr>
    <tr><td class="paramname">errorKey</td><td>is useful if you want to get the warnings in the successful case, when no exception is thrown.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if database could not be opened</td></tr>
  </table>
  </dd>
</dl>
<p>Opens the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<p>You must always call this method before retrieving or committing any keys to the database. At the end of a program, after using the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database (<a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>), you must not forget to call <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to free resources.</p>
<p>The method will bootstrap itself in the following way. The first step is to open the default backend. With it <code>system:/elektra/mountpoints</code> will be loaded and all needed libraries and mountpoints will be determined. Then the global plugins and global keyset data from the <code>contract</code> is processed. Finally, the libraries for backends will be loaded and with it the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> data structure will be initialized.</p>
<p>The pointer to the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> structure returned will be initialized like described above, and it must be passed along on any kdb*() method your application calls.</p>
<p>Get a <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> handle for every thread using elektra. Don't share the handle across threads, and also not the pointer accessing it:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> thread1 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part1&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> thread2 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part2&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
</div><!-- fragment --><p> You don't need <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> if you only want to manipulate plain in-memory <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> or <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> objects.</p>
<dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">contract</td><td>the contract that should be ensured before opening the <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> all data is copied and the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> can safely be used for e.g. <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> later </td></tr>
    <tr><td class="paramname">errorKey</td><td>the key which holds errors and warnings which were issued</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>handle to the newly created <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> on success </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to <a class="el" href="classkdb_1_1KDB.html#a1b3ff4a68c2c935d67dce843bc4ad01b" title="Close the database.">close</a> the session of a <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database opened by <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> </dd></dl>

</div>
</div>
<a id="a95ef4570ac2d7ddbe2b4c0ad7810c742"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95ef4570ac2d7ddbe2b4c0ad7810c742">&#9670;&nbsp;</a></span>KDB() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">kdb::KDB::KDB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;&#160;</td>
          <td class="paramname"><em>contract</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkdb_1_1Key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>errorKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a class <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">contract</td><td>the contract that should be ensured </td></tr>
    <tr><td class="paramname">errorKey</td><td>is useful if you want to get the warnings in the successful case, when no exception is thrown.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if database could not be opened</td></tr>
  </table>
  </dd>
</dl>
<p>Opens the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<p>You must always call this method before retrieving or committing any keys to the database. At the end of a program, after using the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database (<a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>), you must not forget to call <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to free resources.</p>
<p>The method will bootstrap itself in the following way. The first step is to open the default backend. With it <code>system:/elektra/mountpoints</code> will be loaded and all needed libraries and mountpoints will be determined. Then the global plugins and global keyset data from the <code>contract</code> is processed. Finally, the libraries for backends will be loaded and with it the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> data structure will be initialized.</p>
<p>The pointer to the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> structure returned will be initialized like described above, and it must be passed along on any kdb*() method your application calls.</p>
<p>Get a <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> handle for every thread using elektra. Don't share the handle across threads, and also not the pointer accessing it:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> thread1 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part1&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> thread2 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part2&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
</div><!-- fragment --><p> You don't need <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> if you only want to manipulate plain in-memory <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> or <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> objects.</p>
<dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">contract</td><td>the contract that should be ensured before opening the <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> all data is copied and the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> can safely be used for e.g. <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> later </td></tr>
    <tr><td class="paramname">errorKey</td><td>the key which holds errors and warnings which were issued</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>handle to the newly created <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> on success </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to <a class="el" href="classkdb_1_1KDB.html#a1b3ff4a68c2c935d67dce843bc4ad01b" title="Close the database.">close</a> the session of a <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database opened by <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aaba81ae9328086987972cbfe47a930bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaba81ae9328086987972cbfe47a930bc">&#9670;&nbsp;</a></span>calculateChanges() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkdb_1_1ElektraDiff.html">ElektraDiff</a> kdb::KDB::calculateChanges </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;&#160;</td>
          <td class="paramname"><em>changedKeySet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkdb_1_1Key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>parentKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the changes between the provided <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> and the current state of the <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">changedKeySet</td><td>the keyset that should be used to diff </td></tr>
    <tr><td class="paramname">parentKey</td><td>only changes same or below this keys are calculated</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a diff with all the changes </dd></dl>

</div>
</div>
<a id="ae9473c14d2310006fb90aadfd4a227af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9473c14d2310006fb90aadfd4a227af">&#9670;&nbsp;</a></span>calculateChanges() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkdb_1_1ElektraDiff.html">ElektraDiff</a> kdb::KDB::calculateChanges </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;&#160;</td>
          <td class="paramname"><em>changedKeySet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>parentKeyName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the changes between the provided <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> and the current state of the <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">changedKeySet</td><td>the keyset that should be used to diff </td></tr>
    <tr><td class="paramname">parentKeyName</td><td>only changes same or below this keys are calculated</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a diff with all the changes </dd></dl>

</div>
</div>
<a id="a1b3ff4a68c2c935d67dce843bc4ad01b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b3ff4a68c2c935d67dce843bc4ad01b">&#9670;&nbsp;</a></span>close() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kdb::KDB::close </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
        <tr>
          <td align="right">throw </td><td>(</td><td colspan="2"></td>
        </tr>
        <tr>
          <td align="right"></td><td>)</td><td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Close the database. </p>
<p>The return value does not matter because its only a null pointer check.</p>
<p>Closes the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>The handle must be a valid handle as returned from <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> </dd>
<dd>
errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<p>This is the counterpart of <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a>.</p>
<p>You must call this method when you are finished working with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database. You can manipulate <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> and <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> objects also after <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a>, but you must not use any kdb*() call afterwards.</p>
<p>The <code>handle</code> parameter will be finalized and all resources associated to it will be freed. After a <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a>, the <code>handle</code> cannot be used anymore.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">opened </a> key database </td></tr>
    <tr><td class="paramname">errorKey</td><td>the key which holds error/warning information</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>on NULL pointer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> for opening a session with a <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database </dd></dl>

</div>
</div>
<a id="aa027a8f798a2cfee11ff712eb204c35d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa027a8f798a2cfee11ff712eb204c35d">&#9670;&nbsp;</a></span>close() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kdb::KDB::close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1Key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>errorKey</em></td><td>)</td>
          <td></td>
        </tr>
        <tr>
          <td align="right">throw </td><td>(</td><td colspan="2"></td>
        </tr>
        <tr>
          <td align="right"></td><td>)</td><td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Close the database. </p>
<p>The return value does not matter because its only a null pointer check.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorKey</td><td>is useful if you want to get the warnings</td></tr>
  </table>
  </dd>
</dl>
<p>Closes the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>The handle must be a valid handle as returned from <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> </dd>
<dd>
errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<p>This is the counterpart of <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a>.</p>
<p>You must call this method when you are finished working with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database. You can manipulate <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> and <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> objects also after <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a>, but you must not use any kdb*() call afterwards.</p>
<p>The <code>handle</code> parameter will be finalized and all resources associated to it will be freed. After a <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a>, the <code>handle</code> cannot be used anymore.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">opened </a> key database </td></tr>
    <tr><td class="paramname">errorKey</td><td>the key which holds error/warning information</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>on NULL pointer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> for opening a session with a <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database </dd></dl>

</div>
</div>
<a id="a48770a7290699bf2b7529f3ab67e378f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48770a7290699bf2b7529f3ab67e378f">&#9670;&nbsp;</a></span>get() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int kdb::KDB::get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;&#160;</td>
          <td class="paramname"><em>returned</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkdb_1_1Key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>parentKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get all keys below parentKey inside returned. </p>
<p>Retrieve Keys from the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database in an atomic and universal way. </p><dl class="section pre"><dt>Precondition</dt><dd>The <code>handle</code> must be a valid <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> handle as returned from <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a>. </dd>
<dd>
The <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> <code>returned</code> must be a valid <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a>, i.e., constructed with <a class="el" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c" title="Allocate, initialize and return a new KeySet object.">ksNew()</a>. </dd>
<dd>
The <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> <code>returned</code> must contain keys only from the <code>spec:/</code>, <code>dir:/</code>, <code>user:/</code>, <code>system:/</code>, <code>default:/</code> or <code>proc:/</code> namespaces. </dd>
<dd>
The <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> <code>parentKey</code> must be a valid <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a>, i.e., constructed with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a>. </dd>
<dd>
The <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> <code>parentKey</code> must not have read-only name, value or metadata. </dd>
<dd>
The <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> <code>parentKey</code> must use the <code>spec:/</code>, <code>dir:/</code>, <code>user:/</code>, <code>system:/</code>, <code>default:/</code>, <code>proc:/</code> or cascading namespace.</dd></dl>
<p>If you pass <code>NULL</code> or a key with read-only metadata as <code>parentKey</code>, <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> will fail immediately without doing anything. If you pass another invalid <code>parentKey</code>, or <code>NULL</code> as <code>ks</code> or <code>handle</code>, <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> will set an error on <code>parentKey</code> and then return immediately.</p>
<dl class="section note"><dt>Note</dt><dd>If you pass a non-NULL <code>parentKey</code> with writable metadata, <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> will <b>always</b> remove any existing errors and warnings from <code>parentKey</code>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>If you later call <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> with the same <code>handle</code> you must make sure to pass all keys from <code>ks</code>, which you do not want to remove.</dd></dl>
<dl class="section user"><dt>Loadable Namespaces</dt><dd></dd></dl>
<p>Not all namespace can be loaded.</p>
<ul>
<li><code>spec:/</code>, <code>dir:/</code>, <code>user:/</code> and <code>system:/</code> can be loaded via <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a>.</li>
<li><code>proc:/</code> keys can be loaded via <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a>, but are not persisted or cached.</li>
<li><code>default:/</code> keys can be inserted by <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> but they will always stem from a specification in <code>spec:/</code> keys.</li>
<li>If <code>ks</code> contains a key with any other namespace, an error will be returned.</li>
</ul>
<dl class="section user"><dt>Parent Key</dt><dd></dd></dl>
<p>The <code>parentKey</code> defines which parts of <code>ks</code> will be loaded. Everything that is at or below <code>parentKey</code> wil be loaded together with any key that shares a backend with such a key. Backends are always loaded as an atomic unit.</p>
<dl class="section note"><dt>Note</dt><dd>If <code>parentKey</code> is in the cascading namespace, keys of all loadable namespaces (see above) will be loaded. This is generally the recommended approach.</dd></dl>
<p>Upon sucessfully returning <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> also sets the value of <code>parentKey</code> to the storage identifier used by the backend that contains (or would contain) <code>parentKey</code>. For file-based backends this is the absolute path of the underlying file. Other backends may use different identifiers, but it always uniquely identifies the underlying storage unit.</p>
<dl class="section note"><dt>Note</dt><dd>If <code>parentKey</code> is in the cascading, <code>default:/</code> or `proc:/ namespace, the value of <code>parentKey</code> will be set to an empty string. This is done, because those namespaces are not persistable (see <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a>) and therfore have no storage identifier.</dd></dl>
<dl class="section user"><dt>KeySet Modifications</dt><dd></dd></dl>
<p>Below or at <code>parentKey</code>, the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> <code>ks</code> will mostly contain keys loaded from backends. The only exception are <code>proc:/</code> and <code>spec:/</code> keys that were already present, before <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> was called and do not overlap with an existing backend (for those namespaces). This can be used to provide a hard-coded fallback specifications and/or process-specific data.</p>
<p>Keys not below (or at) <code>parentKey</code> that were present when <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> was called, may still be removed. For example, this could be because they overlap with a backend that also has keys below <code>parentKey</code> (backends are atomic units).</p>
<dl class="section user"><dt>Example:</dt><dd>This example demonstrates the typical usecase within an application (without error handling).</dd></dl>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;kdb.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="testio__doc_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        KeySet * myConfig = <a class="code" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c">ksNew</a> (0, <a class="code" href="group__keyset.html#ga7a28fce3773b2c873c94ac80b8b4cd54">KS_END</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// for error handling see kdbget_error.c</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// clang-format off</span></div>
<div class="line"><span class="comment"></span>Key * key = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/sw/tests/myapp/#0/current/&quot;</span>,  <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line"><a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * handle = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, key);</div>
<div class="line"><a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, myConfig, key);</div>
<div class="line">Key * result = <a class="code" href="group__keyset.html#gad65d2cdcbb5381194a1688e169af8a83">ksLookupByName</a> (myConfig, <span class="stringliteral">&quot;/sw/tests/myapp/#0/current/testkey1&quot;</span>, 0);</div>
<div class="line">        <span class="comment">// clang-format on</span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="group__key.html#ga3df95bbc2494e3e6703ece5639be5bb1">keyDel</a> (key);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> * key_name = <a class="code" href="group__keyname.html#ga8e805c726a60da921d3736cda7813513">keyName</a> (result);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> * key_value = <a class="code" href="group__keyvalue.html#ga880936f2481d28e6e2acbe7486a21d05">keyString</a> (result);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> * key_comment = <a class="code" href="group__keyvalue.html#ga880936f2481d28e6e2acbe7486a21d05">keyString</a> (<a class="code" href="group__keymeta.html#ga9ed3875495ddb3d8a8d29158a60a147c">keyGetMeta</a> (result, <span class="stringliteral">&quot;comment/#0&quot;</span>));</div>
<div class="line">        printf (<span class="stringliteral">&quot;key: %s value: %s comment: %s\n&quot;</span>, key_name, key_value, key_comment);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (myConfig); <span class="comment">// delete the in-memory configuration</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <span class="comment">// maybe you want kdbSet() myConfig here</span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (handle, 0); <span class="comment">// no more affairs with the key database.</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__kdb_html_ga28e385fd9cb7ccfe0b2f1ed2f62453a1"><div class="ttname"><a href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a></div><div class="ttdeci">int kdbGet(KDB *handle, KeySet *ks, Key *parentKey)</div><div class="ttdoc">Retrieve Keys from the Key database in an atomic and universal way.</div><div class="ttdef"><b>Definition:</b> kdb.c:1734</div></div>
<div class="ttc" id="agroup__key_html_ga3df95bbc2494e3e6703ece5639be5bb1"><div class="ttname"><a href="group__key.html#ga3df95bbc2494e3e6703ece5639be5bb1">keyDel</a></div><div class="ttdeci">int keyDel(Key *key)</div><div class="ttdoc">A destructor for Key objects.</div><div class="ttdef"><b>Definition:</b> key.c:459</div></div>
<div class="ttc" id="agroup__keymeta_html_ga9ed3875495ddb3d8a8d29158a60a147c"><div class="ttname"><a href="group__keymeta.html#ga9ed3875495ddb3d8a8d29158a60a147c">keyGetMeta</a></div><div class="ttdeci">const Key * keyGetMeta(const Key *key, const char *metaName)</div><div class="ttdoc">Returns the Key for a metadata entry with name metaName.</div><div class="ttdef"><b>Definition:</b> keymeta.c:379</div></div>
<div class="ttc" id="agroup__keyname_html_ga8e805c726a60da921d3736cda7813513"><div class="ttname"><a href="group__keyname.html#ga8e805c726a60da921d3736cda7813513">keyName</a></div><div class="ttdeci">const char * keyName(const Key *key)</div><div class="ttdoc">Returns a pointer to the abbreviated real internal key name.</div><div class="ttdef"><b>Definition:</b> elektra/keyname.c:429</div></div>
<div class="ttc" id="agroup__keyset_html_ga27e5c16473b02a422238c8d970db7ac8"><div class="ttname"><a href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a></div><div class="ttdeci">int ksDel(KeySet *ks)</div><div class="ttdoc">A destructor for KeySet objects.</div><div class="ttdef"><b>Definition:</b> keyset.c:521</div></div>
<div class="ttc" id="agroup__keyset_html_ga671e1aaee3ae9dc13b4834a4ddbd2c3c"><div class="ttname"><a href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c">ksNew</a></div><div class="ttdeci">KeySet * ksNew(size_t alloc,...)</div><div class="ttdoc">Allocate, initialize and return a new KeySet object.</div><div class="ttdef"><b>Definition:</b> keyset.c:282</div></div>
<div class="ttc" id="agroup__keyset_html_ga7a28fce3773b2c873c94ac80b8b4cd54"><div class="ttname"><a href="group__keyset.html#ga7a28fce3773b2c873c94ac80b8b4cd54">KS_END</a></div><div class="ttdeci">#define KS_END</div><div class="ttdoc">End of a list of keys.</div><div class="ttdef"><b>Definition:</b> kdbenum.c:156</div></div>
<div class="ttc" id="agroup__keyset_html_gad65d2cdcbb5381194a1688e169af8a83"><div class="ttname"><a href="group__keyset.html#gad65d2cdcbb5381194a1688e169af8a83">ksLookupByName</a></div><div class="ttdeci">Key * ksLookupByName(KeySet *ks, const char *name, elektraLookupFlags options)</div><div class="ttdoc">Convenience method to look for a Key contained in ks with name name.</div><div class="ttdef"><b>Definition:</b> keyset.c:2778</div></div>
<div class="ttc" id="agroup__keyvalue_html_ga880936f2481d28e6e2acbe7486a21d05"><div class="ttname"><a href="group__keyvalue.html#ga880936f2481d28e6e2acbe7486a21d05">keyString</a></div><div class="ttdeci">const char * keyString(const Key *key)</div><div class="ttdoc">Get a pointer to the c-string representing the value.</div><div class="ttdef"><b>Definition:</b> keyvalue.c:208</div></div>
<div class="ttc" id="atestio__doc_8c_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="testio__doc_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdoc">[kdbio testsuite main]</div><div class="ttdef"><b>Definition:</b> testio_doc.c:48</div></div>
</div><!-- fragment --><p>When a backend fails <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> will return -1 with all error and warning information in the <code>parentKey</code>. The parameter <code>returned</code> will not be changed.</p>
<dl class="section user"><dt>Optimization:</dt><dd>In the first run of kdbGet all requested (or more) Keys are retrieved. On subsequent calls only the Keys are retrieved where something was changed inside the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database. The other Keys stay in the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> returned as passed.</dd></dl>
<p>It is your responsibility to save the original <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> if you need it afterwards.</p>
<p>If you want to be sure to get a fresh <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> again, you need to open a second handle to the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database using <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">opened </a> key database </td></tr>
    <tr><td class="paramname">parentKey</td><td>Keys below <code>parentKey</code> will be retrieved from <code>handle</code>. It is also used to add warnings and set error information. </td></tr>
    <tr><td class="paramname">ks</td><td>the (pre-initialized) <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> returned with all keys found will not be changed on error or if no update is required</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">2</td><td>if only <code>proc:/</code> backends were executed. This means no data was loaded from storage. There might be warnings attached to the parentKey! Depending on your use case, you might need to treat them as errors! </td></tr>
    <tr><td class="paramname">1</td><td>if the Keys were retrieved successfully. There might be warnings attached to the parentKey! Depending on your use case, you might need to treat them as errors! </td></tr>
    <tr><td class="paramname">0</td><td>if there was no update at all - no changes are made to the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> then. There might be warnings attached to the parentKey! Depending on your use case, you might need to treat them as erorrs! </td></tr>
    <tr><td class="paramname">-1</td><td>on failure - no changes are made to the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> then</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keyset.html#ga60f1ddcf23272f2b29b90e92ebe9b56f" title="Look for a Key contained in ks that matches the name of the key.">ksLookup()</a>, <a class="el" href="group__keyset.html#gad65d2cdcbb5381194a1688e169af8a83" title="Convenience method to look for a Key contained in ks with name name.">ksLookupByName()</a> for powerful lookups after the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> was retrieved </dd>
<dd>
<a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> which needs to be called before </dd>
<dd>
<a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> to save the configuration afterwards </dd>
<dd>
<a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to finish affairs with the <a class="el" href="group__key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">returned</td><td>the keyset where the keys will be in </td></tr>
    <tr><td class="paramname">parentKey</td><td>the parentKey of returned</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if no key was updated </td></tr>
    <tr><td class="paramname">1</td><td>if user or system keys were updated </td></tr>
    <tr><td class="paramname">2</td><td>if user and system keys were updated</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if there were problems with the database </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classkdb_1_1tools_1_1merging_1_1MergingKDB.html#a062b1dac733aa3999691f8d70635b09c">kdb::tools::merging::MergingKDB</a>.</p>

</div>
</div>
<a id="a0419ffbc273c89756bc523b4223ec25a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0419ffbc273c89756bc523b4223ec25a">&#9670;&nbsp;</a></span>get() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int kdb::KDB::get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;&#160;</td>
          <td class="paramname"><em>returned</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>keyname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get all keys below keyname inside returned. </p>
<p>Retrieve Keys from the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database in an atomic and universal way. </p><dl class="section pre"><dt>Precondition</dt><dd>The <code>handle</code> must be a valid <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> handle as returned from <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a>. </dd>
<dd>
The <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> <code>returned</code> must be a valid <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a>, i.e., constructed with <a class="el" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c" title="Allocate, initialize and return a new KeySet object.">ksNew()</a>. </dd>
<dd>
The <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> <code>returned</code> must contain keys only from the <code>spec:/</code>, <code>dir:/</code>, <code>user:/</code>, <code>system:/</code>, <code>default:/</code> or <code>proc:/</code> namespaces. </dd>
<dd>
The <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> <code>parentKey</code> must be a valid <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a>, i.e., constructed with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a>. </dd>
<dd>
The <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> <code>parentKey</code> must not have read-only name, value or metadata. </dd>
<dd>
The <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> <code>parentKey</code> must use the <code>spec:/</code>, <code>dir:/</code>, <code>user:/</code>, <code>system:/</code>, <code>default:/</code>, <code>proc:/</code> or cascading namespace.</dd></dl>
<p>If you pass <code>NULL</code> or a key with read-only metadata as <code>parentKey</code>, <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> will fail immediately without doing anything. If you pass another invalid <code>parentKey</code>, or <code>NULL</code> as <code>ks</code> or <code>handle</code>, <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> will set an error on <code>parentKey</code> and then return immediately.</p>
<dl class="section note"><dt>Note</dt><dd>If you pass a non-NULL <code>parentKey</code> with writable metadata, <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> will <b>always</b> remove any existing errors and warnings from <code>parentKey</code>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>If you later call <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> with the same <code>handle</code> you must make sure to pass all keys from <code>ks</code>, which you do not want to remove.</dd></dl>
<dl class="section user"><dt>Loadable Namespaces</dt><dd></dd></dl>
<p>Not all namespace can be loaded.</p>
<ul>
<li><code>spec:/</code>, <code>dir:/</code>, <code>user:/</code> and <code>system:/</code> can be loaded via <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a>.</li>
<li><code>proc:/</code> keys can be loaded via <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a>, but are not persisted or cached.</li>
<li><code>default:/</code> keys can be inserted by <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> but they will always stem from a specification in <code>spec:/</code> keys.</li>
<li>If <code>ks</code> contains a key with any other namespace, an error will be returned.</li>
</ul>
<dl class="section user"><dt>Parent Key</dt><dd></dd></dl>
<p>The <code>parentKey</code> defines which parts of <code>ks</code> will be loaded. Everything that is at or below <code>parentKey</code> wil be loaded together with any key that shares a backend with such a key. Backends are always loaded as an atomic unit.</p>
<dl class="section note"><dt>Note</dt><dd>If <code>parentKey</code> is in the cascading namespace, keys of all loadable namespaces (see above) will be loaded. This is generally the recommended approach.</dd></dl>
<p>Upon sucessfully returning <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> also sets the value of <code>parentKey</code> to the storage identifier used by the backend that contains (or would contain) <code>parentKey</code>. For file-based backends this is the absolute path of the underlying file. Other backends may use different identifiers, but it always uniquely identifies the underlying storage unit.</p>
<dl class="section note"><dt>Note</dt><dd>If <code>parentKey</code> is in the cascading, <code>default:/</code> or `proc:/ namespace, the value of <code>parentKey</code> will be set to an empty string. This is done, because those namespaces are not persistable (see <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a>) and therfore have no storage identifier.</dd></dl>
<dl class="section user"><dt>KeySet Modifications</dt><dd></dd></dl>
<p>Below or at <code>parentKey</code>, the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> <code>ks</code> will mostly contain keys loaded from backends. The only exception are <code>proc:/</code> and <code>spec:/</code> keys that were already present, before <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> was called and do not overlap with an existing backend (for those namespaces). This can be used to provide a hard-coded fallback specifications and/or process-specific data.</p>
<p>Keys not below (or at) <code>parentKey</code> that were present when <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> was called, may still be removed. For example, this could be because they overlap with a backend that also has keys below <code>parentKey</code> (backends are atomic units).</p>
<dl class="section user"><dt>Example:</dt><dd>This example demonstrates the typical usecase within an application (without error handling).</dd></dl>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;kdb.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="testio__doc_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        KeySet * myConfig = <a class="code" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c">ksNew</a> (0, <a class="code" href="group__keyset.html#ga7a28fce3773b2c873c94ac80b8b4cd54">KS_END</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// for error handling see kdbget_error.c</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// clang-format off</span></div>
<div class="line"><span class="comment"></span>Key * key = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/sw/tests/myapp/#0/current/&quot;</span>,  <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line"><a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * handle = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, key);</div>
<div class="line"><a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, myConfig, key);</div>
<div class="line">Key * result = <a class="code" href="group__keyset.html#gad65d2cdcbb5381194a1688e169af8a83">ksLookupByName</a> (myConfig, <span class="stringliteral">&quot;/sw/tests/myapp/#0/current/testkey1&quot;</span>, 0);</div>
<div class="line">        <span class="comment">// clang-format on</span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="group__key.html#ga3df95bbc2494e3e6703ece5639be5bb1">keyDel</a> (key);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> * key_name = <a class="code" href="group__keyname.html#ga8e805c726a60da921d3736cda7813513">keyName</a> (result);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> * key_value = <a class="code" href="group__keyvalue.html#ga880936f2481d28e6e2acbe7486a21d05">keyString</a> (result);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> * key_comment = <a class="code" href="group__keyvalue.html#ga880936f2481d28e6e2acbe7486a21d05">keyString</a> (<a class="code" href="group__keymeta.html#ga9ed3875495ddb3d8a8d29158a60a147c">keyGetMeta</a> (result, <span class="stringliteral">&quot;comment/#0&quot;</span>));</div>
<div class="line">        printf (<span class="stringliteral">&quot;key: %s value: %s comment: %s\n&quot;</span>, key_name, key_value, key_comment);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (myConfig); <span class="comment">// delete the in-memory configuration</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <span class="comment">// maybe you want kdbSet() myConfig here</span></div>
<div class="line"> </div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (handle, 0); <span class="comment">// no more affairs with the key database.</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>When a backend fails <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> will return -1 with all error and warning information in the <code>parentKey</code>. The parameter <code>returned</code> will not be changed.</p>
<dl class="section user"><dt>Optimization:</dt><dd>In the first run of kdbGet all requested (or more) Keys are retrieved. On subsequent calls only the Keys are retrieved where something was changed inside the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database. The other Keys stay in the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> returned as passed.</dd></dl>
<p>It is your responsibility to save the original <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> if you need it afterwards.</p>
<p>If you want to be sure to get a fresh <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> again, you need to open a second handle to the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database using <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">opened </a> key database </td></tr>
    <tr><td class="paramname">parentKey</td><td>Keys below <code>parentKey</code> will be retrieved from <code>handle</code>. It is also used to add warnings and set error information. </td></tr>
    <tr><td class="paramname">ks</td><td>the (pre-initialized) <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> returned with all keys found will not be changed on error or if no update is required</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">2</td><td>if only <code>proc:/</code> backends were executed. This means no data was loaded from storage. There might be warnings attached to the parentKey! Depending on your use case, you might need to treat them as errors! </td></tr>
    <tr><td class="paramname">1</td><td>if the Keys were retrieved successfully. There might be warnings attached to the parentKey! Depending on your use case, you might need to treat them as errors! </td></tr>
    <tr><td class="paramname">0</td><td>if there was no update at all - no changes are made to the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> then. There might be warnings attached to the parentKey! Depending on your use case, you might need to treat them as erorrs! </td></tr>
    <tr><td class="paramname">-1</td><td>on failure - no changes are made to the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> then</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__keyset.html#ga60f1ddcf23272f2b29b90e92ebe9b56f" title="Look for a Key contained in ks that matches the name of the key.">ksLookup()</a>, <a class="el" href="group__keyset.html#gad65d2cdcbb5381194a1688e169af8a83" title="Convenience method to look for a Key contained in ks with name name.">ksLookupByName()</a> for powerful lookups after the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> was retrieved </dd>
<dd>
<a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> which needs to be called before </dd>
<dd>
<a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> to save the configuration afterwards </dd>
<dd>
<a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to finish affairs with the <a class="el" href="group__key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database.</dd></dl>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="kdb_8hpp.html">kdb.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="keyio_8hpp.html">keyio.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacekdb.html">kdb</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="testio__doc_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> ()</div>
<div class="line">{</div>
<div class="line">        KeySet config;</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> <a class="code" href="namespacekdb.html">kdb</a>;</div>
<div class="line">        <a class="code" href="namespacekdb.html">kdb</a>.get (config, <span class="stringliteral">&quot;/sw/MyApp&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        Key k = config.lookup (<span class="stringliteral">&quot;/sw/MyApp/mykey&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (k)</div>
<div class="line">        {</div>
<div class="line">                std::cout &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; k.get&lt;<span class="keywordtype">int</span>&gt; () &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">                std::cerr &lt;&lt; <span class="stringliteral">&quot;No key found&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="ttc" id="akdb_8hpp_html"><div class="ttname"><a href="kdb_8hpp.html">kdb.hpp</a></div></div>
<div class="ttc" id="akeyio_8hpp_html"><div class="ttname"><a href="keyio_8hpp.html">keyio.hpp</a></div></div>
<div class="ttc" id="anamespacekdb_html"><div class="ttname"><a href="namespacekdb.html">kdb</a></div><div class="ttdoc">This is the main namespace for the C++ binding and libraries.</div><div class="ttdef"><b>Definition:</b> backend.hpp:31</div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">returned</td><td>the keyset where the keys will be in </td></tr>
    <tr><td class="paramname">keyname</td><td>the root keyname which should be used to get keys below it</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if no key was updated </td></tr>
    <tr><td class="paramname">1</td><td>if user or system keys were updated </td></tr>
    <tr><td class="paramname">2</td><td>if user and system keys were updated</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if there were problems with the database</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classkdb_1_1KDB.html#a0419ffbc273c89756bc523b4223ec25a" title="Get all keys below keyname inside returned.">KDB::get</a> (<a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> &amp; returned, <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> &amp; parentKey) </dd></dl>

<p>Reimplemented in <a class="el" href="classkdb_1_1tools_1_1merging_1_1MergingKDB.html#a0d2a28f24aeb6ba3e81af73ef8b98df7">kdb::tools::merging::MergingKDB</a>.</p>

</div>
</div>
<a id="acaa10fdc06db154ae1fa9196870d50b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaa10fdc06db154ae1fa9196870d50b6">&#9670;&nbsp;</a></span>getKdb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ckdb::KDB * kdb::KDB::getKdb </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Passes out the raw kdb pointer. </p>
<p>This pointer can be used to directly interact with the underlying kdb instance</p>
<dl class="section note"><dt>Note</dt><dd>that the ownership remains in the object </dd></dl>

</div>
</div>
<a id="aee37484b06164eacc0cc11b7b40ab892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee37484b06164eacc0cc11b7b40ab892">&#9670;&nbsp;</a></span>open() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kdb::KDB::open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1Key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>errorKey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Open the database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorKey</td><td>is useful if you want to get the warnings in the successful case, when no exception is thrown.</td></tr>
  </table>
  </dd>
</dl>
<p>Opens the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<p>You must always call this method before retrieving or committing any keys to the database. At the end of a program, after using the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database (<a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>), you must not forget to call <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to free resources.</p>
<p>The method will bootstrap itself in the following way. The first step is to open the default backend. With it <code>system:/elektra/mountpoints</code> will be loaded and all needed libraries and mountpoints will be determined. Then the global plugins and global keyset data from the <code>contract</code> is processed. Finally, the libraries for backends will be loaded and with it the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> data structure will be initialized.</p>
<p>The pointer to the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> structure returned will be initialized like described above, and it must be passed along on any kdb*() method your application calls.</p>
<p>Get a <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> handle for every thread using elektra. Don't share the handle across threads, and also not the pointer accessing it:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> thread1 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part1&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> thread2 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part2&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
</div><!-- fragment --><p> You don't need <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> if you only want to manipulate plain in-memory <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> or <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> objects.</p>
<dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">contract</td><td>the contract that should be ensured before opening the <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> all data is copied and the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> can safely be used for e.g. <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> later </td></tr>
    <tr><td class="paramname">errorKey</td><td>the key which holds errors and warnings which were issued</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>handle to the newly created <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> on success </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to <a class="el" href="classkdb_1_1KDB.html#a1b3ff4a68c2c935d67dce843bc4ad01b" title="Close the database.">close</a> the session of a <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database opened by <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> </dd></dl>

</div>
</div>
<a id="a8bd17da51bd531a2726185e7bbf4ecf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bd17da51bd531a2726185e7bbf4ecf9">&#9670;&nbsp;</a></span>open() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kdb::KDB::open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;&#160;</td>
          <td class="paramname"><em>contract</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkdb_1_1Key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>errorKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Open the database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">contract</td><td>the contract that should be ensured </td></tr>
    <tr><td class="paramname">errorKey</td><td>is useful if you want to get the warnings in the successful case, when no exception is thrown.</td></tr>
  </table>
  </dd>
</dl>
<p>Opens the session with the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database. </p><dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<p>You must always call this method before retrieving or committing any keys to the database. At the end of a program, after using the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database (<a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>), you must not forget to call <a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to free resources.</p>
<p>The method will bootstrap itself in the following way. The first step is to open the default backend. With it <code>system:/elektra/mountpoints</code> will be loaded and all needed libraries and mountpoints will be determined. Then the global plugins and global keyset data from the <code>contract</code> is processed. Finally, the libraries for backends will be loaded and with it the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> data structure will be initialized.</p>
<p>The pointer to the <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> structure returned will be initialized like described above, and it must be passed along on any kdb*() method your application calls.</p>
<p>Get a <code><a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a></code> handle for every thread using elektra. Don't share the handle across threads, and also not the pointer accessing it:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> thread1 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part1&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> thread2 (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        Key * parent = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;/app/part2&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line">        <a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * h = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parent);</div>
<div class="line">        <span class="comment">// fetch keys and work with them</span></div>
<div class="line">        <a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (h, parent);</div>
<div class="line">}</div>
</div><!-- fragment --><p> You don't need <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> if you only want to manipulate plain in-memory <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> or <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> objects.</p>
<dl class="section pre"><dt>Precondition</dt><dd>errorKey must be a valid key, e.g. created with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">contract</td><td>the contract that should be ensured before opening the <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> all data is copied and the <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> can safely be used for e.g. <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> later </td></tr>
    <tr><td class="paramname">errorKey</td><td>the key which holds errors and warnings which were issued</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>handle to the newly created <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> on success </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> to <a class="el" href="classkdb_1_1KDB.html#a1b3ff4a68c2c935d67dce843bc4ad01b" title="Close the database.">close</a> the session of a <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database opened by <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> </dd></dl>

</div>
</div>
<a id="a99c219fbfc7687333f16c4d7d660f434"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99c219fbfc7687333f16c4d7d660f434">&#9670;&nbsp;</a></span>operator*()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ckdb::KDB * kdb::KDB::operator* </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is an abbreviation for getKdb. </p>
<p>Passes out the raw kdb pointer. This pointer can be used to directly interact with the underlying kdb instance</p>
<dl class="section note"><dt>Note</dt><dd>that the ownership remains in the object</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classkdb_1_1KDB.html#acaa10fdc06db154ae1fa9196870d50b6" title="Passes out the raw kdb pointer.">getKdb()</a> </dd></dl>

</div>
</div>
<a id="a62a4fafbe21d9519b31a7868aa05f3e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62a4fafbe21d9519b31a7868aa05f3e3">&#9670;&nbsp;</a></span>set() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int kdb::KDB::set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;&#160;</td>
          <td class="paramname"><em>returned</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkdb_1_1Key.html">Key</a> &amp;&#160;</td>
          <td class="paramname"><em>parentKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set all keys below parentKey. </p>
<p>If the keyname of the parentKey is invalid (e.g. empty) all keys will be set.</p>
<p>Set Keys to the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database in an atomic and universal way. </p><dl class="section pre"><dt>Precondition</dt><dd><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> must be called before <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a>:<ul>
<li>initially (after <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a>)</li>
<li>after conflict errors in <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a>. </li>
</ul>
</dd>
<dd>
The <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> <code>ks</code> must be a valid <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a>, i.e., constructed with <a class="el" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c" title="Allocate, initialize and return a new KeySet object.">ksNew()</a>. </dd>
<dd>
The <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> <code>ks</code> must only contain only keys in the <code>spec:/</code>, <code>dir:/</code>, <code>user:/</code>, <code>system:/</code>, <code>default:/</code> or <code>proc:/</code> namespaces. </dd>
<dd>
The <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> <code>parentKey</code> must be a valid <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a>, e.g. constructed with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a>. </dd>
<dd>
The <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> <code>parentKey</code> must not have read-only name, value or metadata. </dd>
<dd>
The <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> <code>parentKey</code> must use the <code>spec:/</code>, <code>dir:/</code>, <code>user:/</code>, <code>system:/</code>, <code>default:/</code>, <code>proc:/</code> or cascading namespace.</dd></dl>
<p>If you pass <code>NULL</code> or a key with read-only metadata as <code>parentKey</code>, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> will fail immediately without doing anything. If you pass another invalid <code>parentKey</code>, or <code>NULL</code> as <code>ks</code> or <code>handle</code>, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> will set an error on <code>parentKey</code> and then return immediately.</p>
<dl class="section note"><dt>Note</dt><dd>If you pass a non-NULL <code>parentKey</code> with writable metadata, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> will <b>always</b> remove any existing errors and warnings from <code>parentKey</code>.</dd></dl>
<dl class="section user"><dt>Persistable Namespaces</dt><dd></dd></dl>
<p>Not all namespace can be persisted.</p>
<ul>
<li><code>spec:/</code>, <code>dir:/</code>, <code>user:/</code> and <code>system:/</code> will be persisted by <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a>.</li>
<li><code>default:/</code> and <code>proc:/</code> keys are ignored by <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a>.</li>
<li>If <code>ks</code> contains a key with any other namespace, an error will be returned.</li>
</ul>
<p>In general it is recommended to use a <code>parentKey</code> in the cascading namespace to cover all namespaces at once.</p>
<dl class="section user"><dt>Parent Key</dt><dd></dd></dl>
<p>The <code>parentKey</code> defines which parts of <code>ks</code> will be stored. Everything that is at or below <code>parentKey</code> will be persisted together with any key that shares a backend with such a key. Backends are always stored as an atomic unit.</p>
<dl class="section note"><dt>Note</dt><dd>If <code>parentKey</code> is in the cascading namespace, keys of all persistable namespaces (see above) will be stored. This is generally the recommended approach.</dd></dl>
<dl class="section user"><dt>KeySet modifications</dt><dd></dd></dl>
<p>The contents of <code>ks</code> will mostly not be modified by <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a>. The only modifications made are those caused by applying the specification in <code>spec:/</code> to <code>dir:/</code>, <code>user:/</code> and <code>system:/</code>.</p>
<dl class="section user"><dt>Errors</dt><dd>If <code>parentKey == NULL</code> or <code>parentKey</code> has read-only metadata, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> will immediately return the error code -1. In all other error cases the following happens:<ul>
<li>Error information will be written into the metadata of the parent key, if possible.</li>
<li>None of the keys are actually committed in this situation, i.e. no configuration file will be modified.</li>
</ul>
</dd></dl>
<p>In case of errors you should present the error message to the user and let the user decide what to do. Possible solutions are:</p><ul>
<li>remove the problematic key and use <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> again (for validation or type errors)</li>
<li>change the value of the problematic key and use <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> again (for validation errors)</li>
<li>do a <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> (for conflicts, i.e. error C02000) and then<ul>
<li>set the same keyset again (in favour of what was set by this user)</li>
<li>drop the old keyset (in favour of what was set from another application)</li>
<li>merge the original, your own and the other keyset</li>
</ul>
</li>
<li>export the configuration into a file (for unresolvable errors)</li>
<li>repeating the same <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> might be of limited use, if the user does not explicitly request it, because temporary errors are rare and its unlikely that they fix themselves (e.g. disc full, permission problems)</li>
</ul>
<dl class="section user"><dt>Optimization</dt><dd>Only backends that<ul>
<li>contain at least one changed key according to elektraDiffCalculate(),</li>
<li>contain fewer keys than at the end of <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> will be called. There won't be an unnecessary write for unchanged keys.</li>
</ul>
</dd></dl>
<p>If none of the backends needs an update, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> returns 0 and does nothing.</p>
<div class="fragment"><div class="line">KeySet * myConfig = <a class="code" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c">ksNew</a> (0, <a class="code" href="group__keyset.html#ga7a28fce3773b2c873c94ac80b8b4cd54">KS_END</a>);</div>
<div class="line">Key * parentKey = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;system:/sw/MyApp&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line"><a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * handle = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parentKey);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, myConfig, parentKey); <span class="comment">// kdbGet needs to be called first!</span></div>
<div class="line">KeySet * base = <a class="code" href="group__keyset.html#gac59e4b328245463f1451f68d5106151c">ksDup</a> (myConfig);     <span class="comment">// save a copy of original keyset</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// change the keys within myConfig</span></div>
<div class="line"><a class="code" href="group__keyset.html#gaa5a1d467a4d71041edce68ea7748ce45">ksAppendKey</a> (myConfig, <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;system:/sw/MyApp/Test&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8ac66e4a49d09212b79f5754ca6db5bd2e">KEY_VALUE</a>, <span class="stringliteral">&quot;5&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>));</div>
<div class="line"> </div>
<div class="line">KeySet * ours = <a class="code" href="group__keyset.html#gac59e4b328245463f1451f68d5106151c">ksDup</a> (myConfig); <span class="comment">// save a copy of our keyset</span></div>
<div class="line">KeySet * theirs;                  <span class="comment">// needed for 3-way merging</span></div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet</a> (handle, myConfig, parentKey);</div>
<div class="line"><span class="keywordflow">while</span> (ret == -1) <span class="comment">// as long as we have an error</span></div>
<div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> strategy = showElektraErrorDialog (parentKey);</div>
<div class="line">        theirs = <a class="code" href="group__keyset.html#gac59e4b328245463f1451f68d5106151c">ksDup</a> (ours);</div>
<div class="line">        <a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, theirs, parentKey); <span class="comment">// refresh key database</span></div>
<div class="line">        KeySet * result = <a class="code" href="kdbmerge_8h.html#a2cc0dc19c99b2bc86feb1f2607df343a">elektraMerge</a>(</div>
<div class="line">                <a class="code" href="group__keyset.html#ga6b00cf82b59af4d883a9bad6cf4a4a4a">ksCut</a>(ours, parentKey), parentKey,</div>
<div class="line">                <a class="code" href="group__keyset.html#ga6b00cf82b59af4d883a9bad6cf4a4a4a">ksCut</a>(theirs, parentKey), parentKey,</div>
<div class="line">                <a class="code" href="group__keyset.html#ga6b00cf82b59af4d883a9bad6cf4a4a4a">ksCut</a>(base, parentKey), parentKey,</div>
<div class="line">                parentKey, strategy, parentKey);</div>
<div class="line">        <span class="keywordtype">int</span> numberOfConflicts = <a class="code" href="kdbmerge_8h.html#aa4b4c9a6f50a1f5d602fc84c8abce208">elektraMergeGetConflicts</a> (parentKey);</div>
<div class="line">        <a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (theirs);</div>
<div class="line">        <span class="keywordflow">if</span> (result != NULL) {</div>
<div class="line">                ret = <a class="code" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet</a> (handle, result, parentKey);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="comment">// an error happened while merging</span></div>
<div class="line">                <span class="keywordflow">if</span> (numberOfConflicts &gt; 0 &amp;&amp; strategy == <a class="code" href="kdbmerge_8h.html#a2c76c3f8b54a741ba9fdbfe6b5e0ee5caeaf7be70515ee5bc9b6dae1c844ec492">MERGE_STRATEGY_ABORT</a>)</div>
<div class="line">                {</div>
<div class="line">                        <span class="comment">// Error due to merge conflicts</span></div>
<div class="line">                        ret = -1;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                        <span class="comment">// Internal errors, out of memory etc.</span></div>
<div class="line">                        ret = -1;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (ours);</div>
<div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (base);</div>
<div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (myConfig); <span class="comment">// delete the in-memory configuration</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (handle, parentKey); <span class="comment">// no more affairs with the key database.</span></div>
<div class="line"><a class="code" href="group__key.html#ga3df95bbc2494e3e6703ece5639be5bb1">keyDel</a> (parentKey);</div>
<div class="ttc" id="agroup__kdb_html_ga11436b058408f83d303ca5e996832bcf"><div class="ttname"><a href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet</a></div><div class="ttdeci">int kdbSet(KDB *handle, KeySet *ks, Key *parentKey)</div><div class="ttdoc">Set Keys to the Key database in an atomic and universal way.</div><div class="ttdef"><b>Definition:</b> kdb.c:2343</div></div>
<div class="ttc" id="agroup__key_html_gga9b703ca49f48b482def322b77d3e6bc8ac66e4a49d09212b79f5754ca6db5bd2e"><div class="ttname"><a href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8ac66e4a49d09212b79f5754ca6db5bd2e">KEY_VALUE</a></div><div class="ttdeci">@ KEY_VALUE</div><div class="ttdef"><b>Definition:</b> kdbenum.c:88</div></div>
<div class="ttc" id="agroup__keyset_html_ga6b00cf82b59af4d883a9bad6cf4a4a4a"><div class="ttname"><a href="group__keyset.html#ga6b00cf82b59af4d883a9bad6cf4a4a4a">ksCut</a></div><div class="ttdeci">KeySet * ksCut(KeySet *ks, const Key *cutpoint)</div><div class="ttdoc">Cuts out all Keys from KeySet ks that are below or at cutpoint.</div><div class="ttdef"><b>Definition:</b> keyset.c:1608</div></div>
<div class="ttc" id="agroup__keyset_html_gaa5a1d467a4d71041edce68ea7748ce45"><div class="ttname"><a href="group__keyset.html#gaa5a1d467a4d71041edce68ea7748ce45">ksAppendKey</a></div><div class="ttdeci">ssize_t ksAppendKey(KeySet *ks, Key *toAppend)</div><div class="ttdoc">Appends a Key to the end of ks.</div><div class="ttdef"><b>Definition:</b> keyset.c:968</div></div>
<div class="ttc" id="agroup__keyset_html_gac59e4b328245463f1451f68d5106151c"><div class="ttname"><a href="group__keyset.html#gac59e4b328245463f1451f68d5106151c">ksDup</a></div><div class="ttdeci">KeySet * ksDup(const KeySet *source)</div><div class="ttdoc">Return a duplicate of a KeySet.</div><div class="ttdef"><b>Definition:</b> keyset.c:371</div></div>
<div class="ttc" id="akdbmerge_8h_html_a2c76c3f8b54a741ba9fdbfe6b5e0ee5caeaf7be70515ee5bc9b6dae1c844ec492"><div class="ttname"><a href="kdbmerge_8h.html#a2c76c3f8b54a741ba9fdbfe6b5e0ee5caeaf7be70515ee5bc9b6dae1c844ec492">MERGE_STRATEGY_ABORT</a></div><div class="ttdeci">@ MERGE_STRATEGY_ABORT</div><div class="ttdef"><b>Definition:</b> kdbmerge.h:26</div></div>
<div class="ttc" id="akdbmerge_8h_html_a2cc0dc19c99b2bc86feb1f2607df343a"><div class="ttname"><a href="kdbmerge_8h.html#a2cc0dc19c99b2bc86feb1f2607df343a">elektraMerge</a></div><div class="ttdeci">KeySet * elektraMerge(KeySet *our, Key *ourRoot, KeySet *their, Key *theirRoot, KeySet *base, Key *baseRoot, Key *resultKey, enum MergeStrategy strategy, Key *informationKey)</div><div class="ttdoc">This function can incorporate changes from two modified versions (our and their) into a common preced...</div><div class="ttdef"><b>Definition:</b> kdbmerge.c:1192</div></div>
<div class="ttc" id="akdbmerge_8h_html_aa4b4c9a6f50a1f5d602fc84c8abce208"><div class="ttname"><a href="kdbmerge_8h.html#aa4b4c9a6f50a1f5d602fc84c8abce208">elektraMergeGetConflicts</a></div><div class="ttdeci">int elektraMergeGetConflicts(Key *informationKey)</div><div class="ttdoc">This function returns the number of conflicts that is store in the key.</div><div class="ttdef"><b>Definition:</b> kdbmerge.c:357</div></div>
</div><!-- fragment --><p> showElektraErrorDialog() and doElektraMerge() need to be implemented by the user of Elektra. For doElektraMerge a 3-way merge algorithm exists in libelektra-tools.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">opened </a> key database </td></tr>
    <tr><td class="paramname">ks</td><td>a <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> which should contain changed keys, otherwise nothing is done </td></tr>
    <tr><td class="paramname">parentKey</td><td>Keys below <code>parentKey</code> will be set to <code>handle</code>. It is also used to add warnings and set error information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>on success </td></tr>
    <tr><td class="paramname">0</td><td>if nothing had to be done, no changes in <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> </td></tr>
    <tr><td class="paramname">-1</td><td>on failure, no changes in <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>, an error will be set on <code>parentKey</code> if possible (see "Errors" above)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> for getting <code>handle</code> </dd>
<dd>
<a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> that must be called afterwards </dd>
<dd>
<a class="el" href="group__keyset.html#ga4287b9416912c5f2ab9c195cb74fb094" title="Return the current Key.">ksCurrent()</a> contains the error <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a></dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if no key was updated </td></tr>
    <tr><td class="paramname">1</td><td>if user or system keys were updated </td></tr>
    <tr><td class="paramname">2</td><td>if user and system keys were updated</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">returned</td><td>the keyset where the keys are passed to the user </td></tr>
    <tr><td class="paramname">parentKey</td><td>the parentKey of returned</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if there were problems with the database </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a29087a6a1a7de334f4e5b62ffe5d6e6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29087a6a1a7de334f4e5b62ffe5d6e6e">&#9670;&nbsp;</a></span>set() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int kdb::KDB::set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkdb_1_1KeySet.html">KeySet</a> &amp;&#160;</td>
          <td class="paramname"><em>returned</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>keyname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set all keys below keyname. </p>
<p>If the keyname of the parentKey is invalid (e.g. empty) all keys will be set.</p>
<p>Set Keys to the <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> database in an atomic and universal way. </p><dl class="section pre"><dt>Precondition</dt><dd><a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> must be called before <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a>:<ul>
<li>initially (after <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a>)</li>
<li>after conflict errors in <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a>. </li>
</ul>
</dd>
<dd>
The <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> <code>ks</code> must be a valid <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a>, i.e., constructed with <a class="el" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c" title="Allocate, initialize and return a new KeySet object.">ksNew()</a>. </dd>
<dd>
The <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> <code>ks</code> must only contain only keys in the <code>spec:/</code>, <code>dir:/</code>, <code>user:/</code>, <code>system:/</code>, <code>default:/</code> or <code>proc:/</code> namespaces. </dd>
<dd>
The <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> <code>parentKey</code> must be a valid <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a>, e.g. constructed with <a class="el" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89" title="A practical way to fully create a Key object in one step.">keyNew()</a>. </dd>
<dd>
The <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> <code>parentKey</code> must not have read-only name, value or metadata. </dd>
<dd>
The <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a> <code>parentKey</code> must use the <code>spec:/</code>, <code>dir:/</code>, <code>user:/</code>, <code>system:/</code>, <code>default:/</code>, <code>proc:/</code> or cascading namespace.</dd></dl>
<p>If you pass <code>NULL</code> or a key with read-only metadata as <code>parentKey</code>, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> will fail immediately without doing anything. If you pass another invalid <code>parentKey</code>, or <code>NULL</code> as <code>ks</code> or <code>handle</code>, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> will set an error on <code>parentKey</code> and then return immediately.</p>
<dl class="section note"><dt>Note</dt><dd>If you pass a non-NULL <code>parentKey</code> with writable metadata, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> will <b>always</b> remove any existing errors and warnings from <code>parentKey</code>.</dd></dl>
<dl class="section user"><dt>Persistable Namespaces</dt><dd></dd></dl>
<p>Not all namespace can be persisted.</p>
<ul>
<li><code>spec:/</code>, <code>dir:/</code>, <code>user:/</code> and <code>system:/</code> will be persisted by <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a>.</li>
<li><code>default:/</code> and <code>proc:/</code> keys are ignored by <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a>.</li>
<li>If <code>ks</code> contains a key with any other namespace, an error will be returned.</li>
</ul>
<p>In general it is recommended to use a <code>parentKey</code> in the cascading namespace to cover all namespaces at once.</p>
<dl class="section user"><dt>Parent Key</dt><dd></dd></dl>
<p>The <code>parentKey</code> defines which parts of <code>ks</code> will be stored. Everything that is at or below <code>parentKey</code> will be persisted together with any key that shares a backend with such a key. Backends are always stored as an atomic unit.</p>
<dl class="section note"><dt>Note</dt><dd>If <code>parentKey</code> is in the cascading namespace, keys of all persistable namespaces (see above) will be stored. This is generally the recommended approach.</dd></dl>
<dl class="section user"><dt>KeySet modifications</dt><dd></dd></dl>
<p>The contents of <code>ks</code> will mostly not be modified by <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a>. The only modifications made are those caused by applying the specification in <code>spec:/</code> to <code>dir:/</code>, <code>user:/</code> and <code>system:/</code>.</p>
<dl class="section user"><dt>Errors</dt><dd>If <code>parentKey == NULL</code> or <code>parentKey</code> has read-only metadata, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> will immediately return the error code -1. In all other error cases the following happens:<ul>
<li>Error information will be written into the metadata of the parent key, if possible.</li>
<li>None of the keys are actually committed in this situation, i.e. no configuration file will be modified.</li>
</ul>
</dd></dl>
<p>In case of errors you should present the error message to the user and let the user decide what to do. Possible solutions are:</p><ul>
<li>remove the problematic key and use <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> again (for validation or type errors)</li>
<li>change the value of the problematic key and use <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> again (for validation errors)</li>
<li>do a <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> (for conflicts, i.e. error C02000) and then<ul>
<li>set the same keyset again (in favour of what was set by this user)</li>
<li>drop the old keyset (in favour of what was set from another application)</li>
<li>merge the original, your own and the other keyset</li>
</ul>
</li>
<li>export the configuration into a file (for unresolvable errors)</li>
<li>repeating the same <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> might be of limited use, if the user does not explicitly request it, because temporary errors are rare and its unlikely that they fix themselves (e.g. disc full, permission problems)</li>
</ul>
<dl class="section user"><dt>Optimization</dt><dd>Only backends that<ul>
<li>contain at least one changed key according to elektraDiffCalculate(),</li>
<li>contain fewer keys than at the end of <a class="el" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1" title="Retrieve Keys from the Key database in an atomic and universal way.">kdbGet()</a> will be called. There won't be an unnecessary write for unchanged keys.</li>
</ul>
</dd></dl>
<p>If none of the backends needs an update, <a class="el" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf" title="Set Keys to the Key database in an atomic and universal way.">kdbSet()</a> returns 0 and does nothing.</p>
<div class="fragment"><div class="line">KeySet * myConfig = <a class="code" href="group__keyset.html#ga671e1aaee3ae9dc13b4834a4ddbd2c3c">ksNew</a> (0, <a class="code" href="group__keyset.html#ga7a28fce3773b2c873c94ac80b8b4cd54">KS_END</a>);</div>
<div class="line">Key * parentKey = <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;system:/sw/MyApp&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>);</div>
<div class="line"><a class="code" href="classkdb_1_1KDB.html#a7e0637995ce9f294cdbc6f167df6db40">KDB</a> * handle = <a class="code" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">kdbOpen</a> (NULL, parentKey);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, myConfig, parentKey); <span class="comment">// kdbGet needs to be called first!</span></div>
<div class="line">KeySet * base = <a class="code" href="group__keyset.html#gac59e4b328245463f1451f68d5106151c">ksDup</a> (myConfig);     <span class="comment">// save a copy of original keyset</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// change the keys within myConfig</span></div>
<div class="line"><a class="code" href="group__keyset.html#gaa5a1d467a4d71041edce68ea7748ce45">ksAppendKey</a> (myConfig, <a class="code" href="group__key.html#gad23c65b44bf48d773759e1f9a4d43b89">keyNew</a> (<span class="stringliteral">&quot;system:/sw/MyApp/Test&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8ac66e4a49d09212b79f5754ca6db5bd2e">KEY_VALUE</a>, <span class="stringliteral">&quot;5&quot;</span>, <a class="code" href="group__key.html#gga9b703ca49f48b482def322b77d3e6bc8aa8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>));</div>
<div class="line"> </div>
<div class="line">KeySet * ours = <a class="code" href="group__keyset.html#gac59e4b328245463f1451f68d5106151c">ksDup</a> (myConfig); <span class="comment">// save a copy of our keyset</span></div>
<div class="line">KeySet * theirs;                  <span class="comment">// needed for 3-way merging</span></div>
<div class="line"><span class="keywordtype">int</span> ret = <a class="code" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet</a> (handle, myConfig, parentKey);</div>
<div class="line"><span class="keywordflow">while</span> (ret == -1) <span class="comment">// as long as we have an error</span></div>
<div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> strategy = showElektraErrorDialog (parentKey);</div>
<div class="line">        theirs = <a class="code" href="group__keyset.html#gac59e4b328245463f1451f68d5106151c">ksDup</a> (ours);</div>
<div class="line">        <a class="code" href="group__kdb.html#ga28e385fd9cb7ccfe0b2f1ed2f62453a1">kdbGet</a> (handle, theirs, parentKey); <span class="comment">// refresh key database</span></div>
<div class="line">        KeySet * result = <a class="code" href="kdbmerge_8h.html#a2cc0dc19c99b2bc86feb1f2607df343a">elektraMerge</a>(</div>
<div class="line">                <a class="code" href="group__keyset.html#ga6b00cf82b59af4d883a9bad6cf4a4a4a">ksCut</a>(ours, parentKey), parentKey,</div>
<div class="line">                <a class="code" href="group__keyset.html#ga6b00cf82b59af4d883a9bad6cf4a4a4a">ksCut</a>(theirs, parentKey), parentKey,</div>
<div class="line">                <a class="code" href="group__keyset.html#ga6b00cf82b59af4d883a9bad6cf4a4a4a">ksCut</a>(base, parentKey), parentKey,</div>
<div class="line">                parentKey, strategy, parentKey);</div>
<div class="line">        <span class="keywordtype">int</span> numberOfConflicts = <a class="code" href="kdbmerge_8h.html#aa4b4c9a6f50a1f5d602fc84c8abce208">elektraMergeGetConflicts</a> (parentKey);</div>
<div class="line">        <a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (theirs);</div>
<div class="line">        <span class="keywordflow">if</span> (result != NULL) {</div>
<div class="line">                ret = <a class="code" href="group__kdb.html#ga11436b058408f83d303ca5e996832bcf">kdbSet</a> (handle, result, parentKey);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="comment">// an error happened while merging</span></div>
<div class="line">                <span class="keywordflow">if</span> (numberOfConflicts &gt; 0 &amp;&amp; strategy == <a class="code" href="kdbmerge_8h.html#a2c76c3f8b54a741ba9fdbfe6b5e0ee5caeaf7be70515ee5bc9b6dae1c844ec492">MERGE_STRATEGY_ABORT</a>)</div>
<div class="line">                {</div>
<div class="line">                        <span class="comment">// Error due to merge conflicts</span></div>
<div class="line">                        ret = -1;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                        <span class="comment">// Internal errors, out of memory etc.</span></div>
<div class="line">                        ret = -1;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (ours);</div>
<div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (base);</div>
<div class="line"><a class="code" href="group__keyset.html#ga27e5c16473b02a422238c8d970db7ac8">ksDel</a> (myConfig); <span class="comment">// delete the in-memory configuration</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f">kdbClose</a> (handle, parentKey); <span class="comment">// no more affairs with the key database.</span></div>
<div class="line"><a class="code" href="group__key.html#ga3df95bbc2494e3e6703ece5639be5bb1">keyDel</a> (parentKey);</div>
</div><!-- fragment --><p> showElektraErrorDialog() and doElektraMerge() need to be implemented by the user of Elektra. For doElektraMerge a 3-way merge algorithm exists in libelektra-tools.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>contains internal information of <a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5">opened </a> key database </td></tr>
    <tr><td class="paramname">ks</td><td>a <a class="el" href="classkdb_1_1KeySet.html" title="A keyset holds together a set of keys.">KeySet</a> which should contain changed keys, otherwise nothing is done </td></tr>
    <tr><td class="paramname">parentKey</td><td>Keys below <code>parentKey</code> will be set to <code>handle</code>. It is also used to add warnings and set error information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>on success </td></tr>
    <tr><td class="paramname">0</td><td>if nothing had to be done, no changes in <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a> </td></tr>
    <tr><td class="paramname">-1</td><td>on failure, no changes in <a class="el" href="classkdb_1_1KDB.html" title="Constructs a class KDB.">KDB</a>, an error will be set on <code>parentKey</code> if possible (see "Errors" above)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.0.0</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__kdb.html#ga844e1299a84c3fbf1d3a905c5c893ba5" title="Opens the session with the Key database.">kdbOpen()</a> for getting <code>handle</code> </dd>
<dd>
<a class="el" href="group__kdb.html#gadb54dc9fda17ee07deb9444df745c96f" title="Closes the session with the Key database.">kdbClose()</a> that must be called afterwards </dd>
<dd>
<a class="el" href="group__keyset.html#ga4287b9416912c5f2ab9c195cb74fb094" title="Return the current Key.">ksCurrent()</a> contains the error <a class="el" href="classkdb_1_1Key.html" title="Key is an essential class that encapsulates key name , value  and metainfo .">Key</a></dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if no key was updated </td></tr>
    <tr><td class="paramname">1</td><td>if user or system keys were updated </td></tr>
    <tr><td class="paramname">2</td><td>if user and system keys were updated</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">returned</td><td>the keyset where the keys will be in </td></tr>
    <tr><td class="paramname">keyname</td><td>the keyname below the names should be set</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">KDBException</td><td>if there were problems with the database </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="kdb_8hpp.html">kdb.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
<script>
  mermaid.initialize({
    startOnLoad: true,
    theme: 'dark'
  });
</script>
</body>
</html>
