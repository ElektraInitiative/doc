<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: Validation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.9.7</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Validation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_doc_decisions_validation"></a> </p>
<h1><a class="anchor" id="autotoc_md2064"></a>
Problem</h1>
<p>Validation plugins operate as independent blackboxes. For every backend each mounted validation plugin iterates over the whole keyset, checks every key for its trigger metakey, and validates the key.</p>
<p>Currently all needed validation plugins need to be specified at mount-time - if additional validation is required, the backend has to be remounted with the required plugins and plugin configuration.</p>
<p>If validation of a key fails, each plugin decides on its own how to handle the issue and proceed in ways that might be different than what is expected or desired.</p>
<h1><a class="anchor" id="autotoc_md2065"></a>
Constraints</h1>
<h1><a class="anchor" id="autotoc_md2066"></a>
Assumptions</h1>
<p>While plugins should always fail and return an error if validation fails on kdbSet, there are be can be several different requirements for what should happen on kdbGet and handle problems e.g.</p>
<ul>
<li><p class="startli">only issue warnings</p>
<p class="startli">we want to read the whole configuration, but issue warnings if keys fail to validate instead</p>
<p class="startli">problems are handled external by an application, user, ...</p>
</li>
<li><p class="startli">remove invalid keys</p>
<p class="startli">we want to read the whole configuration, but drop invalid keys</p>
<p class="startli">invalid keys might be replaced by default values, requested from the user, ...</p>
</li>
<li><p class="startli">fail with error</p>
<p class="startli">we only want to read valid configurations, and fail with an error if the configuration is invalid</p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md2067"></a>
Considered Alternatives</h1>
<ul>
<li>Extend validation plugins to allow us to specify what should happen if a key fails to validate</li>
<li>Export a validation function that allows us to use an additional plugin to decide what should be done</li>
</ul>
<h1><a class="anchor" id="autotoc_md2068"></a>
Decision</h1>
<p>Use a wrapper plugin to iterate over the keyset and delegate the validation of each key to the corresponding validation plugin.</p>
<h1><a class="anchor" id="autotoc_md2069"></a>
Rationale</h1>
<ul>
<li>Validation plugins don't need to know what should be done if the validation fails</li>
<li>We can run multiple validations on every key and improve error messages</li>
<li>Different ways of handling errors only need to be implemented once</li>
</ul>
<h1><a class="anchor" id="autotoc_md2070"></a>
Implications</h1>
<p>validation plugins have to export their validation routine</p>
<p><code>static int validateKey(const Key * key, const Key * errorKey)</code></p>
<p>returning 1 if validation succeeded, 0 on failure</p>
<h1><a class="anchor" id="autotoc_md2071"></a>
Related Decisions</h1>
<h1><a class="anchor" id="autotoc_md2072"></a>
Notes</h1>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
