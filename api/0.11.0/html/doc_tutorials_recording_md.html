<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="$langISO">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: Recording Changes to the KDB</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
$darkmode
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<!-- Add mermaid.js -->
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo_color_doxygen.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Elektra<span id="projectnumber">&#160;0.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Recording Changes to the KDB </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_doc_tutorials_recording"></a> Elektra provides a powerful session recording feature. You can control it through the <code>kdb</code> command-line utility.</p>
<p>Session recording will track all the changes done to the KDB while it is enabled. This includes changes done by elektrified applications themselves too, not only changes done through the <code>kdb</code> utility. The recorded changes can be exported, undone or used for auditing purposes.</p>
<p>There are seven commands to interact with the session recording feature:</p>
<ul>
<li><code>kdb record-start</code>: starts recording. If there are existing recorded changes, they will NOT be removed. New changes will be appended.</li>
<li><code>kdb record-stop</code>: stops recording.</li>
<li><code>kdb record-reset</code>: removes all recorded changes.</li>
<li><code>kdb record-export</code>: export the changes.</li>
<li><code>kdb record-undo</code>: undo everything that has been recorded.</li>
<li><code>kdb record-state</code>: show information about the state of session recording. This includes information about what keys will be recorded and which changes have already been made to the KDB.</li>
<li><code>kdb record-rm</code>: Remove specific keys from the recording.</li>
</ul>
<p>For a more detailed description and options for each command, please take a look at their respective man pages.</p>
<h1><a class="anchor" id="autotoc_md4674"></a>
A Simple Recording Session</h1>
<div class="fragment"><div class="line"># Seed some data first</div>
<div class="line">kdb set user:/test/name Franz</div>
<div class="line">kdb set user:/test/color Red</div>
<div class="line"> </div>
<div class="line"># Enable session recording for all keys below user:/</div>
<div class="line">kdb record-start user:/</div>
<div class="line"># RET:0</div>
<div class="line"> </div>
<div class="line">kdb set user:/test/name Hans</div>
<div class="line">kdb set user:/test/age 29</div>
<div class="line">kdb rm user:/test/color</div>
<div class="line"> </div>
<div class="line"># View the current state of session recording</div>
<div class="line">kdb record-state</div>
<div class="line">#&gt; Recording is active for user:/⏎⏎Added 1 key(s)⏎Modified 1 key(s)⏎Removed 1 key(s)⏎⏎Added key user:/test/age⏎Modified key user:/test/name⏎Removed key user:/test/color</div>
<div class="line"> </div>
<div class="line"># Stop session recording again</div>
<div class="line">kdb record-stop</div>
<div class="line"># RET:0</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md4675"></a>
Exporting Recorded changes</h1>
<p>One of the most powerful features of session recording is the ability to export the recorded changes. This allows you to apply the specific modifications on other computers, without having to export and overwrite the complete configuration.</p>
<div class="fragment"><div class="line">kdb record-export [&lt;source&gt;] [&lt;format&gt;]</div>
</div><!-- fragment --><p>Where <code>source</code> and <code>format</code> are optional parameters. The <code>source</code> parameter lets you specify which keys you want to export. By default, this is all keys, or <code>/</code>. The <code>format</code> parameter lets you specify which format you want to export the changes in. By default, we use the <code>ansible</code> format. Note that the format is just the name of the Elektra storage plugin you want to use.</p>
<p>You can also use the <code>-c</code> option to specify a list of configuration parameters for the storage plugin. See the README of the plugin for more details about which parameters are supported.</p>
<div class="fragment"><div class="line"># Export recorded changes into an Ansible playbook</div>
<div class="line">kdb record-export / ansible -c playbook/name=&quot;Recording Tutorial&quot;</div>
<div class="line"># RET:0</div>
</div><!-- fragment --><div class="fragment"><div class="line">---</div>
<div class="line">- name: Recording Tutorial</div>
<div class="line">  hosts: all</div>
<div class="line">  collections:</div>
<div class="line">    - elektra_initiative.libelektra</div>
<div class="line">  tasks:</div>
<div class="line">    - name: Set Elektra Keys</div>
<div class="line">      elektra:</div>
<div class="line">        keys:</div>
<div class="line">          - user:</div>
<div class="line">              test:</div>
<div class="line">                age:</div>
<div class="line">                  - value: 29</div>
<div class="line">                color:</div>
<div class="line">                  - remove: true</div>
<div class="line">                name:</div>
<div class="line">                  - value: Hans</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
<script>
  mermaid.initialize({
    startOnLoad: true,
    theme: 'dark'
  });
</script>
</body>
</html>
