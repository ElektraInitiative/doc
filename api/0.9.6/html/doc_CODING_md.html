<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: CODING</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.9.6</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">CODING </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_doc_CODING"></a> This document provides an introduction in how the source code of libelektra is organized and how and where to add functionality.</p>
<h1><a class="anchor" id="autotoc_md1573"></a>
Folder structure</h1>
<p>After you downloaded and unpacked Elektra you should see some folders. The most important are:</p>
<ul>
<li><b>src:</b> This directory contains the source of the libraries, tools and plugins.</li>
<li><b>doc:</b> General documentation for the project and the core library.</li>
<li><b>examples:</b> Examples on how to use the core library.</li>
<li><b>tests:</b> Contains the testing framework for the source (<b>src</b>).</li>
</ul>
<p>More about the structure you find in the folder's <code>README.md</code>.</p>
<h1><a class="anchor" id="autotoc_md1574"></a>
General Information</h1>
<ul>
<li>Keep to the style that is already present, except if this document says otherwise: then please open an issue for offending code.</li>
<li>We use Unix line endings</li>
<li>Large files should be in <a href="http://blobs.libelektra.org/">http://blobs.libelektra.org/</a> or <a href="https://rawdata.libelektra.org">https://rawdata.libelektra.org</a></li>
<li>&lsquo;find . -not -regex &rsquo;[/.a-zA-Z0-9_-]*'` should not find your file names</li>
</ul>
<h1><a class="anchor" id="autotoc_md1575"></a>
Source Code</h1>
<p>The same guidelines apply to all code in the repository including the plugins.</p>
<h2><a class="anchor" id="autotoc_md1576"></a>
General Guidelines</h2>
<p>You are only allowed to break a guideline if there is a good reason to do so. When you do, document the fact as comment next to the code.</p>
<p>Of course, all rules of good software engineering apply: Use meaningful names and keep the software both testable and reusable.</p>
<p>The purpose of the guidelines is to have a consistent style, not to teach programming.</p>
<p>If you see code that breaks guidelines do not hesitate to fix them or at least open issues.</p>
<p>If you see inconsistency within the rules do not hesitate to open an issue about it.</p>
<h2><a class="anchor" id="autotoc_md1577"></a>
Code Comments</h2>
<p>Code is not only for the computer, but it should be readable for humans, too. Up-to-date code comments are essential to make code understandable for others. Thus please use following techniques (in order of preference):</p>
<ol type="1">
<li>Comment functions with <code>/**/</code> and Doxygen, see below.</li>
<li><p class="startli">You should also add assertions to state what should be true at a specific position in the code. Their syntax is checked and they are automatically verified at run-time. So they are not only useful for people reading the code but also for tools. Assertions in Elektra are used by:</p>
<p class="startli"><code>#include &lt;<a class="el" href="kdbassert_8h.html" title="Assertions macros.">kdbassert.h</a>&gt;</code></p>
<p class="startli"><code>ELEKTRA_ASSERT (condition, "formatted text to be printed when assert fails", ...)</code></p>
<p class="startli">Note: Do not use assert for user-APIs, always handle arguments of user-APIs like untrusted input.</p>
</li>
<li><p class="startli">If the "comment" might be useful to be printed during execution, use logging:</p>
<p class="startli"><code>#include &lt;<a class="el" href="kdblogger_8h.html" title="Logger Interface.">kdblogger.h</a>&gt;</code></p>
<p class="startli"><code>ELEKTRA_LOG ("formatted text to be printed according to log filters", ...)</code></p>
<p class="startli">Read <a class="el" href="doc_dev_logging_md.html">HERE</a> for how to enable the logger.</p>
</li>
<li>Otherwise comment within source with <code>//</code> or with <code>/**/</code> for multi-line comments. Use <code>TODO</code> to indicate that something is not yet done. Before merging, relevant <code>TODO</code>s should be fixed or <a href="https://issues.libelektra.org">issues</a> created for left-overs.</li>
</ol>
<h2><a class="anchor" id="autotoc_md1578"></a>
Coding Style</h2>
<ul>
<li><p class="startli">Limits</p><ul>
<li>Functions should not exceed 100 lines.</li>
<li>Files should not exceed 1000 lines.</li>
<li>A line should not be longer than 140 characters.</li>
</ul>
<p class="startli">Split up when those limits are reached. Rationale: Readability with split windows.</p>
</li>
<li>Indentation<ul>
<li>Use tabs for indentation.</li>
<li>One tab equals 8 spaces.</li>
</ul>
</li>
<li>Blocks<ul>
<li>Use blocks even for single line statements.</li>
<li>Curly braces go on a line on their own on the previous indentation level.</li>
<li>Avoid multiple variable declarations at one place.</li>
<li>Declare Variables as late as possible, preferable within blocks.</li>
</ul>
</li>
<li>Naming<ul>
<li>Use camelCase for functions and variables.</li>
<li>Start types with upper-case, everything else with lower-case.</li>
<li>Prefix names with <code>elektra</code> for internal usage. External API either starts with <code>ks</code>, <code>key</code> or <code>kdb</code>.</li>
</ul>
</li>
<li>Whitespaces<ul>
<li>Use space before and after equal when assigning a value.</li>
<li>Use space before round parenthesis ( <code>(</code> ).</li>
<li>Use space before and after <code>*</code> from Pointers.</li>
<li>Use space after <code>,</code> of every function argument.</li>
</ul>
</li>
</ul>
<p>The reformat script can ensure most code style rules, but it is obviously not capable of ensuring everything (e.g. naming conventions). So do not give this responsibility out of hands entirely. You can <a class="el" href="doc_tutorials_run_reformatting_script_with_docker_md.html">use docker</a> to ensure that you have the correct version of all our reformatting tools at hand.</p>
<h2><a class="anchor" id="autotoc_md1579"></a>
C Guidelines</h2>
<ul>
<li>The compiler shall not emit any warning (or error).</li>
<li>Use goto only for error situations.</li>
<li>Use <code>const</code> as much as possible.</li>
<li>Use <code>static</code> methods if they should not be externally visible.</li>
<li>C-Files have extension <code>.c</code>, Header files <code>.h</code>.</li>
<li>Use internal functions: prefer to use <code>elektraMalloc</code>, <code>elektraFree</code>.</li>
</ul>
<p><b>Example:</b> <a href="/home/jenkins/workspace/libelektra-release/src/libs/elektra/kdb.c">src/libs/elektra/kdb.c</a></p>
<h3><a class="anchor" id="autotoc_md1580"></a>
Clang Format</h3>
<p>To guarantee consistent formatting we use <a href="https://clang.llvm.org/docs/ClangFormat.html"><code>clang-format</code></a> (version <code>12</code>) to format all C and C++ code in the repository. Since our build servers also check the style for every pull request you might want to make sure you reformat your C/C++ code changes with this tool.</p>
<p>To find out which version of <code>clang-format</code> a certain build server uses please check:</p>
<ul>
<li>the Debian sid Docker image,</li>
<li>the Travis configuration file , and</li>
<li>the Cirrus configuration file</li>
</ul>
<p>and search for the relevant packages (<code>clang-format</code>, <code>llvm</code>). Currently we use clang-format <code>12</code></p>
<ul>
<li>in the Travis configuration file ,</li>
<li>in the Debian sid Docker container on the Jenkins build server, and</li>
<li>in the Cirrus macOS build jobs.</li>
</ul>
<h4><a class="anchor" id="autotoc_md1581"></a>
Installation</h4>
<h5>macOS</h5>
<p>On macOS you can install <code>clang-format</code> using <a href="https://brew.sh">Homebrew</a> either directly:</p>
<div class="fragment"><div class="line">brew install clang-format</div>
</div><!-- fragment --><p>or by installing the whole <a href="http://llvm.org">LLVM</a> infrastructure:</p>
<div class="fragment"><div class="line">brew install llvm</div>
</div><!-- fragment --><p>. Please note, that both of these commands will install current versions of <code>clang-format</code> that might format code a little bit differently than Clang-Format <code>12</code> in certain edge cases. If you want you can also install a specific version of LLVM and Clang-Format: e.g. Clang-Format <code>11</code> using LLVM <code>11</code>:</p>
<div class="fragment"><div class="line">brew install llvm@11</div>
</div><!-- fragment --><h5>Debian</h5>
<p>In Debian (Sid) the package for Clang-Format <code>12</code> is called <code>clang-format-12</code>:</p>
<div class="fragment"><div class="line">apt-get install clang-format-12</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md1582"></a>
Usage</h4>
<p>For the basic use cases you can use <code>clang-format</code> directly. To do that, just call the tool using the option <code>-i</code> and specify the name of the files you want to reformat. For example, if you want to reformat the file <code><a class="el" href="kdb_8hpp.html">src/bindings/cpp/include/kdb.hpp</a></code> you can use the following command:</p>
<div class="fragment"><div class="line"># On some systems such as Debian the `clang-format` executable also contains</div>
<div class="line"># the version number. For those systems, please replace `clang-format`,</div>
<div class="line"># with `clang-format-12` in the command below.</div>
<div class="line">clang-format -i src/bindings/cpp/include/kdb.hpp</div>
</div><!-- fragment --><p>. While this works fine, if you want to format only a small number of file, formatting multiple files can be quite tedious. For that purpose you can use the script `reformat-c` that reformats all C and C++ code in Elektra’s code base</p>
<div class="fragment"><div class="line">scripts/dev/reformat-c # This script will probably take some seconds to execute</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md1583"></a>
Tool Integration</h4>
<p>If you work on Elektra’s code base regularly you might want to integrate the formatting step directly in your development setup. <a href="https://clang.llvm.org/docs/ClangFormat.html">ClangFormat’s homepage</a> includes a list of integrations for various tools that should help you to do that. Even if this webpage does not list any integrations for your favorite editor or IDE, you can usually add support for external tools such as <code>clang-format</code> to advanced editors or IDEs pretty easily.</p>
<h5>TextMate</h5>
<p>While <a href="https://macromates.com">TextMate</a> supports <code>clang-format</code> for the current file directly via the keyboard shortcut <code>ctrl</code>+<code>⇧</code>+<code>H</code>, the editor does not automatically reformat the file on save. To do that</p>
<ol type="1">
<li>open the bundle editor (“Bundles” → “Edit Bundles”),</li>
<li>navigate to the “Reformat Code” item of the C bundle (“C” → “Menu Actions” → “Reformat Code”),</li>
<li>insert <code>callback.document.will-save</code> into the field “Semantic Class”, and</li>
<li>change the menu option for the field “Save” to “Nothing”</li>
</ol>
<p>. After that change TextMate will reformat C and C++ code with <code>clang-format</code> every time you save a file.</p>
<h2><a class="anchor" id="autotoc_md1584"></a>
C++ Guidelines</h2>
<ul>
<li>Everything as in C if not noted otherwise.</li>
<li>Do not use goto at all, use RAII instead.</li>
<li>Do not use raw pointers, use smart pointers instead.</li>
<li>C++-Files have extension <code>.cpp</code>, Header files <code>.hpp</code>.</li>
<li>Do not use <code>static</code>, but anonymous namespaces.</li>
<li>Write everything within namespaces and do not prefix names.</li>
<li>Oriented towards <a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md">more safe and modern usage</a>.</li>
</ul>
<p><b>Example:</b> <a href="/home/jenkins/workspace/libelektra-release/src/bindings/cpp/include/kdb.hpp">src/bindings/cpp/include/kdb.hpp</a></p>
<h2><a class="anchor" id="autotoc_md1585"></a>
CMake Guidelines</h2>
<p>We use a similar style for CMake as we do for other code:</p>
<ul>
<li>The length of a functions should not exceed 100 lines.</li>
<li>The length of a file should not exceed 1000 lines.</li>
<li>A line should not be longer than 140 characters.</li>
<li>Use tabs for indentation.</li>
<li>One tab equals 8 spaces.</li>
<li>Declare variables as late as possible, preferable within blocks.</li>
<li>Add a space character before round parenthesis ( <code>(</code> ).</li>
<li>Use lower case for command names (e.g. <code>set</code> instead of <code>SET</code>)</li>
</ul>
<h3><a class="anchor" id="autotoc_md1586"></a>
cmake format</h3>
<p>We use <a href="https://github.com/cheshirekow/cmake_format"><code>cmake-format</code></a> to reformat code according to the guidelines given above. Since <code>cmake-format</code> currently does not support tabs, we use the standard command <code>unexpand</code> to fix this issue. For example, to reformat the file <code>CMakeLists.txt</code> in the root folder of the repository we use the following command:</p>
<div class="fragment"><div class="line"># This command uses `sponge`, which is part of the [moreutils](https://joeyh.name/code/moreutils/) package.</div>
<div class="line">cmake-format CMakeLists.txt | unexpand | sponge CMakeLists.txt</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md1587"></a>
Installation</h4>
<p>Since <code>cmake-format</code> is written in <a href="https://www.python.org">Python</a> you usually install it via Python’s package manager <code>pip</code>:</p>
<div class="fragment"><div class="line"># Install cmakelang `0.6.13` with support for YAML config files</div>
<div class="line">pip install cmakelang[yaml]==0.6.13</div>
</div><!-- fragment --><p>. Please make sure, that you install the correct version (<code>0.6.13</code>) of cmake format:</p>
<div class="fragment"><div class="line">cmake-format --version</div>
<div class="line">#&gt; 0.6.13</div>
</div><!-- fragment --><p>, since otherwise the formatted code might look quite different.</p>
<p>We also use the <a href="https://joeyh.name/code/moreutils">moreutils</a> in our CMake formatting script, which you can install on macOS using <a href="https://brew.sh">Homebrew</a>:</p>
<div class="fragment"><div class="line">brew install moreutils</div>
</div><!-- fragment --><p>and on Debian using <code>apt-get</code>:</p>
<div class="fragment"><div class="line">apt-get install moreutils</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md1588"></a>
Usage</h4>
<p>If you want to reformat the whole codebase you can use the script `reformat-cmake`:</p>
<div class="fragment"><div class="line">scripts/dev/reformat-cmake # Running this script for the whole code base takes some time.</div>
</div><!-- fragment --><p>. To reformat specific files add a list of file paths after the command:</p>
<div class="fragment"><div class="line"># The command below reformats the file `cmake/CMakeLists.txt`.</div>
<div class="line">scripts/dev/reformat-cmake cmake/CMakeLists.txt</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md1589"></a>
Tool Integration</h4>
<p>If you work on CMake code quite often you probably want to integrate cmake format into your development workflow. The homepage of <a href="https://github.com/cheshirekow/cmake_format#integrations">cmake format</a> list some integration options.</p>
<h5>TextMate</h5>
<p>While TextMate does not support cmake format directly, you can quickly create a command that applies <code>cmake-format</code> every time you save a CMake file yourself. The steps below show one option to do that.</p>
<ol type="1">
<li>Open the “Bundle Editor”: Press <code>^</code> + <code>⌥</code> + <code>⌘</code> + <code>B</code></li>
<li>Create a new command:<ol type="a">
<li>Press <code>⌘</code> + <code>N</code></li>
<li>Select “Command”</li>
<li>Press the button “Create”</li>
</ol>
</li>
<li>Configure your new command<ol type="a">
<li>Use “Reformat Document” or a similar text as “Name”</li>
<li>Enter <code>source.cmake</code> in the field “Scope Selector”</li>
<li>Use <code>^</code> + <code>⇧</code> + <code>H</code> as “Key Equivalent”</li>
<li>Copy the text <code>callback.document.will-save</code> into the field “Semantic Class”</li>
<li>Select “Document” as “Input”</li>
<li>Select “Replace Document” in the dropdown menu for the option “Output”</li>
<li>Select “Line Interpolation” in the menu “Caret Placement”</li>
<li><p class="startli">Copy the following code into the text field:</p>
<p class="startli">``` #!/bin/bash</p>
<p class="startli">set -o pipefail if ! "${TM_CMAKE_FORMAT:-cmake-format}" - | ${TM_CMAKE_FORMAT_FILTER:-tee}; then . "$TM_SUPPORT_PATH/lib/bash_init.sh" exit_show_tool_tip fi ```</p>
</li>
<li>Save your new command: <code>⌘</code> + <code>S</code></li>
<li>Store the value <code>unexpand</code> in the variable <code>TM_CMAKE_FORMAT_FILTER</code>. To do that save the text</li>
</ol>
</li>
</ol>
<div class="fragment"><div class="line">TM_CMAKE_FORMAT_FILTER = &quot;unexpand&quot;</div>
</div><!-- fragment --><p>in a file called <a href="https://macromates.com/blog/2011/git-style-configuration"><code>.tm_properties</code></a> in the root of Elektra’s repository.</p>
<h2><a class="anchor" id="autotoc_md1590"></a>
Groovy Guidelines</h2>
<p>Please follow <a href="https://google.github.io/styleguide/javaguide.html">Google Java Style Guide</a> for Groovy (used by Jenkins) files.</p>
<p>Most notably use:</p>
<ul>
<li>2 spaces for indentation</li>
<li>Variable and function names in lowerCamelCase</li>
<li>K &amp; R style brackets</li>
</ul>
<h2><a class="anchor" id="autotoc_md1591"></a>
Java</h2>
<p>We use a similar style for Java and C/C++ code. This means we also use <code>clang-format</code> to format Java code. For more information on how to install <code>clang-format</code>, please take a look at the subheading “Clang Format” of the <b>“C Guidelines”</b>.</p>
<h3><a class="anchor" id="autotoc_md1592"></a>
Clang Format</h3>
<h4><a class="anchor" id="autotoc_md1593"></a>
Usage</h4>
<p>If you want to reformat all Java files in the repository you can use the script `reformat-java`:</p>
<div class="fragment"><div class="line">scripts/dev/reformat-java</div>
</div><!-- fragment --><p>. To reformat specific files add a list of file paths after the command:</p>
<div class="fragment"><div class="line"># The command below reformats the file `cmake/CMakeLists.txt`.</div>
<div class="line">scripts/dev/reformat-java src/bindings/jna/libelektra/src/main/java/org/libelektra/KDB.java</div>
</div><!-- fragment --><h5>TextMate</h5>
<p>The steps below show you how to create a <a href="https://macromates.com">TextMate</a> command that formats a documents with [<code>clang-format</code>][] every time you save it.</p>
<ol type="1">
<li>Open the “Bundle Editor”: Press <code>^</code> + <code>⌥</code> + <code>⌘</code> + <code>B</code></li>
<li>Create a new command:<ol type="a">
<li>Press <code>⌘</code> + <code>N</code></li>
<li>Select “Command”</li>
<li>Press the button “Create”</li>
</ol>
</li>
<li>Configure your new command<ol type="a">
<li>Use “Reformat Document” or a similar text as “Name”</li>
<li>Enter <code>source.java</code> in the field “Scope Selector”</li>
<li>Use <code>^</code> + <code>⇧</code> + <code>H</code> as “Key Equivalent”</li>
<li>Copy the text <code>callback.document.will-save</code> into the field “Semantic Class”</li>
<li>Select “Document” as “Input”</li>
<li>Select “Replace Input” in the dropdown menu for the option “Output”</li>
<li>Select “Line Interpolation” in the menu “Caret Placement”</li>
<li><p class="startli">Copy the following code into the text field:</p>
<p class="startli">``` #!/bin/bash</p>
<p class="startli">if ! "${TM_CLANG_FORMAT:-clang-format}" \ -style="${TM_CLANG_FORMAT_STYLE:-file}" \ -assume-filename="${TM_FILEPATH}"; then . "$TM_SUPPORT_PATH/lib/bash_init.sh" exit_show_tool_tip fi ```</p>
</li>
<li>Save your new command: <code>⌘</code> + <code>S</code></li>
</ol>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md1594"></a>
JavaScript Guidelines</h2>
<h3><a class="anchor" id="autotoc_md1595"></a>
Prettier</h3>
<p>We use <a href="https://prettier.io"><code>prettier</code></a> to format JavaScript files.</p>
<h4><a class="anchor" id="autotoc_md1596"></a>
Installation</h4>
<h5>macOS</h5>
<p>On macOS you can install <a href="https://prettier.io"><code>prettier</code></a> using <a href="https://brew.sh">Homebrew</a>:</p>
<div class="fragment"><div class="line">brew install prettier</div>
</div><!-- fragment --><h5>General</h5>
<p>To install <a href="https://prettier.io"><code>prettier</code></a> using Node’s package manager <a href="https://www.npmjs.com">npm</a> you can use the command below</p>
<div class="fragment"><div class="line">npm install --global prettier@2.2.1</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md1597"></a>
Usage</h4>
<p>To format all JavaScript files in the repository you can use the script `reformat-javascript`:</p>
<div class="fragment"><div class="line">scripts/dev/reformat-javascript</div>
</div><!-- fragment --><p>. To format only some files, please specify a list of filenames after the command:</p>
<div class="fragment"><div class="line">scripts/dev/reformat-markdown src/tools/qt-gui/qml/ErrorDialogCreator.js # Reformat this file</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1598"></a>
Markdown Guidelines</h2>
<ul>
<li>File Ending is <code>.md</code> or integrated within Doxygen comments</li>
<li>Only use <code>#</code> characters at the left side of headers/titles</li>
<li>Use <a href="https://help.github.com/en/articles/creating-and-highlighting-code-blocks">fences</a> for code/examples</li>
<li>Prefer fences which indicate the used language for better syntax highlighting</li>
<li>Fences with sh are for the shell recorder syntax</li>
<li><code>README.md</code> and tutorials should be written exclusively with shell recorder syntax so that we know that the code in the tutorial produces output as expected</li>
<li>Please use <a href="https://en.wiktionary.org/wiki/title_case"><b>title-case</b></a> for headings in the general documentation.</li>
<li>For man pages please use <b>only capital letters for subheadings</b> and only <b>small letters for the main header</b>. We use this header style to match the look and feel of man pages for Unix tools such as <code>ls</code> or <code>mkdir</code>.</li>
</ul>
<h3><a class="anchor" id="autotoc_md1599"></a>
Prettier</h3>
<p>We use <a href="https://prettier.io"><code>prettier</code></a> to format the documentation according to the guidelines given above.</p>
<p>Under certain <b>exceptional</b> circumstances you might want to prevent <code>prettier</code> from formatting certain parts of a Markdown file. To do that you can</p>
<ul>
<li>enclose the Markdown code in <code>&lt;!-- prettier-ignore-start --&gt;</code> and <code>&lt;!-- prettier-ignore-end --&gt;</code> tags, or</li>
<li>use <code>&lt;!-- prettier-ignore --&gt;</code> to disable formatting till the end of a file</li>
</ul>
<h4><a class="anchor" id="autotoc_md1600"></a>
Installation</h4>
<p>For information on how to install the tool, please take a look at “JavaScript Guidelines” → “Prettier” → “Installation”.</p>
<h4><a class="anchor" id="autotoc_md1601"></a>
Usage</h4>
<p>You can format all Markdown files in the repository using the script `reformat-markdown`:</p>
<div class="fragment"><div class="line">scripts/dev/reformat-markdown</div>
</div><!-- fragment --><p>. To format only some files, please specify a list of filenames after the command:</p>
<div class="fragment"><div class="line">scripts/dev/reformat-markdown doc/CODING.md # Reformat this file</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md1602"></a>
Tool Integration</h4>
<p>The <a href="https://prettier.io">homepage of Prettier</a> lists various options to integrate the tool into your workflow.</p>
<h5>TextMate</h5>
<p>To reformat a Markdown document in <a href="https://macromates.com">TextMate</a> every time you save it, please follow the steps listed below.</p>
<ol type="1">
<li>Open the “Bundle Editor”: Press <code>^</code> + <code>⌥</code> + <code>⌘</code> + <code>B</code></li>
<li>Create a new command:<ol type="a">
<li>Press <code>⌘</code> + <code>N</code></li>
<li>Select “Command”</li>
<li>Press the button “Create”</li>
</ol>
</li>
<li>Configure your new command<ol type="a">
<li>Use “Reformat Document” or a similar text as “Name”</li>
<li>Enter <code>text.html.markdown</code> in the field “Scope Selector”</li>
<li>Use <code>^</code> + <code>⇧</code> + <code>H</code> as “Key Equivalent”</li>
<li>Copy the text <code>callback.document.will-save</code> into the field “Semantic Class”</li>
<li>Select “Document” as “Input”</li>
<li>Select “Replace Input” in the dropdown menu for the option “Output”</li>
<li>Select “Line Interpolation” in the menu “Caret Placement”</li>
<li><p class="startli">Copy the following code into the text field:</p>
<p class="startli">``` #!/bin/bash</p>
<p class="startli">if ! "${TM_PRETTIER:-prettier}" &ndash;stdin &ndash;stdin-filepath "${TM_FILEPATH}" then . "$TM_SUPPORT_PATH/lib/bash_init.sh" exit_show_tool_tip fi ```</p>
</li>
<li>Save your new command: <code>⌘</code> + <code>S</code></li>
</ol>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md1603"></a>
Shell Guidelines</h2>
<ul>
<li>Please only use <a href="https://en.wikipedia.org/wiki/POSIX">POSIX</a> functionality.</li>
</ul>
<h3><a class="anchor" id="autotoc_md1604"></a>
shfmt</h3>
<p>We use <a href="https://github.com/mvdan/sh"><code>shfmt</code></a> to format Shell files in the repository.</p>
<h4><a class="anchor" id="autotoc_md1605"></a>
Installation</h4>
<h5>macOS</h5>
<p>You can install <a href="https://github.com/mvdan/sh"><code>shfmt</code></a> on macOS using <a href="https://brew.sh">Homebrew</a>:</p>
<div class="fragment"><div class="line">brew install shfmt</div>
</div><!-- fragment --><h5>General</h5>
<p><a href="https://github.com/mvdan/sh/releases">shfmt’s GitHub release page</a> offers binaries for various operating systems. For example, to install the binary for the current user on Linux you can use the following command:</p>
<div class="fragment"><div class="line">mkdir -p &quot;$HOME/bin&quot; &amp;&amp; cd &quot;$HOME/bin&quot; &amp;&amp; \</div>
<div class="line">  curl -L &quot;https://github.com/mvdan/sh/releases/download/v3.2.4/shfmt_v3.2.4_linux_amd64&quot; -o shfmt &amp;&amp; \</div>
<div class="line">  chmod u+x shfmt</div>
</div><!-- fragment --><p>. Please note that you have to make sure, that your <code>PATH</code> includes <code>$HOME/bin</code>, if you use the command above:</p>
<div class="fragment"><div class="line">export PATH=$PATH:&quot;$HOME/bin&quot;</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md1606"></a>
Usage</h4>
<p>We provide the script `reformat-shell` that formats the whole codebase with <a href="https://github.com/mvdan/sh"><code>shfmt</code></a>:</p>
<div class="fragment"><div class="line">scripts/dev/reformat-shell</div>
</div><!-- fragment --><p>. You can also reformat specific files by listing filenames after the script:</p>
<div class="fragment"><div class="line">scripts/dev/reformat-shell scripts/dev/reformat-shell # Reformat the source of `reformat-shell`</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md1607"></a>
Tool Integration</h4>
<p>The GitHub project page of <a href="https://github.com/mvdan/sh"><code>shfmt</code></a> offers some options to integrate the tool into your development workflow <a href="https://github.com/mvdan/sh#related-projects">here</a>.</p>
<h5>TextMate</h5>
<p>The steps below show you how to create a <a href="https://macromates.com">TextMate</a> command that formats a documents with <a href="https://github.com/mvdan/sh"><code>shfmt</code></a> every time you save it.</p>
<ol type="1">
<li>Open the “Bundle Editor”: Press <code>^</code> + <code>⌥</code> + <code>⌘</code> + <code>B</code></li>
<li>Create a new command:<ol type="a">
<li>Press <code>⌘</code> + <code>N</code></li>
<li>Select “Command”</li>
<li>Press the button “Create”</li>
</ol>
</li>
<li>Configure your new command<ol type="a">
<li>Use “Reformat Document” or a similar text as “Name”</li>
<li>Enter <code>source.shell</code> in the field “Scope Selector”</li>
<li>Use <code>^</code> + <code>⇧</code> + <code>H</code> as “Key Equivalent”</li>
<li>Copy the text <code>callback.document.will-save</code> into the field “Semantic Class”</li>
<li>Select “Document” as “Input”</li>
<li>Select “Replace Input” in the dropdown menu for the option “Output”</li>
<li>Select “Line Interpolation” in the menu “Caret Placement”</li>
<li><p class="startli">Copy the following code into the text field:</p>
<p class="startli">``` #!/bin/bash</p>
<p class="startli">if ! "${TM_SHFMT_FORMAT:-shfmt}" -s -sr; then . "$TM_SUPPORT_PATH/lib/bash_init.sh" exit_show_tool_tip fi ```</p>
</li>
<li>Save your new command: <code>⌘</code> + <code>S</code></li>
</ol>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md1608"></a>
Doxygen Guidelines</h2>
<p><code>doxygen</code> is used to document the API and to build the html and pdf output. We also support the import of Markdown pages. Doxygen 1.8.8 or later is required for this feature (Anyways you can find the <a href="https://doc.libelektra.org/api/master/html/">API Doc</a> online). Links between Markdown files will be converted with the <a class="el" href="doc_markdownlinkconverter_README_md.html">Markdown Link Converter</a>. <b>Markdown pages are used in the pdf, therefore watch which characters you use and provide a proper encoding!</b></p>
<ul>
<li>use <code>@</code> to start Doxygen tags</li>
<li>Do not duplicate information available in git in Doxygen comments.</li>
<li>Use <code>@copydoc</code>, <code>@copybrief</code> and <code>@copydetails</code> intensively (except for file headers).</li>
</ul>
<h2><a class="anchor" id="autotoc_md1609"></a>
File Headers</h2>
<p>Files should start with:</p>
<div class="fragment"><div class="line"> </div>
</div><!-- fragment --><p>Note:</p>
<ul>
<li><code>@</code> <code>file</code> has <em>no</em> parameters.</li>
<li><code>@</code> <code>brief</code> should contain a short statement about the content of the file and is needed so that your file gets listed at <a href="https://doc.libelektra.org/api/master/html/files.html">https://doc.libelektra.org/api/master/html/files.html</a></li>
</ul>
<p>The duplication of the filename, author and date is not needed, because this information is tracked using git and <a class="el" href="doc_AUTHORS_md.html">doc/AUTHORS.md</a> already.</p>
<h1><a class="anchor" id="autotoc_md1610"></a>
Further Readings</h1>
<ul>
<li>Make sure to read <a class="el" href="doc_DESIGN_md.html">DESIGN</a> together with this document. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
