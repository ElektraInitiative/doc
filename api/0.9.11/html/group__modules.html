<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: Modules</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.9.11</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Modules</div>  </div>
</div><!--header-->
<div class="contents">

<p>Loading Modules for Elektra.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa40915e67f973ccd5258aa450bd03585"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modules.html#gaa40915e67f973ccd5258aa450bd03585">elektraModulesInit</a> (KeySet *modules, Key *error)</td></tr>
<tr class="memdesc:gaa40915e67f973ccd5258aa450bd03585"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises the module loading system.  <a href="group__modules.html#gaa40915e67f973ccd5258aa450bd03585">More...</a><br /></td></tr>
<tr class="separator:gaa40915e67f973ccd5258aa450bd03585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga09300fbf0e0cfc9dc80bb877b00117c0"><td class="memItemLeft" align="right" valign="top">elektraPluginFactory&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modules.html#ga09300fbf0e0cfc9dc80bb877b00117c0">elektraModulesLoad</a> (KeySet *modules, const char *name, Key *error)</td></tr>
<tr class="memdesc:ga09300fbf0e0cfc9dc80bb877b00117c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a library with the given name.  <a href="group__modules.html#ga09300fbf0e0cfc9dc80bb877b00117c0">More...</a><br /></td></tr>
<tr class="separator:ga09300fbf0e0cfc9dc80bb877b00117c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5646d92ffe3e1e04c4586d9c910ba6bd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modules.html#ga5646d92ffe3e1e04c4586d9c910ba6bd">elektraModulesClose</a> (KeySet *modules, Key *error)</td></tr>
<tr class="memdesc:ga5646d92ffe3e1e04c4586d9c910ba6bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close all modules.  <a href="group__modules.html#ga5646d92ffe3e1e04c4586d9c910ba6bd">More...</a><br /></td></tr>
<tr class="separator:ga5646d92ffe3e1e04c4586d9c910ba6bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Loading Modules for Elektra. </p>
<p>Unfortunately there is no portable way to load modules, plugins or libraries. So Elektra needed a framework which abstracts the loading of modules. Depending of the operating system the build system chooses different source files which actually implement the loading of a module.</p>
<p>The goals are:</p><ul>
<li>to have a list of all loaded modules</li>
<li>writing module loaders should be easy</li>
<li>handle and report errors well</li>
<li>avoid loading of modules multiple times (maybe the OS can't handle that well)</li>
<li>hide the OS dependent handle inside a Key (handle is needed to close module afterwards) </li>
</ul>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga5646d92ffe3e1e04c4586d9c910ba6bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5646d92ffe3e1e04c4586d9c910ba6bd">&#9670;&nbsp;</a></span>elektraModulesClose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int elektraModulesClose </td>
          <td>(</td>
          <td class="paramtype">KeySet *&#160;</td>
          <td class="paramname"><em>modules</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Key *&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close all modules. </p>
<p>Iterates over all modules and closes each of them.</p>
<p>Finish all affairs with the modules. Delete all keys where the appropriate module could be closed.</p>
<p>If it is not possible to close a module, still try to close all other modules, but report the error with the error key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">modules</td><td>all modules in this keyset will be closed </td></tr>
    <tr><td class="paramname">error</td><td>a key to append the error information if it is not null </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>-1 on error </dd>
<dd>
&gt;=0 otherwise</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>all error information is stored in the key 'error' </dd></dl>

</div>
</div>
<a id="gaa40915e67f973ccd5258aa450bd03585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa40915e67f973ccd5258aa450bd03585">&#9670;&nbsp;</a></span>elektraModulesInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int elektraModulesInit </td>
          <td>(</td>
          <td class="paramtype">KeySet *&#160;</td>
          <td class="paramname"><em>modules</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Key *&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialises the module loading system. </p>
<p>Most operating systems will have to do nothing here. Anyway you are required to add the key system:/elektra/modules if it was successful.</p>
<p>On error -1 is returned and if error != 0 error information is added to it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">modules</td><td>an empty keyset </td></tr>
    <tr><td class="paramname">error</td><td>a key to append the error information if it is not null </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>-1 on error </dd>
<dd>
&gt;=0 otherwise</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>the key system:/elektra/modules is added in case of success </dd></dl>

</div>
</div>
<a id="ga09300fbf0e0cfc9dc80bb877b00117c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga09300fbf0e0cfc9dc80bb877b00117c0">&#9670;&nbsp;</a></span>elektraModulesLoad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elektraPluginFactory elektraModulesLoad </td>
          <td>(</td>
          <td class="paramtype">KeySet *&#160;</td>
          <td class="paramname"><em>modules</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Key *&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a library with the given name. </p>
<dl class="section return"><dt>Returns</dt><dd>a pointer to the factory which can create the plugin.</dd></dl>
<p>Make sure that you first lookup if this module was already loaded. If it was, just return the pointer and you are done.</p>
<p>Otherwise load the module/library given by name. You need to take care that a proper name is used. The name does not have any path, pre- or postfixes.</p>
<p>The next step is to fetch the symbol elektraPluginFactory.</p>
<p>If everything was successful append all information to the keyset modules and return the pointer. Take care that you can close the module with that information. All information needs to be stored within system:/elektra/modules/name You might want to use an struct and store it there as binary key.</p>
<p>If anything goes wrong don't append anything to modules. Instead report the error to the error key and return with 0.</p>
<dl class="section pre"><dt>Precondition</dt><dd>the name is not null, empty and has at least one character different to '/'. It is suitable to be used as keyAddBaseName without any further error checking.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">modules</td><td>where to get existing modules from a new module will be added there </td></tr>
    <tr><td class="paramname">name</td><td>the name for the plugin to load. Note that it does not have any prefixes or postfixes, you need to add them yourself. </td></tr>
    <tr><td class="paramname">error</td><td>the key to add warnings or report errors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer which can create a Plugin </dd>
<dd>
0 on error </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
