<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: Plugin: python</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.9.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Plugin: python </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>infos = Information about the python plugin is in keys below</li>
<li>infos/author = Manuel Mausz <a href="#" onclick="location.href='mai'+'lto:'+'man'+'ue'+'l-e'+'le'+'ktr'+'a@'+'mau'+'sz'+'.at'; return false;">manue<span style="display: none;">.nosp@m.</span>l-el<span style="display: none;">.nosp@m.</span>ektra<span style="display: none;">.nosp@m.</span>@mau<span style="display: none;">.nosp@m.</span>sz.at</a></li>
<li>infos/licence = BSD</li>
<li>infos/provides =</li>
<li>infos/needs =</li>
<li>infos/placements = getstorage setstorage</li>
<li>infos/status = maintained unittest configurable global memleak</li>
<li>infos/description = proxy that calls other plugins (scripts) written in python</li>
</ul>
<p>The plugin uses Python to do magic things. It allows plugins to be written in Python.</p>
<p>What a Python script can do is not really limited by design, so any kind of plugin may be implemented. The python plugin is especially useful to write filter and logging scripts.</p>
<p>The python plugin requires the configuration parameter <b>script</b> holding the file path to a python script. The mount command would look like</p>
<div class="fragment"><div class="line">kdb mount file.ini /python python script=/path/to/filter_script.py</div></div><!-- fragment --><p>if the <b>ini</b> plugin should be used for storage and the python plugin only serves to invoke the filter script.</p>
<p>For a Python script that serves as INI storage plugin itself, one uses</p>
<div class="fragment"><div class="line">kdb mount file.json /python python script=python_configparser.py</div></div><!-- fragment --><p>The python plugin supports following optional configuration values/flags:</p>
<ul>
<li><code>script</code> (string): The script to be executed.</li>
<li><code>print</code> (flag): Make the plugin print engine errors, triggered by the calls of this plugin, to stderr. Mainly intended for diagnostic. Please note that the Python engine itself will print script errors to stderr regardless of this flag.</li>
<li><code>python/path</code> (string): Extends sys.path by this entry. Better then PYTHONPATH it is always available, regardless of the context where a binary is executed.</li>
</ul>
<p>Python scripts must implement a class called <code>ElektraPlugin</code> with one parameter. The class itself can implement the following functions</p>
<ul>
<li>open(self, config, errorKey)</li>
<li>get(self, returned, parentKey)</li>
<li>set(self, returned, parentKey)</li>
<li>error(self, returned, parentKey)</li>
<li>close(self, errorKey)</li>
</ul>
<p>where <em>config</em> &amp; <em>returned</em> are KeySets and <em>errorKey</em> &amp; <em>parentKey</em> are Keys. For the return codes of the functions, the same rules as for normal plugins apply.</p>
<p>If a function is not available, it simply is not called. A script does not have to implement all functions therefore.</p>
<p>Access to <b>kdb</b> can be retrieved using the Python import</p>
<div class="fragment"><div class="line">import kdb</div></div><!-- fragment --><p>An example script that prints some information for each method call would be:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>ElektraPlugin(object):</div><div class="line">    <span class="keyword">def </span>open(self, config, errorKey):</div><div class="line">        print(<span class="stringliteral">&quot;Python script method &#39;open&#39; called&quot;</span>)</div><div class="line">        <span class="keywordflow">return</span> 0</div><div class="line"></div><div class="line">    <span class="keyword">def </span>get(self, returned, parentKey):</div><div class="line">        print(<span class="stringliteral">&quot;Python script method &#39;get&#39; called&quot;</span>)</div><div class="line">        <span class="keywordflow">return</span> 1</div><div class="line"></div><div class="line">    <span class="keyword">def </span>set(self, returned, parentKey):</div><div class="line">        print(<span class="stringliteral">&quot;Python script method &#39;set&#39; called&quot;</span>)</div><div class="line">        <span class="keywordflow">return</span> 1</div><div class="line"></div><div class="line">    <span class="keyword">def </span>error(self, returned, parentKey):</div><div class="line">        print(<span class="stringliteral">&quot;Python script method &#39;error&#39; called&quot;</span>)</div><div class="line">        <span class="keywordflow">return</span> 1</div><div class="line"></div><div class="line">    <span class="keyword">def </span>close(self, errorKey):</div><div class="line">        print(<span class="stringliteral">&quot;Python script method &#39;close&#39; called&quot;</span>)</div><div class="line">        <span class="keywordflow">return</span> 0</div></div><!-- fragment --><p>Further examples can be found in the python directory.</p>
<p>Be aware that a Python script will never be as performant as a native C/C++ plugin. Spinning up the interpreter takes additional time and resources. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
