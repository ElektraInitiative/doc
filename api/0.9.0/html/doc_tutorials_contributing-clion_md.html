<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.9.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Introduction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this tutorial, we will go through the steps necessary to contribute to Elektra to make it easier for you to get started. We will use a Unix based OS like Linux and CLion for development, but depending on where you want to contribute code, other IDEs will also be sufficient. Before you start, please read this to get familiar with the process of contributing to Elektra.</p>
<h2>Prerequisites</h2>
<ul>
<li><a href="https://git-scm.com/download">Git</a> or similar software</li>
<li><a href="https://www.jetbrains.com/clion/">CLion</a> or similar software</li>
<li><a href="https://github.com/">GitHub account</a></li>
</ul>
<h2>Forking the Repository</h2>
<p>Libelektra is hosted on GitHub. You can find its repository here:</p>
<ul>
<li><a href="https://github.com/ElektraInitiative/libelektra">https://github.com/ElektraInitiative/libelektra</a></li>
</ul>
<p>To be able to make pull requests, you need a copy of this repository inside your GitHub account. You can find a tutorial about how to do this <a href="https://help.github.com/en/articles/fork-a-repo">here</a> (remember to sign into your account first). After this, you should see this copy in the list of your own repositories with a hint of it's origin.</p>
<h2>Getting the Code</h2>
<p>To develop for libelektra, we now have to "download" your copy of its original repository. In git this process is called "cloning". CLion has built-in Git support which we will use for this tutorial. Once you have opened CLion click on:</p>
<p><em>Check out from Version Control</em> &ndash;&gt; <em>Git</em></p>
<p>and paste the URL of your forked libelektra-repository inside the <em>URL</em> field. Then choose the directory you want to store your project in. To be also able to directly push changes back to your repository, we'll also configure CLion to be able to use your GitHub account. Click on the "Log in to GitHub" button and enter your GitHub credentials and confirm. The last step here is to click "Clone" to download the project and open it in CLion.</p>
<p>Alternatively you can also clone your repository using the command line. Open a terminal and navigate to the folder you want to save the source code into and type:</p>
<div class="fragment"><div class="line">git clone https://github.com/ElektraInitiative/libelektra.git</div></div><!-- fragment --><p>With the project now locally available we can start developing.</p>
<h2>Setting Up the Project</h2>
<p>To import all of the project's configuration, open CMakeLists.txt inside the project's root directory and click on "Load CMake project" which will appear on the top right corner of the source view.</p>
<p>If you've cloned the project using a terminal. start CLion and once you see the main menu, click "Open" and select the CMakeLists.txt file inside the project's root directory. This will import the project accordingly and populate you run configuration with some predefined values. In rare occurrences this won't happen. If that is the case for you, simply restart CLion using:</p>
<p><em>File</em> &ndash;&gt; <em>Invalidate Caches / Restart...</em> &ndash;&gt; <em>Invalidate and Restart</em></p>
<p>Now after all processes of CLion have finished, the project should be set up and the run configuration should be populated with entries.</p>
<p>Since some <em>kdb</em>-operations require root access and it is not recommended to start programs (like CLion) with root access if they usually don't require it, we have to change our CMake configurations to get rid of this requirement. To do that, open:</p>
<p><em>File</em> &ndash;&gt; <em>Settings</em> &ndash;&gt; <em>Build, Execution, Deployment</em> &ndash;&gt; <em>CMake</em></p>
<p>There you can edit your CMake profiles. To get rid of the root requirement we'll add the following CMake options to our "Debug" profile:</p>
<div class="fragment"><div class="line">-DKDB_DB_SYSTEM=&quot;~/.config/kdb/[xyz]/system&quot;</div><div class="line">-DKDB_DB_SPEC=&quot;~/.config/kdb/[xyz]/spec&quot;</div><div class="line">-DKDB_DB_USER=&quot;.config/kdb/[xyz]/user&quot;</div><div class="line">-DCMAKE_INSTALL_PREFIX=install</div></div><!-- fragment --><p>where "[xyz]" can be replaced by any unique identifier so that different profiles won't clash with each other. This configuration also isolates your build of Elektra from any existing Elektra installation on your system. For debugging purposes we also recommend to add the following CMake options for debug builds to enable further logging and checks:</p>
<div class="fragment"><div class="line">-DENABLE_DEBUG=ON</div><div class="line">-DENABLE_LOGGER=ON</div></div><!-- fragment --><p>To increase the build speed you can also change the "Build option" to e.g.</p>
<div class="fragment"><div class="line">-j 8</div></div><!-- fragment --><p>which, in this case, starts 8 build jobs in parallel. For optimal performance this value should represent the number of available cores of your CPU + few extra jobs.</p>
<p>It remains to be noted that CLion maintains all CMake profiles in parallel. If some CMake file changes, CLion executes <code>cmake</code> for each profile which can put a lot of strain on your system.</p>
<p>Finally check if <code>ClangFormat</code> is enabled for the project to automatically adhere to the formatting guidelines of the project when formatting the code. You can find the settings here:</p>
<p><em>File</em> &ndash;&gt; <em>Settings...</em> &ndash;&gt; <em>Editor</em> &ndash;&gt; <em>Code Style</em></p>
<p>Make sure the selected "Scheme" is "Project".</p>
<h2>Development</h2>
<p>Usually the folders you have to work in to add functionality or documentation are as follows:</p>
<ul>
<li>doc<br />
 This folder contains mainly all documentation of the project, including almost all pages of the <a href="https://www.libelektra.org">homepage</a> of this project. One important note is, that all Markdown-pages can also be used for testing using <a href="https://github.com/ElektraInitiative/libelektra/tree/master/tests/shell/shell_recorder/tutorial_wrapper">Markdown to Shell Recorder</a> (you can find an example on how to do this <a class="el" href="doc_help_kdb-get_md.html">here</a>).</li>
<li>src<br />
 Almost all functionality-code resides here.<ul>
<li>bindings<br />
 Here is all the code of available Bindings of libelektra.</li>
<li>plugins<br />
 You can find all developed <a class="el" href="src_plugins_README_md.html">Plugins</a> here. If you want to fix a bug for an existing plugin or add another one, this is the directory you have to work in. For further information on how to develop your own plugin, please visit <a class="el" href="doc_tutorials_plugins_md.html">this</a> tutorial.</li>
<li>tools<br />
 In this folder the source of all tools for interacting with Elektra's global key database, e.g. <em>kdb</em>, can be found.</li>
</ul>
</li>
<li>tests<br />
 Here you can find all sorts of tests (excluding tests created with the <em>Markdown to Shell Recorder</em>-tool).</li>
</ul>
<h2>Testing</h2>
<p>The most thorough way to test your changes is to run all tests. Therefore navigate to your run-configurations (Run -&gt; Edit Configurations...) and look for the entry <code>run_all</code>. There, <code>run_all</code> should be selected as <code>Executable</code>, <code>kdb</code> as <code>Target</code>. Now you can execute this run configuration which will run all enabled tests! Alternatively you can also run all tests using the terminal by executing <code>make run_all</code> inside your build folder (e.g. /cmake-build-debug).</p>
<p>You can also run other specific tests by setting<code>Target</code> and <code>Executable</code> to any of the <code>testmod_*</code> or <code>testkdb_*</code>targets. Additionally all tests using <em>Google Test</em> (e.g. tests/kdb/*) can be run directly using CLion by opening their source code and clicking on the green icon next to the class name.</p>
<p>If you want to test various <em>kdb</em> methods separately, you can create your own run configurations. Add a new one by clicking on the "+"-sign on the top left of the "Edit Configurations..." dialog and name it. Here both <em>Executable</em> and <em>Target</em> should have "kdb" selected. If you for example want to test <code>kdb info dump</code>, write "info dump" next to <em>Program arguments</em>. That's it, now you can just test this part of <em>kdb</em>.</p>
<p>For further information please read <a class="el" href="doc_TESTING_md.html">this</a>.</p>
<h2>Commiting Your Changes</h2>
<p>Once you are satisfied with your changes, you have to commit them to your forked repository. We'll use the terminal for working with git. By convention, such commits shouldn't be too large, otherwise it will become difficult to revert some small changes if they are not working as intended. If you use the terminal for your Git operations, to be able to commit code to your repository, you have to configure your local Git installation to use your GitHub credentials. You can find information about how to do this <a href="https://help.github.com/en/articles/set-up-git">here</a>. After you've set up your Git configuration, you can continue with uploading your changes.</p>
<p>By default, you are in the "master" branch of your repository. First, you should never directly work on the master branch, since only working code is expected to be there. This means, we now create a branch in our repository where our code changes will be published into. On the bottom right of your CLion window you can find the button "Git: &lt;branchname&gt;". Click it and select "+ New Branch". Type in the name of your new branch (e.g. "testbranch") and keep "Checkout branch" checked to automatically switch to it as your working branch.</p>
<p>Alternatively open a terminal, navigate to the root directory of your local code and type:</p>
<div class="fragment"><div class="line">git branch testbranch</div><div class="line">git checkout testbranch</div></div><!-- fragment --><p>After you have changed some files it is time to publish them to your repository. To do that, open:</p>
<p><em>VCS</em> &ndash;&gt; <em>Commit...</em></p>
<p>In the dialog you have opened you can now select the files you want to include in your commit. The first line should have the following syntax:</p>
<div class="fragment"><div class="line">module: short statement</div></div><!-- fragment --><p>If you fixed a bug in <code>kdb cp</code> the first line of your commit message could be <code>KDB: Fixed cp not copying value</code>. Your commit message should also include a reference to the issue you have fixed so that the issue can be closed automatically once your code change gets included to the official repository (e.g. <code>Closes #1234</code>). Before committing your changes please make sure that "Reformat code" and "Rearrange code" are disabled in the commit dialog. Otherwise Clions formatter might produce files that don't adhere to our formatting guidelines. If you installed the <code>pre-commit-check-formatting</code> pre-commit-hook from the <code>scripts</code> directory. Ensure that "Run Git hooks" is enabled in the commit dialog. Finally you can commit your changes by clicking the "Commit" button and navigate to:</p>
<p><em>VCS</em> &ndash;&gt; <em>Git</em> &ndash;&gt; <em>Push</em></p>
<p>To do that in one step, you can also click on the arrow next to the "Commit" button and directly choose "Commit and Push...".</p>
<p>Using the terminal you first have to add all files you've changed and also want in your commit to the <em>stage</em>. Suppose we've changed how <code>kdb cp</code> works, we now have to add it to our files we want to commit (you can add several files for a commit too):</p>
<div class="fragment"><div class="line">git add ./src/tools/kdb/cp.cpp</div></div><!-- fragment --><p>Now we've staged our modified file for our commit. The final step is to actually commit it to your online repository. Therefore type:</p>
<div class="fragment"><div class="line">git commit -m &quot;&lt;commit message&gt;&quot;</div><div class="line">git push origin testbranch</div></div><!-- fragment --><p>With this, you've published your changes to your remote branch of your repository. The next step is merging this change into the original repository.</p>
<h2>Creating a Pull Request</h2>
<p>This step is most easily done using a browser. Open the web page of the Git repository of libelektra (<a href="https://github.com/ElektraInitiative/libelektra">https://github.com/ElektraInitiative/libelektra</a>) and log in to your account if have not already done so. Navigate to "Pull
requests", there you can find a green button called "New pull request". By clicking it (<a href="https://github.com/ElektraInitiative/libelektra/compare">shortcut</a>), you can now create a pull request referencing your forked repository and the branch,the modified code resides in. Click on "compare across forks" so that you can find and select your branch. Choose "&lt;username&gt;/libelektra" as the head repository and "testbranch" as the compare-branch. Now the green button "Create pull requests" should be enabled. By clicking it you can define the title of your pull request and write a description of the work you have done. Please read the template in this form and include the information stated there if possible. Finally by clicking "Create pull request" you've successfully created a pull request to merge your changes into the official repository! Now maintainers of libelektra will review your code and, if everything is fine, merge your changes into the official repository. Otherwise they'll comment on this pull request if further changes are needed. To include additional changes in this pull request, just commit new code changes to the same repository and branch you've referenced for this pull request, they will be added automatically to it. In any case check the output of the automated tests!</p>
<p>If you want to use CLion for creating Pull Request, please check out <a href="https://www.jetbrains.com/help/clion/contribute-to-projects.html#create-pull-request">this</a> link for further information.</p>
<h2>Troubleshooting</h2>
<h3>Resolving Missing *.so Library Error In Debug Mode</h3>
<p>In case you fail to run Elektra with the message like this one <code>Reason: of module: libelektra-resolver.so, because: libelektra-resolver.so: cannot open shared object file: No such file or directory</code> you can solve it by defining the LD_LIBRARY_PATH variable directly in CLion. Click on the debug configurations dropdown in the upper right corner and choose 'Edit Configurations...'. Then find 'Environmental Variables' field and add the following: LD_LIBRARY_PATH=PATH_TO_YOUR_LIB_DIRECTORY</p>
<p>Example:</p>
<p>LD_LIBRARY_PATH=/home/username/TU/libelektra/cmake-build-debug/lib</p>
<p>If you want to run built <code>kdb</code> outside of CLion, the recommended way is to run this script from your build directory. The script resides in you original directory with project sources.</p>
<p>Example:</p>
<div class="fragment"><div class="line">. /PATH/TO/YOUR/PROJECT/scripts/run_dev_env</div></div><!-- fragment --><p>Please keep in mind it sets the variables only in the currently opened shell window/session.</p>
<p>Please refer to <a class="el" href="doc_COMPILE_md.html">this</a> tutorial to fix the problem permanently.</p>
<h2>Hints</h2>
<ul>
<li>Especially for not that well-versed programmers don't forget that when debugging e.g. <code>KeySet</code>, which can contain many <code>Key</code> objects, you can only see that there may be more than one key stored in this set by it's <em>size</em> attribute since it's keys are referenced by a pointer. Just the first <code>Key</code> (referenced by the pointer) will be visible directly using the debugger. To analyse it's stored <code>Key</code> objects you can either add a <a href="https://www.jetbrains.com/help/clion/debug-tool-window-watches.html">watch</a> or use the GDB debug console (next to the "variables" tab inside the debugger view).</li>
<li>Sometimes CLion does not rebuild changed modules accordingly by just running the test. If you think, that the modules should have been rebuilt (e.g. if running <code>testmod_abc</code> doesn't rebuild abc), please report the issue under <a href="https://issues.libelektra.org,">https://issues.libelektra.org,</a> so we can fix the CMake dependencies. As temporary fix you can try to rebuild the project and restart the test.</li>
<li>Please add a line of changelog to <a class="el" href="doc_news__preparation_next_release_md.html">this</a> file and add it to your pull request, otherwise some test will fail in any case. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
