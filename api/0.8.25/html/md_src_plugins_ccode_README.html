<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elektra: Plugin: ccode</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elektra
   &#160;<span id="projectnumber">0.8.25</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Plugin: ccode </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>infos = Information about ccode plugin is in keys below</li>
<li>infos/author = Markus Raab <a href="#" onclick="location.href='mai'+'lto:'+'ele'+'kt'+'ra@'+'li'+'bel'+'ek'+'tra'+'.o'+'rg'; return false;">elekt<span style="display: none;">.nosp@m.</span>ra@l<span style="display: none;">.nosp@m.</span>ibele<span style="display: none;">.nosp@m.</span>ktra<span style="display: none;">.nosp@m.</span>.org</a></li>
<li>infos/licence = BSD</li>
<li>infos/provides = code</li>
<li>infos/needs =</li>
<li>infos/recommends =</li>
<li>infos/placements = postgetstorage presetstorage</li>
<li>infos/status = maintained unittest nodep libc configurable</li>
<li>infos/description = Decoding/Encoding engine which escapes unwanted characters.</li>
</ul>
<h1><a class="anchor" id="src_plugins_ccode_README_md"></a>
CCode</h1>
<h2>Introduction</h2>
<p>The <code>ccode</code> plugin replaces (escapes) any special characters with two characters:</p>
<ul>
<li>an escape character (default: <code>\</code>) and</li>
<li>another character representing the escaped character (e.g <code>n</code> for newline)</li>
</ul>
<p>before writing a <code>KeySet</code>. The plugin undoes this modification after reading a <code>KeySet</code>.</p>
<p>CCode provides a reasonable default configuration, using the usual escape sequences for C strings (e.g. <code>\n</code> for newline, <code>\t</code> for tab). You can also configure the escape character (<code>/escape</code>) and the mapping for special characters (<code>chars</code>).</p>
<h2>Examples</h2>
<h3>Default Configuration</h3>
<div class="fragment"><div class="line"># Mount `tcl` storage plugin together with the required `base64` plugin.</div><div class="line"># We use the `ccode` plugin to escape special characters.</div><div class="line">sudo kdb mount config.tcl user/tests/ccode tcl ccode base64</div><div class="line"></div><div class="line"># Add a key value containing newline characters</div><div class="line">kdb set user/tests/ccode/multiline &quot;`printf &#39;one\ntwo\nthree&#39;`&quot;</div><div class="line"># By default the plugin uses `\n` to escape newline characters</div><div class="line">grep &#39;multiline&#39; `kdb file user/tests/ccode` | sed &#39;s/[[:space:]]*//&#39;</div><div class="line">#&gt; multiline = one\ntwo\nthree</div><div class="line"></div><div class="line"># The `ccode` plugin escapes and unescapes the data. The `tcl` plugin</div><div class="line"># returns the unescaped values.</div><div class="line">kdb get user/tests/ccode/multiline</div><div class="line">#&gt; one</div><div class="line">#&gt; two</div><div class="line">#&gt; three</div><div class="line"></div><div class="line"># Write and read a key value containing a tab character</div><div class="line">kdb set user/tests/ccode/tab &#39;Tab       Fabulous&#39;</div><div class="line">kdb get user/tests/ccode/tab</div><div class="line">#&gt; Tab  Fabulous</div><div class="line"></div><div class="line"># The plugin also escapes special characters inside key names</div><div class="line">kdb set &#39;user/tests/ccode/tab/t\ta      b&#39; &#39;Escaped Tabs&#39;</div><div class="line">grep &#39;tab/&#39; `kdb file user/tests/ccode` | sed &#39;s/[[:space:]]*//&#39;</div><div class="line">#&gt; tab/t\\ta\tb = Escaped Tabs</div><div class="line"></div><div class="line"># Undo modifications to database</div><div class="line">kdb rm -r user/tests/ccode</div><div class="line">sudo kdb umount user/tests/ccode</div></div><!-- fragment --><h3>Custom Configuration</h3>
<p>``<code> &lt;h1&gt;We use</code>%<code>as escape character and map the space character (hex:</code>20<code>) to the character</code>_<code>.&lt;/h1&gt; sudo kdb mount config.tcl user/tests/ccode tcl base64 ccode escape=</code>bash -c 'printf x "'` chars/20=`bash -c 'printf x "_'`</p>
<p>kdb set user/tests/ccode/spaces 'one two three'</p>
<p>grep 'space' <code>kdb file user/tests/ccode/spaces</code> | sed 's/[[:space:]]*//' #&gt; spaces = one_two_three</p>
<p>kdb get user/tests/ccode/spaces #&gt; one two three</p>
<h1>Undo modifications to database</h1>
<p>kdb rm -r user/tests/ccode sudo kdb umount user/tests/ccode ```</p>
<h2>Restrictions</h2>
<p>This method of encoding characters is not as powerful as the hexcode plugin in terms of reduction. The hexcode plugin allows reduction of the character set to '0'-'9', 'a'-'f' and one escape character. So it can represent any key value with only 17 characters. On the other hand, ccode cannot reduce the set more than by half.</p>
<p>So when all control characters and non-ASCII characters need to vanish, it cannot be done with the ccode plugin. But it is perfectly suitable to reduce by some characters. The advantages are that the size only doubles in the worst case and that it is much easier to read.</p>
<h2>C</h2>
<p>In the C language, the following escape characters are present.</p>
<ul>
<li><code>b</code>: backspace, hex: 08</li>
<li><code>t</code>: horizontal tab, hex: 09</li>
<li><code>n</code>: new line feed, hex: 0A</li>
<li><code>v</code>: vertical tab, hex: 0B</li>
<li><code>f</code>: form feed, hex: 0C</li>
<li><code>r</code>: carriage return, hex: 0D</li>
<li><code>\\</code>: back slash, hex: 5C</li>
<li><code>'</code>: single quote, hex: 27</li>
<li><code>"</code>: double quote, hex: 22</li>
<li><code>0</code>: null, hex: 00</li>
</ul>
<p>This is also the default mapping.</p>
<h3>Contract</h3>
<p>Add <code>ccode</code> to <code>infos/needs</code> for any plugin that you want to be filtered by ccode. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
